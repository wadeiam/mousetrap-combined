# ============================================================================
# IoT Multi-Tenant Server - Environment Configuration
# ============================================================================

# ----------------------------------------------------------------------------
# Server Configuration
# ----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
HOST=0.0.0.0

# ----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# ----------------------------------------------------------------------------
DATABASE_URL=postgresql://postgres:password@localhost:5432/iot_platform
DB_HOST=localhost
DB_PORT=5432
DB_NAME=iot_platform
DB_USER=postgres
DB_PASSWORD=password
DB_SSL=false
DB_POOL_MIN=2
DB_POOL_MAX=10

# ----------------------------------------------------------------------------
# Redis Configuration (Session & Cache)
# ----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ----------------------------------------------------------------------------
# MQTT Broker Configuration
# ----------------------------------------------------------------------------
# MQTT Broker URL (use mqtt:// for plain, mqtts:// for TLS)
MQTT_BROKER_URL=mqtt://localhost:1883

# For local development (matches ESP32 default):
# MQTT_BROKER_URL=mqtt://192.168.133.123:1883

# For production with TLS:
# MQTT_BROKER_URL=mqtts://mtmon.wadehargrove.com:8883

# MQTT Authentication (leave empty if broker doesn't require auth)
MQTT_USERNAME=
MQTT_PASSWORD=

# MQTT Client Settings
MQTT_CLIENT_ID=server_production
MQTT_CLEAN_SESSION=true
MQTT_RECONNECT_PERIOD=5000
MQTT_CONNECT_TIMEOUT=30000
MQTT_KEEPALIVE=60

# MQTT QoS Levels (0=At most once, 1=At least once, 2=Exactly once)
MQTT_QOS_DEFAULT=0
MQTT_QOS_STATUS=1
MQTT_QOS_COMMANDS=1

# ----------------------------------------------------------------------------
# JWT & Authentication
# ----------------------------------------------------------------------------
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# ----------------------------------------------------------------------------
# Session Configuration
# ----------------------------------------------------------------------------
SESSION_SECRET=your-super-secret-session-key-change-this-in-production
SESSION_MAX_AGE=86400000

# ----------------------------------------------------------------------------
# CORS Configuration
# ----------------------------------------------------------------------------
CORS_ORIGIN=http://localhost:5173,http://localhost:3000
CORS_CREDENTIALS=true

# ----------------------------------------------------------------------------
# Rate Limiting
# ----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ----------------------------------------------------------------------------
# Logging
# ----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_FILE=logs/server.log
LOG_PRETTY=true

# ----------------------------------------------------------------------------
# File Upload
# ----------------------------------------------------------------------------
UPLOAD_DIR=uploads
MAX_FILE_SIZE=10485760

# ----------------------------------------------------------------------------
# Email Configuration (for alerts & notifications)
# ----------------------------------------------------------------------------
SMTP_HOST=smtp.gmail.com
SMTP_PORT=465
SMTP_SECURE=true
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-gmail-app-password
SMTP_FROM="MouseTrap Alerts <your-email@gmail.com>"

# ----------------------------------------------------------------------------
# SMS Configuration (Twilio - for emergency contact escalation)
# ----------------------------------------------------------------------------
# Get these from https://console.twilio.com/
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ----------------------------------------------------------------------------
# Device Configuration
# ----------------------------------------------------------------------------
# Device timeout (mark offline after no heartbeat)
DEVICE_TIMEOUT_MS=900000

# Alert intervals
ALERT_EVERY_MS=5400000
BEEP_EVERY_MS=300000

# ----------------------------------------------------------------------------
# OTA Update Configuration
# ----------------------------------------------------------------------------
# Base URL for firmware downloads (accessible from devices)
OTA_BASE_URL=https://mtmon.wadehargrove.com/firmware

# Local storage path for firmware files
OTA_STORAGE_PATH=./firmware

# ----------------------------------------------------------------------------
# Tenant Configuration
# ----------------------------------------------------------------------------
# Default tenant for development
DEFAULT_TENANT_ID=dev

# Enable multi-tenant mode
MULTI_TENANT_ENABLED=true

# ----------------------------------------------------------------------------
# WebSocket Configuration
# ----------------------------------------------------------------------------
WS_PATH=/ws
WS_PING_INTERVAL=25000
WS_PING_TIMEOUT=60000

# ----------------------------------------------------------------------------
# Security
# ----------------------------------------------------------------------------
# Helmet security headers
HELMET_ENABLED=true

# Trust proxy (enable if behind reverse proxy)
TRUST_PROXY=true

# HTTPS redirect (enable in production)
FORCE_HTTPS=false

# ----------------------------------------------------------------------------
# Monitoring & Metrics
# ----------------------------------------------------------------------------
# Enable Prometheus metrics endpoint
METRICS_ENABLED=true
METRICS_PORT=9090

# ----------------------------------------------------------------------------
# AI Classification Service (Docker)
# ----------------------------------------------------------------------------
# URL of the classification Docker container
# Default: http://localhost:3100 (local Docker)
# For production: http://classification:3100 (Docker network)
CLASSIFICATION_SERVICE_URL=http://localhost:3100

# ----------------------------------------------------------------------------
# Development & Debug
# ----------------------------------------------------------------------------
DEBUG=mqtt:*,server:*
VERBOSE=false
