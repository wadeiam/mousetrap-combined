var zs=Object.defineProperty;var Fs=(l,e,t)=>e in l?zs(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var gt=(l,e,t)=>Fs(l,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function G(){}function Es(l,e){for(const t in e)l[t]=e[t];return l}function As(l){return!!l&&(typeof l=="object"||typeof l=="function")&&typeof l.then=="function"}function ds(l){return l()}function Mt(){return Object.create(null)}function _e(l){l.forEach(ds)}function _t(l){return typeof l=="function"}function ye(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let ct;function lt(l,e){return l===e?!0:(ct||(ct=document.createElement("a")),ct.href=e,l===ct.href)}function qs(l){return Object.keys(l).length===0}function ps(l,...e){if(l==null){for(const n of e)n(void 0);return G}const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function dt(l,e,t){l.$$.on_destroy.push(ps(e,t))}function St(l,e,t,n){if(l){const s=ms(l,e,t,n);return l[0](s)}}function ms(l,e,t,n){return l[1]&&n?Es(t.ctx.slice(),l[1](n(e))):t.ctx}function yt(l,e,t,n){if(l[2]&&n){const s=l[2](n(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],i=Math.max(e.dirty.length,s.length);for(let c=0;c<i;c+=1)r[c]=e.dirty[c]|s[c];return r}return e.dirty|s}return e.dirty}function Tt(l,e,t,n,s,r){if(s){const i=ms(e,t,n,r);l.p(i,s)}}function Lt(l){if(l.ctx.length>32){const e=[],t=l.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function Re(l){return l&&_t(l.destroy)?l.destroy:G}const vs=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function o(l,e){l.appendChild(e)}function w(l,e,t){l.insertBefore(e,t||null)}function k(l){l.parentNode&&l.parentNode.removeChild(l)}function Je(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function d(l){return document.createElement(l)}function F(l){return document.createTextNode(l)}function b(){return F(" ")}function ze(){return F("")}function N(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function kt(l){return function(e){return e.preventDefault(),l.call(this,e)}}function _s(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function a(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Is(l){let e;return{p(...t){e=t,e.forEach(n=>l.push(n))},r(){e.forEach(t=>l.splice(l.indexOf(t),1))}}}function je(l){return l===""?null:+l}function Os(l){return Array.from(l.childNodes)}function D(l,e){e=""+e,l.data!==e&&(l.data=e)}function te(l,e){l.value=e??""}function Ge(l,e,t,n){t==null?l.style.removeProperty(e):l.style.setProperty(e,t,"")}function H(l,e,t){l.classList.toggle(e,!!t)}function pt(l,e){return new l(e)}let nt;function He(l){nt=l}function Et(){if(!nt)throw new Error("Function called outside component initialization");return nt}function We(l){Et().$$.on_mount.push(l)}function it(l){Et().$$.on_destroy.push(l)}function Ut(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const xe=[],et=[];let tt=[];const Dt=[],Ps=Promise.resolve();let zt=!1;function Ns(){zt||(zt=!0,Ps.then(At))}function Ft(l){tt.push(l)}const wt=new Set;let Xe=0;function At(){if(Xe!==0)return;const l=nt;do{try{for(;Xe<xe.length;){const e=xe[Xe];Xe++,He(e),Rs(e.$$)}}catch(e){throw xe.length=0,Xe=0,e}for(He(null),xe.length=0,Xe=0;et.length;)et.pop()();for(let e=0;e<tt.length;e+=1){const t=tt[e];wt.has(t)||(wt.add(t),t())}tt.length=0}while(xe.length);for(;Dt.length;)Dt.pop()();zt=!1,wt.clear(),He(l)}function Rs(l){if(l.fragment!==null){l.update(),_e(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Ft)}}function Ms(l){const e=[],t=[];tt.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),tt=e}const ft=new Set;let Ye;function ke(){Ye={r:0,c:[],p:Ye}}function we(){Ye.r||_e(Ye.c),Ye=Ye.p}function W(l,e){l&&l.i&&(ft.delete(l),l.i(e))}function Q(l,e,t,n){if(l&&l.o){if(ft.has(l))return;ft.add(l),Ye.c.push(()=>{ft.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function mt(l,e){const t=e.token={};function n(s,r,i,c){if(e.token!==t)return;e.resolved=c;let u=e.ctx;i!==void 0&&(u=u.slice(),u[i]=c);const f=s&&(e.current=s)(u);let p=!1;e.block&&(e.blocks?e.blocks.forEach((m,v)=>{v!==r&&m&&(ke(),Q(m,1,1,()=>{e.blocks[v]===m&&(e.blocks[v]=null)}),we())}):e.block.d(1),f.c(),W(f,1),f.m(e.mount(),e.anchor),p=!0),e.block=f,e.blocks&&(e.blocks[r]=f),p&&At()}if(As(l)){const s=Et();if(l.then(r=>{He(s),n(e.then,1,e.value,r),He(null)},r=>{if(He(s),n(e.catch,2,e.error,r),He(null),!e.hasCatch)throw r}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,l),!0;e.resolved=l}}function bs(l,e,t){const n=e.slice(),{resolved:s}=l;l.current===l.then&&(n[l.value]=s),l.current===l.catch&&(n[l.error]=s),l.block.p(n,t)}function Le(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function fe(l){l&&l.c()}function ce(l,e,t){const{fragment:n,after_update:s}=l.$$;n&&n.m(e,t),Ft(()=>{const r=l.$$.on_mount.map(ds).filter(_t);l.$$.on_destroy?l.$$.on_destroy.push(...r):_e(r),l.$$.on_mount=[]}),s.forEach(Ft)}function ue(l,e){const t=l.$$;t.fragment!==null&&(Ms(t.after_update),_e(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Us(l,e){l.$$.dirty[0]===-1&&(xe.push(l),Ns(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function Fe(l,e,t,n,s,r,i=null,c=[-1]){const u=nt;He(l);const f=l.$$={fragment:null,ctx:[],props:r,update:G,not_equal:s,bound:Mt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:Mt(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};i&&i(f.root);let p=!1;if(f.ctx=t?t(l,e.props||{},(m,v,..._)=>{const h=_.length?_[0]:v;return f.ctx&&s(f.ctx[m],f.ctx[m]=h)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](h),p&&Us(l,m)),v}):[],f.update(),p=!0,_e(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const m=Os(e.target);f.fragment&&f.fragment.l(m),m.forEach(k)}else f.fragment&&f.fragment.c();e.intro&&W(l.$$.fragment),ce(l,e.target,e.anchor),At()}He(u)}class Ee{constructor(){gt(this,"$$");gt(this,"$$set")}$destroy(){ue(this,1),this.$destroy=G}$on(e,t){if(!_t(t))return G;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!qs(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ds="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ds);const $e=[];function js(l,e){return{subscribe:ot(l,e).subscribe}}function ot(l,e=G){let t;const n=new Set;function s(c){if(ye(l,c)&&(l=c,t)){const u=!$e.length;for(const f of n)f[1](),$e.push(f,l);if(u){for(let f=0;f<$e.length;f+=2)$e[f][0]($e[f+1]);$e.length=0}}}function r(c){s(c(l))}function i(c,u=G){const f=[c,u];return n.add(f),n.size===1&&(t=e(s,r)||G),c(l),()=>{n.delete(f),n.size===0&&t&&(t(),t=null)}}return{set:s,update:r,subscribe:i}}function hs(l,e,t){const n=!Array.isArray(l),s=n?[l]:l;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return js(t,(i,c)=>{let u=!1;const f=[];let p=0,m=G;const v=()=>{if(p)return;m();const h=e(n?f[0]:f,i,c);r?i(h):m=_t(h)?h:G},_=s.map((h,S)=>ps(h,g=>{f[S]=g,p&=~(1<<S),u&&v()},()=>{p|=1<<S}));return u=!0,v(),function(){_e(_),m(),u=!1}})}const gs=ot({threshold:0,sensorReading:0,detectionState:!1,uptime:"",wifiRSSI:0,heap:0,psram:0,lastUpdate:null}),st=ot(!1);function Ws(l,e){const t=localStorage.getItem(l),n=t?JSON.parse(t):e,{subscribe:s,set:r,update:i}=ot(n);return{subscribe:s,set:c=>{localStorage.setItem(l,JSON.stringify(c)),r(c)},update:c=>{i(u=>{const f=c(u);return localStorage.setItem(l,JSON.stringify(f)),f})}}}Ws("mousetrap-prefs",{theme:"dark",refreshInterval:5e3});hs(gs,l=>l.detectionState);hs(gs,l=>l.lastUpdate?l.detectionState?"red":"green":"gray");const qt=ot(window.location.hash.slice(1)||"/");window.addEventListener("hashchange",()=>{const l=window.location.hash.slice(1)||"/";qt.set(l)});function Hs(l){window.location.hash=l}function Me(l){function e(t){const n=l.getAttribute("href");n&&n.startsWith("#/")&&(t.preventDefault(),Hs(n.slice(1)))}return l.addEventListener("click",e),{destroy(){l.removeEventListener("click",e)}}}function jt(l){let e,t,n,s,r,i,c,u,f,p;return{c(){e=d("div"),t=d("a"),t.textContent="WiFi Settings",n=b(),s=d("a"),s.textContent="Servo Settings",r=b(),i=d("a"),i.textContent="Calibration",c=b(),u=d("a"),u.textContent="Options & Access",a(t,"href","#/wifi"),a(t,"class","svelte-1n65rh9"),H(t,"active",l[0]==="/wifi"),a(s,"href","#/servo"),a(s,"class","svelte-1n65rh9"),H(s,"active",l[0]==="/servo"),a(i,"href","#/calibration"),a(i,"class","svelte-1n65rh9"),H(i,"active",l[0]==="/calibration"),a(u,"href","#/settings"),a(u,"class","svelte-1n65rh9"),H(u,"active",l[0]==="/settings"),a(e,"class","submenu svelte-1n65rh9")},m(m,v){w(m,e,v),o(e,t),o(e,n),o(e,s),o(e,r),o(e,i),o(e,c),o(e,u),f||(p=[Re(Me.call(null,t)),N(t,"click",l[5]),Re(Me.call(null,s)),N(s,"click",l[5]),Re(Me.call(null,i)),N(i,"click",l[5]),Re(Me.call(null,u)),N(u,"click",l[5])],f=!0)},p(m,v){v&1&&H(t,"active",m[0]==="/wifi"),v&1&&H(s,"active",m[0]==="/servo"),v&1&&H(i,"active",m[0]==="/calibration"),v&1&&H(u,"active",m[0]==="/settings")},d(m){m&&k(e),f=!1,_e(p)}}}function Wt(l){let e,t,n,s,r,i,c,u;return{c(){e=d("div"),t=d("a"),t.textContent="Status",n=b(),s=d("a"),s.textContent="System Logs",r=b(),i=d("a"),i.textContent="Gallery",a(t,"href","#/status"),a(t,"class","svelte-1n65rh9"),H(t,"active",l[0]==="/status"),a(s,"href","#/logs"),a(s,"class","svelte-1n65rh9"),H(s,"active",l[0]==="/logs"),a(i,"href","#/gallery"),a(i,"class","svelte-1n65rh9"),H(i,"active",l[0]==="/gallery"),a(e,"class","submenu svelte-1n65rh9")},m(f,p){w(f,e,p),o(e,t),o(e,n),o(e,s),o(e,r),o(e,i),c||(u=[Re(Me.call(null,t)),N(t,"click",l[5]),Re(Me.call(null,s)),N(s,"click",l[5]),Re(Me.call(null,i)),N(i,"click",l[5])],c=!0)},p(f,p){p&1&&H(t,"active",f[0]==="/status"),p&1&&H(s,"active",f[0]==="/logs"),p&1&&H(i,"active",f[0]==="/gallery")},d(f){f&&k(e),c=!1,_e(u)}}}function Ht(l){let e,t,n,s,r,i,c,u,f,p;return{c(){e=d("div"),t=d("a"),t.textContent="Claim",n=b(),s=d("a"),s.textContent="Test Alert",r=b(),i=d("a"),i.textContent="Firmware / OTA",c=b(),u=d("a"),u.textContent="Reboot",a(t,"href","/claim"),a(t,"class","svelte-1n65rh9"),a(s,"href","#/test"),a(s,"class","svelte-1n65rh9"),H(s,"active",l[0]==="/test"),a(i,"href","#/firmware"),a(i,"class","svelte-1n65rh9"),H(i,"active",l[0]==="/firmware"),a(u,"href","#/reboot"),a(u,"class","svelte-1n65rh9"),H(u,"active",l[0].startsWith("/reboot")),a(e,"class","submenu svelte-1n65rh9")},m(m,v){w(m,e,v),o(e,t),o(e,n),o(e,s),o(e,r),o(e,i),o(e,c),o(e,u),f||(p=[N(t,"click",l[5]),Re(Me.call(null,s)),N(s,"click",l[5]),Re(Me.call(null,i)),N(i,"click",l[5]),Re(Me.call(null,u)),N(u,"click",l[5])],f=!0)},p(m,v){v&1&&H(s,"active",m[0]==="/test"),v&1&&H(i,"active",m[0]==="/firmware"),v&1&&H(u,"active",m[0].startsWith("/reboot"))},d(m){m&&k(e),f=!1,_e(p)}}}function Bt(l){let e,t,n;return{c(){e=d("div"),a(e,"class","backdrop svelte-1n65rh9")},m(s,r){w(s,e,r),t||(n=N(e,"click",l[5]),t=!0)},p:G,d(s){s&&k(e),t=!1,n()}}}function Bs(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C,T,O,A=l[1]&&jt(l),E=l[2]&&Wt(l),z=l[3]&&Ht(l),q=l[4]&&Bt(l);return{c(){e=d("div"),t=d("a"),t.textContent="Home",n=b(),s=d("a"),r=F(`Settings
    `),i=d("span"),i.textContent="â–¸",c=b(),A&&A.c(),u=b(),f=d("a"),p=F(`Logs & Diagnostics
    `),m=d("span"),m.textContent="â–¸",v=b(),E&&E.c(),_=b(),h=d("a"),S=F(`Maintenance
    `),g=d("span"),g.textContent="â–¸",y=b(),z&&z.c(),L=b(),q&&q.c(),C=ze(),a(t,"href","#/"),a(t,"class","svelte-1n65rh9"),H(t,"active",l[0]==="/"),a(i,"class","arrow svelte-1n65rh9"),H(i,"expanded",l[1]),a(s,"href","#"),a(s,"class","parent svelte-1n65rh9"),a(m,"class","arrow svelte-1n65rh9"),H(m,"expanded",l[2]),a(f,"href","#"),a(f,"class","parent svelte-1n65rh9"),a(g,"class","arrow svelte-1n65rh9"),H(g,"expanded",l[3]),a(h,"href","#"),a(h,"class","parent svelte-1n65rh9"),a(e,"class","menu svelte-1n65rh9"),H(e,"open",l[4])},m(R,I){w(R,e,I),o(e,t),o(e,n),o(e,s),o(s,r),o(s,i),o(e,c),A&&A.m(e,null),o(e,u),o(e,f),o(f,p),o(f,m),o(e,v),E&&E.m(e,null),o(e,_),o(e,h),o(h,S),o(h,g),o(e,y),z&&z.m(e,null),w(R,L,I),q&&q.m(R,I),w(R,C,I),T||(O=[Re(Me.call(null,t)),N(t,"click",l[5]),N(s,"click",kt(l[7])),N(f,"click",kt(l[8])),N(h,"click",kt(l[9]))],T=!0)},p(R,[I]){I&1&&H(t,"active",R[0]==="/"),I&2&&H(i,"expanded",R[1]),R[1]?A?A.p(R,I):(A=jt(R),A.c(),A.m(e,u)):A&&(A.d(1),A=null),I&4&&H(m,"expanded",R[2]),R[2]?E?E.p(R,I):(E=Wt(R),E.c(),E.m(e,_)):E&&(E.d(1),E=null),I&8&&H(g,"expanded",R[3]),R[3]?z?z.p(R,I):(z=Ht(R),z.c(),z.m(e,null)):z&&(z.d(1),z=null),I&16&&H(e,"open",R[4]),R[4]?q?q.p(R,I):(q=Bt(R),q.c(),q.m(C.parentNode,C)):q&&(q.d(1),q=null)},i:G,o:G,d(R){R&&(k(e),k(L),k(C)),A&&A.d(),E&&E.d(),z&&z.d(),q&&q.d(R),T=!1,_e(O)}}}function Vs(l,e,t){let n,s;dt(l,qt,_=>t(0,n=_)),dt(l,st,_=>t(4,s=_));let r=!1,i=!1,c=!1;function u(){st.set(!1)}function f(_){_==="settings"&&t(1,r=!r),_==="logs"&&t(2,i=!i),_==="maintenance"&&t(3,c=!c)}const p=()=>f("settings"),m=()=>f("logs"),v=()=>f("maintenance");return l.$$.update=()=>{if(l.$$.dirty&1){const _=n;t(1,r=_.startsWith("/servo")||_.startsWith("/calibration")||_.startsWith("/settings")||_.startsWith("/wifi")),t(2,i=_.startsWith("/logs")||_.startsWith("/status")||_.startsWith("/gallery")),t(3,c=_.startsWith("/claim")||_.startsWith("/test")||_.startsWith("/firmware")||_.startsWith("/reboot"))}},[n,r,i,c,s,u,f,p,m,v]}class Gs extends Ee{constructor(e){super(),Fe(this,e,Vs,Bs,ye,{})}}function Js(l){let e,t,n,s,r,i,c,u,f;s=new Gs({});const p=l[3].default,m=St(p,l,l[2],null);return{c(){e=d("div"),t=d("div"),t.innerHTML='<div class="bar svelte-1stvkey"></div> <div class="bar svelte-1stvkey"></div> <div class="bar svelte-1stvkey"></div>',n=b(),fe(s.$$.fragment),r=b(),i=d("main"),m&&m.c(),a(t,"class","hamburger svelte-1stvkey"),a(t,"role","button"),a(t,"tabindex","0"),a(t,"aria-label","Toggle navigation menu"),a(i,"class","content svelte-1stvkey"),a(e,"class","layout svelte-1stvkey")},m(v,_){w(v,e,_),o(e,t),o(e,n),ce(s,e,null),o(e,r),o(e,i),m&&m.m(i,null),c=!0,u||(f=[N(window,"keydown",l[1]),N(t,"click",l[0]),N(t,"keydown",l[4])],u=!0)},p(v,[_]){m&&m.p&&(!c||_&4)&&Tt(m,p,v,v[2],c?yt(p,v[2],_,null):Lt(v[2]),null)},i(v){c||(W(s.$$.fragment,v),W(m,v),c=!0)},o(v){Q(s.$$.fragment,v),Q(m,v),c=!1},d(v){v&&k(e),ue(s),m&&m.d(v),u=!1,_e(f)}}}function Qs(l,e,t){let n;dt(l,st,f=>t(5,n=f));let{$$slots:s={},$$scope:r}=e;function i(){st.update(f=>!f)}function c(f){f.key==="Escape"&&n&&st.set(!1)}const u=f=>f.key==="Enter"&&i();return l.$$set=f=>{"$$scope"in f&&t(2,r=f.$$scope)},[i,c,r,s,u]}class Ks extends Ee{constructor(e){super(),Fe(this,e,Qs,Js,ye,{})}}const Ys=l=>({}),Vt=l=>({});function Gt(l){let e,t;return{c(){e=d("h3"),t=F(l[0]),a(e,"class","card-title svelte-q6oxq0")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s&1&&D(t,n[0])},d(n){n&&k(e)}}}function Zs(l){let e,t,n,s,r,i,c,u=l[0]&&Gt(l);const f=l[2].actions,p=St(f,l,l[1],Vt),m=l[2].default,v=St(m,l,l[1],null);return{c(){e=d("div"),t=d("div"),u&&u.c(),n=b(),s=d("div"),p&&p.c(),r=b(),i=d("div"),v&&v.c(),a(s,"class","card-actions svelte-q6oxq0"),a(t,"class","card-header svelte-q6oxq0"),a(i,"class","card-content svelte-q6oxq0"),a(e,"class","card svelte-q6oxq0")},m(_,h){w(_,e,h),o(e,t),u&&u.m(t,null),o(t,n),o(t,s),p&&p.m(s,null),o(e,r),o(e,i),v&&v.m(i,null),c=!0},p(_,[h]){_[0]?u?u.p(_,h):(u=Gt(_),u.c(),u.m(t,n)):u&&(u.d(1),u=null),p&&p.p&&(!c||h&2)&&Tt(p,f,_,_[1],c?yt(f,_[1],h,Ys):Lt(_[1]),Vt),v&&v.p&&(!c||h&2)&&Tt(v,m,_,_[1],c?yt(m,_[1],h,null):Lt(_[1]),null)},i(_){c||(W(p,_),W(v,_),c=!0)},o(_){Q(p,_),Q(v,_),c=!1},d(_){_&&k(e),u&&u.d(),p&&p.d(_),v&&v.d(_)}}}function Xs(l,e,t){let{$$slots:n={},$$scope:s}=e,{title:r=""}=e;return l.$$set=i=>{"title"in i&&t(0,r=i.title),"$$scope"in i&&t(1,s=i.$$scope)},[r,s,n]}class Se extends Ee{constructor(e){super(),Fe(this,e,Xs,Zs,ye,{title:0})}}function $s(){const l=window.location.origin;return l.includes("192.168.")||l.includes("localhost")||l.includes("mousetrap.local")?l:(console.log("[API] Captive portal detected, using 192.168.4.1 instead of:",l),"http://192.168.4.1")}const ks=$s();async function ve(l,e={}){try{const t=`${ks}${l}`;console.log(`[API] Fetching: ${t}`);const n={Accept:"application/json",...e.headers};e.body&&["POST","PUT","PATCH"].includes((e.method||"GET").toUpperCase())&&(n["Content-Type"]="application/json");const s=await fetch(t,{...e,headers:n});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const r=s.headers.get("content-type");return r&&r.includes("application/json")?await s.json():r&&r.includes("image/")?await s.blob():await s.text()}catch(t){throw console.error(`API Error [${l}]:`,t),t}}async function It(){try{const[l,e]=await Promise.all([ve("/data"),ve("/systemStatus").catch(()=>null)]);return{threshold:l.threshold||0,sensorReading:l.currentHourAverage||0,detectionState:l.triggered||!1,uptime:(e==null?void 0:e.uptime)||"",heap:(e==null?void 0:e.heapFree)||0,anomalies:l.anomalies||[],calibrationOffset:l.calibrationOffset||0,falseAlarmOffset:l.falseAlarmOffset||0,overrideThreshold:l.overrideThreshold||0}}catch{const e=await ve("/data");return{threshold:e.threshold||0,sensorReading:e.currentHourAverage||0,detectionState:e.triggered||!1,uptime:"",heap:0,anomalies:e.anomalies||[],calibrationOffset:e.calibrationOffset||0,falseAlarmOffset:e.falseAlarmOffset||0,overrideThreshold:e.overrideThreshold||0}}}async function xs(){return ve("/toggleLED")}async function en(){return ve("/api/captures")}function Jt(l){return`${ks}/captures/${l}`}async function tn(l){return ve(`/captures/${l}`,{method:"DELETE"})}async function ln(l){return ve(`/setCalib?calib=${l}`)}async function sn(l){return ve(`/setCalib?overrideTh=${l}`)}async function nn(){return ve("/setCalib?overrideTh=0")}async function rn(){return ve("/recalib")}async function on(){return ve("/falseAlarm")}async function an(){return Promise.resolve({startUS:1500,endUS:1100,disabled:!1})}async function cn(l){const e=new FormData;return e.append("start",l.startUS),e.append("end",l.endUS),l.disabled&&e.append("disableServo","on"),fetch("/setServoSettings",{method:"POST",body:e,headers:{Authorization:"Basic "+btoa("ops:changeme")}}).then(async t=>{if(!t.ok){const n=await t.text();throw new Error(n||`HTTP ${t.status}`)}return t.text()})}async function ws(){return ve("/servo")}async function Cs(){return await ve("/testAlert")}async function un(){return ve("/api/ip-filters")}async function fn(l){return ve("/api/ip-filters",{method:"POST",body:JSON.stringify(l)})}async function dn(){return ve("/api/mqtt-config")}async function pn(l){return ve("/api/mqtt-config",{method:"POST",body:JSON.stringify(l)})}async function mn(){return ve("/api/video-mode")}async function vn(l){return ve("/api/video-mode",{method:"POST",body:JSON.stringify(l)})}async function _n(){return ve("/api/system-logs")}async function bn(){return ve("/api/previous-logs")}async function hn(){return ve("/api/older-logs")}async function gn(){return ve("/api/system-info")}async function kn(){return ve("/reboot",{headers:{Authorization:"Basic "+btoa("ops:changeme")}})}async function wn(){return ve("/sendHeartbeat")}async function Ss(){return ve("/reset")}async function Cn(){return ve("/api/device/claim-status")}async function ys(l=!1){const e=l?"/api/wifi/scan?rescan=1":"/api/wifi/scan";console.log(`[WIFI-SCAN] Calling ${e}...`);try{const t=await ve(e);return console.log("[WIFI-SCAN] Got result:",JSON.stringify(t)),t}catch(t){throw console.error("[WIFI-SCAN] Error:",t),t}}async function Sn(l){return ve("/api/setup/connect",{method:"POST",body:JSON.stringify(l)})}async function yn(l){return ve("/api/setup/standalone",{method:"POST",body:JSON.stringify(l)})}async function Tn(l){return ve("/api/wifi/update",{method:"POST",body:JSON.stringify(l)})}const{document:Qt}=vs;function Kt(l,e,t){const n=l.slice();return n[27]=e[t],n}function Yt(l){let e;return{c(){e=d("div"),e.textContent="TRAP TRIGGERED!",a(e,"class","trap-alert svelte-1kjtmub")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Ln(l){let e,t,n,s,r,i,c,u,f,p=l[2]?"On":"Off",m,v,_,h,S,g,y;return{c(){e=d("div"),t=d("img"),s=b(),r=d("div"),i=d("button"),i.textContent="Refresh",c=b(),u=d("button"),f=F("Live "),m=F(p),v=b(),_=d("button"),_.textContent="Toggle LED",h=b(),S=d("button"),S.textContent="Capture",lt(t.src,n=l[0])||a(t,"src",n),a(t,"alt","Camera Feed"),a(t,"class","svelte-1kjtmub"),H(t,"error",l[1]),H(t,"zoomed",l[3]),a(i,"class","btn svelte-1kjtmub"),a(u,"class","btn svelte-1kjtmub"),H(u,"active",l[2]),a(_,"class","btn svelte-1kjtmub"),a(S,"class","btn svelte-1kjtmub"),a(r,"class","camera-controls svelte-1kjtmub"),a(e,"class","camera-container svelte-1kjtmub"),H(e,"zoomed",l[3])},m(L,C){w(L,e,C),o(e,t),o(e,s),o(e,r),o(r,i),o(r,c),o(r,u),o(u,f),o(u,m),o(r,v),o(r,_),o(r,h),o(r,S),g||(y=[N(t,"error",l[14]),N(t,"click",l[15]),N(i,"click",l[7]),N(u,"click",l[8]),N(_,"click",l[9]),N(S,"click",l[13])],g=!0)},p(L,C){C&1&&!lt(t.src,n=L[0])&&a(t,"src",n),C&2&&H(t,"error",L[1]),C&8&&H(t,"zoomed",L[3]),C&4&&p!==(p=L[2]?"On":"Off")&&D(m,p),C&4&&H(u,"active",L[2]),C&8&&H(e,"zoomed",L[3])},d(L){L&&k(e),g=!1,_e(y)}}}function zn(l){let e,t,n,s,r,i,c,u=l[4].sensorReading+"",f,p,m,v,_,h=l[4].threshold+"",S;return{c(){e=d("div"),t=d("canvas"),n=b(),s=d("div"),r=d("div"),i=F("Current: "),c=d("strong"),f=F(u),p=b(),m=d("div"),v=F("Threshold: "),_=d("strong"),S=F(h),a(e,"class","chart-container svelte-1kjtmub"),a(c,"class","svelte-1kjtmub"),a(_,"class","svelte-1kjtmub"),a(s,"class","sensor-info svelte-1kjtmub")},m(g,y){w(g,e,y),o(e,t),l[16](t),w(g,n,y),w(g,s,y),o(s,r),o(r,i),o(r,c),o(c,f),o(s,p),o(s,m),o(m,v),o(m,_),o(_,S)},p(g,y){y&16&&u!==(u=g[4].sensorReading+"")&&D(f,u),y&16&&h!==(h=g[4].threshold+"")&&D(S,h)},d(g){g&&(k(e),k(n),k(s)),l[16](null)}}}function Fn(l){let e,t,n,s,r,i=l[4].uptime+"",c,u,f,p,m,v,_=l[4].heap+"",h,S,g,y,L,C,T,O=l[5].message+"",A,E,z,q,R,I,M,B,P,j;return{c(){e=d("div"),t=d("div"),n=d("span"),n.textContent="Uptime:",s=b(),r=d("span"),c=F(i),u=b(),f=d("div"),p=d("span"),p.textContent="Free Heap:",m=b(),v=d("span"),h=F(_),S=F(" bytes"),g=b(),y=d("div"),L=d("span"),L.textContent="Claim Status:",C=b(),T=d("span"),A=F(O),E=b(),z=d("div"),q=d("button"),q.textContent="Reset Alarm",R=b(),I=d("button"),I.textContent="False Alarm",M=b(),B=d("button"),B.textContent="Send Heartbeat",a(t,"class","status-row svelte-1kjtmub"),a(f,"class","status-row svelte-1kjtmub"),a(T,"class","claimed-status"),H(T,"unclaimed",!l[5].claimed),a(y,"class","status-row svelte-1kjtmub"),a(e,"class","status-info svelte-1kjtmub"),a(q,"class","btn svelte-1kjtmub"),a(I,"class","btn svelte-1kjtmub"),a(B,"class","btn svelte-1kjtmub"),a(z,"class","action-buttons svelte-1kjtmub")},m(U,K){w(U,e,K),o(e,t),o(t,n),o(t,s),o(t,r),o(r,c),o(e,u),o(e,f),o(f,p),o(f,m),o(f,v),o(v,h),o(v,S),o(e,g),o(e,y),o(y,L),o(y,C),o(y,T),o(T,A),w(U,E,K),w(U,z,K),o(z,q),o(z,R),o(z,I),o(z,M),o(z,B),P||(j=[N(q,"click",l[10]),N(I,"click",l[11]),N(B,"click",l[12])],P=!0)},p(U,K){K&16&&i!==(i=U[4].uptime+"")&&D(c,i),K&16&&_!==(_=U[4].heap+"")&&D(h,_),K&32&&O!==(O=U[5].message+"")&&D(A,O),K&32&&H(T,"unclaimed",!U[5].claimed)},d(U){U&&(k(e),k(E),k(z)),P=!1,_e(j)}}}function En(l){let e;return{c(){e=d("p"),e.textContent="No anomalies detected",a(e,"class","no-data svelte-1kjtmub")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function An(l){let e,t=Le(l[4].anomalies),n=[];for(let s=0;s<t.length;s+=1)n[s]=Zt(Kt(l,t,s));return{c(){e=d("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","anomalies-list svelte-1kjtmub")},m(s,r){w(s,e,r);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(s,r){if(r&16){t=Le(s[4].anomalies);let i;for(i=0;i<t.length;i+=1){const c=Kt(s,t,i);n[i]?n[i].p(c,r):(n[i]=Zt(c),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(s){s&&k(e),Je(n,s)}}}function Zt(l){let e,t,n=l[27].timestamp+"",s,r,i,c=l[27].distance+"",u,f,p;return{c(){e=d("div"),t=d("span"),s=F(n),r=b(),i=d("span"),u=F(c),f=F(" cm"),p=b(),a(t,"class","timestamp svelte-1kjtmub"),a(i,"class","distance svelte-1kjtmub"),a(e,"class","anomaly-item svelte-1kjtmub")},m(m,v){w(m,e,v),o(e,t),o(t,s),o(e,r),o(e,i),o(i,u),o(i,f),o(e,p)},p(m,v){v&16&&n!==(n=m[27].timestamp+"")&&D(s,n),v&16&&c!==(c=m[27].distance+"")&&D(u,c)},d(m){m&&k(e)}}}function qn(l){let e;function t(r,i){return r[4].anomalies&&r[4].anomalies.length>0?An:En}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,i){s.m(r,i),w(r,e,i)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){r&&k(e),s.d(r)}}}function In(l){let e,t,n,s,r=(l[5].deviceName||"MouseTrap")+"",i,c,u,f,p,m,v,_,h,S,g,y,L;Qt.title=e="Dashboard - "+(l[5].deviceName||"MouseTrap");let C=l[4].detectionState&&Yt();return p=new Se({props:{title:"Live Camera Feed",$$slots:{default:[Ln]},$$scope:{ctx:l}}}),_=new Se({props:{title:"Sensor Range",$$slots:{default:[zn]},$$scope:{ctx:l}}}),S=new Se({props:{title:"System Status",$$slots:{default:[Fn]},$$scope:{ctx:l}}}),y=new Se({props:{title:"Anomalous Events",$$slots:{default:[qn]},$$scope:{ctx:l}}}),{c(){t=b(),n=d("div"),s=d("h1"),i=F(r),c=b(),C&&C.c(),u=b(),f=d("div"),fe(p.$$.fragment),m=b(),v=d("div"),fe(_.$$.fragment),h=b(),fe(S.$$.fragment),g=b(),fe(y.$$.fragment),a(s,"class","svelte-1kjtmub"),a(f,"class","camera-card-wrapper svelte-1kjtmub"),a(v,"class","grid svelte-1kjtmub"),a(n,"class","dashboard svelte-1kjtmub")},m(T,O){w(T,t,O),w(T,n,O),o(n,s),o(s,i),o(n,c),C&&C.m(n,null),o(n,u),o(n,f),ce(p,f,null),o(n,m),o(n,v),ce(_,v,null),o(v,h),ce(S,v,null),o(v,g),ce(y,v,null),L=!0},p(T,[O]){(!L||O&32)&&e!==(e="Dashboard - "+(T[5].deviceName||"MouseTrap"))&&(Qt.title=e),(!L||O&32)&&r!==(r=(T[5].deviceName||"MouseTrap")+"")&&D(i,r),T[4].detectionState?C||(C=Yt(),C.c(),C.m(n,u)):C&&(C.d(1),C=null);const A={};O&1073741839&&(A.$$scope={dirty:O,ctx:T}),p.$set(A);const E={};O&1073741904&&(E.$$scope={dirty:O,ctx:T}),_.$set(E);const z={};O&1073741872&&(z.$$scope={dirty:O,ctx:T}),S.$set(z);const q={};O&1073741840&&(q.$$scope={dirty:O,ctx:T}),y.$set(q)},i(T){L||(W(p.$$.fragment,T),W(_.$$.fragment,T),W(S.$$.fragment,T),W(y.$$.fragment,T),L=!0)},o(T){Q(p.$$.fragment,T),Q(_.$$.fragment,T),Q(S.$$.fragment,T),Q(y.$$.fragment,T),L=!1},d(T){T&&(k(t),k(n)),C&&C.d(),ue(p),ue(_),ue(S),ue(y)}}}const Xt=20;function On(l,e,t){let n="/auto.jpg",s=!1,r=!1,i=!1,c=null,u=null,f={threshold:0,sensorReading:0,detectionState:!1,uptime:"",heap:0,anomalies:[]},p={claimed:!1,message:"Checking...",deviceName:""},m=null,v=null,_=[];async function h(){try{t(0,n=`/auto.jpg?t=${Date.now()}`),t(1,s=!1)}catch(P){console.error("Camera refresh error:",P),t(1,s=!0)}}function S(){try{t(0,n=`/camera?t=${Date.now()}`),t(1,s=!1)}catch(P){console.error("Live frame error:",P),t(1,s=!0)}}function g(){t(2,r=!r),r?(S(),c=setInterval(()=>{S()},100)):(c&&(clearInterval(c),c=null),h())}async function y(){try{await xs()}catch(P){console.error("Toggle LED error:",P)}}async function L(){try{await Ss(),await A()}catch(P){console.error("Reset alarm error:",P)}}async function C(){try{const P=await on();P&&P.newThreshold!==void 0&&t(4,f.threshold=P.newThreshold,f),await A()}catch(P){console.error("False alarm error:",P)}}async function T(){try{await wn()}catch(P){console.error("Send heartbeat error:",P)}}async function O(){try{await Cs(),await h()}catch(P){console.error("Capture screenshot error:",P)}}async function A(){try{const P=await It();t(4,f=P),_.push({time:new Date().toLocaleTimeString(),value:P.sensorReading}),_.length>Xt&&(_=_.slice(-Xt)),z()}catch(P){console.error("Status fetch error:",P)}}function E(){if(!v)return;const P=v.getContext("2d");m=new Chart(P,{type:"line",data:{labels:[],datasets:[{label:"Sensor Reading",data:[],borderColor:"#4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)",tension:.4},{label:"Threshold",data:[],borderColor:"#f44336",backgroundColor:"transparent",borderDash:[5,5],pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{color:"#ddd"},grid:{color:"#333"}},x:{ticks:{color:"#ddd"},grid:{color:"#333"}}},plugins:{legend:{labels:{color:"#ddd"}}}}})}function z(){m&&(m.data.labels=_.map(P=>P.time),m.data.datasets[0].data=_.map(P=>P.value),m.data.datasets[1].data=_.map(()=>f.threshold),m.update())}function q(){t(1,s=!0),setTimeout(()=>{r?S():h()},1e3)}async function R(){if(i)try{(document.fullscreenElement||document.webkitFullscreenElement)&&(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen&&await document.webkitExitFullscreen()),t(3,i=!1)}catch(P){console.error("Error exiting fullscreen:",P),t(3,i=!1)}else try{const P=document.documentElement;P.requestFullscreen?await P.requestFullscreen():P.webkitRequestFullscreen&&await P.webkitRequestFullscreen(),t(3,i=!0)}catch(P){console.error("Error entering fullscreen:",P),t(3,i=!0)}}function I(){!document.fullscreenElement&&!document.webkitFullscreenElement&&t(3,i=!1)}async function M(){try{const P=await Cn();t(5,p={claimed:P.claimed||!1,deviceName:P.deviceName||"",message:P.claimed?`Claimed to ${P.deviceName||"tenant"}`:P.message||"Device not claimed"})}catch(P){console.error("Claim status fetch error:",P),t(5,p={claimed:!1,deviceName:"",message:"Error loading claim status"})}}We(()=>{if(typeof Chart<"u")E();else{const P=document.createElement("script");P.src="https://cdn.jsdelivr.net/npm/chart.js",P.onload=()=>E(),document.head.appendChild(P)}A(),M(),u=setInterval(A,5e3),document.addEventListener("fullscreenchange",I),document.addEventListener("webkitfullscreenchange",I)}),it(()=>{c&&clearInterval(c),u&&clearInterval(u),m&&m.destroy(),document.removeEventListener("fullscreenchange",I),document.removeEventListener("webkitfullscreenchange",I)});function B(P){et[P?"unshift":"push"](()=>{v=P,t(6,v)})}return[n,s,r,i,f,p,v,h,g,y,L,C,T,O,q,R,B]}class $t extends Ee{constructor(e){super(),Fe(this,e,On,In,ye,{})}}function Pn(l){let e,t;return{c(){e=d("div"),t=d("div"),a(t,"class","spinner svelte-1cznhkh"),Ge(t,"width",l[0]+"px"),Ge(t,"height",l[0]+"px"),Ge(t,"border-color",l[1]+" transparent transparent transparent"),a(e,"class","spinner-container svelte-1cznhkh")},m(n,s){w(n,e,s),o(e,t)},p(n,[s]){s&1&&Ge(t,"width",n[0]+"px"),s&1&&Ge(t,"height",n[0]+"px"),s&2&&Ge(t,"border-color",n[1]+" transparent transparent transparent")},i:G,o:G,d(n){n&&k(e)}}}function Nn(l,e,t){let{size:n=40}=e,{color:s="#9fdcff"}=e;return l.$$set=r=>{"size"in r&&t(0,n=r.size),"color"in r&&t(1,s=r.color)},[n,s]}class Ue extends Ee{constructor(e){super(),Fe(this,e,Nn,Pn,ye,{size:0,color:1})}}function xt(l){let e,t,n,s,r=l[0].message+"",i,c,u,f,p,m,v=l[0].details&&el(l);return{c(){e=d("div"),t=d("div"),n=d("strong"),n.textContent="âš ï¸ Error:",s=b(),i=F(r),c=b(),v&&v.c(),u=b(),f=d("button"),f.textContent="âœ•",a(t,"class","error-content svelte-1gxsq9q"),a(f,"class","dismiss-btn svelte-1gxsq9q"),a(e,"class","error-banner svelte-1gxsq9q")},m(_,h){w(_,e,h),o(e,t),o(t,n),o(t,s),o(t,i),o(t,c),v&&v.m(t,null),o(e,u),o(e,f),p||(m=N(f,"click",l[1]),p=!0)},p(_,h){h&1&&r!==(r=_[0].message+"")&&D(i,r),_[0].details?v?v.p(_,h):(v=el(_),v.c(),v.m(t,null)):v&&(v.d(1),v=null)},d(_){_&&k(e),v&&v.d(),p=!1,m()}}}function el(l){let e,t=JSON.stringify(l[0].details)+"",n;return{c(){e=d("div"),n=F(t),a(e,"class","error-details svelte-1gxsq9q")},m(s,r){w(s,e,r),o(e,n)},p(s,r){r&1&&t!==(t=JSON.stringify(s[0].details)+"")&&D(n,t)},d(s){s&&k(e)}}}function Rn(l){let e,t=l[0]&&xt(l);return{c(){t&&t.c(),e=ze()},m(n,s){t&&t.m(n,s),w(n,e,s)},p(n,[s]){n[0]?t?t.p(n,s):(t=xt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:G,o:G,d(n){n&&k(e),t&&t.d(n)}}}function Mn(l,e,t){let{error:n=null}=e;function s(){t(0,n=null)}return l.$$set=r=>{"error"in r&&t(0,n=r.error)},[n,s]}class Ts extends Ee{constructor(e){super(),Fe(this,e,Mn,Rn,ye,{error:0})}}function tl(l,e,t){const n=l.slice();return n[25]=e[t],n[27]=t,n}function ll(l){let e,t;return e=new Ts({props:{message:l[2]}}),{c(){fe(e.$$.fragment)},m(n,s){ce(e,n,s),t=!0},p(n,s){const r={};s&4&&(r.message=n[2]),e.$set(r)},i(n){t||(W(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function Un(l){let e,t,n=Le(l[0]),s=[];for(let i=0;i<n.length;i+=1)s[i]=sl(tl(l,n,i));const r=i=>Q(s[i],1,1,()=>{s[i]=null});return{c(){e=d("div");for(let i=0;i<s.length;i+=1)s[i].c();a(e,"class","image-grid svelte-1chdln3")},m(i,c){w(i,e,c);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);t=!0},p(i,c){if(c&769){n=Le(i[0]);let u;for(u=0;u<n.length;u+=1){const f=tl(i,n,u);s[u]?(s[u].p(f,c),W(s[u],1)):(s[u]=sl(f),s[u].c(),W(s[u],1),s[u].m(e,null))}for(ke(),u=n.length;u<s.length;u+=1)r(u);we()}},i(i){if(!t){for(let c=0;c<n.length;c+=1)W(s[c]);t=!0}},o(i){s=s.filter(Boolean);for(let c=0;c<s.length;c+=1)Q(s[c]);t=!1},d(i){i&&k(e),Je(s,i)}}}function Dn(l){let e,t;return e=new Se({props:{$$slots:{default:[Jn]},$$scope:{ctx:l}}}),{c(){fe(e.$$.fragment)},m(n,s){ce(e,n,s),t=!0},p(n,s){const r={};s&268435456&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(W(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function jn(l){let e,t,n;return t=new Ue({}),{c(){e=d("div"),fe(t.$$.fragment),a(e,"class","loading-container svelte-1chdln3")},m(s,r){w(s,e,r),ce(t,e,null),n=!0},p:G,i(s){n||(W(t.$$.fragment,s),n=!0)},o(s){Q(t.$$.fragment,s),n=!1},d(s){s&&k(e),ue(t)}}}function Wn(l){return{c:G,m:G,p:G,i:G,o:G,d:G}}function Hn(l){let e;function t(r,i){return r[24]?Vn:Bn}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,i){s.m(r,i),w(r,e,i)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},i:G,o:G,d(r){r&&k(e),s.d(r)}}}function Bn(l){let e;return{c(){e=d("div"),e.textContent="Failed to load",a(e,"class","thumbnail-error svelte-1chdln3")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function Vn(l){let e,t,n;return{c(){e=d("img"),lt(e.src,t=l[24])||a(e,"src",t),a(e,"alt",n=l[25].name),a(e,"class","thumbnail-image svelte-1chdln3")},m(s,r){w(s,e,r)},p(s,r){r&1&&!lt(e.src,t=s[24])&&a(e,"src",t),r&1&&n!==(n=s[25].name)&&a(e,"alt",n)},d(s){s&&k(e)}}}function Gn(l){let e,t,n;return t=new Ue({}),{c(){e=d("div"),fe(t.$$.fragment),a(e,"class","thumbnail-loading svelte-1chdln3")},m(s,r){w(s,e,r),ce(t,e,null),n=!0},p:G,i(s){n||(W(t.$$.fragment,s),n=!0)},o(s){Q(t.$$.fragment,s),n=!1},d(s){s&&k(e),ue(t)}}}function sl(l){let e,t,n,s,r,i=l[25].name+"",c,u,f,p=ol(l[25].size)+"",m,v,_,h,S,g={ctx:l,current:null,token:null,hasCatch:!1,pending:Gn,then:Hn,catch:Wn,value:24,blocks:[,,,]};mt(t=l[8](l[25].name),g);function y(){return l[19](l[25],l[27])}return{c(){e=d("div"),g.block.c(),n=b(),s=d("div"),r=d("div"),c=F(i),u=b(),f=d("div"),m=F(p),v=b(),a(r,"class","thumbnail-filename svelte-1chdln3"),a(f,"class","thumbnail-meta svelte-1chdln3"),a(s,"class","thumbnail-info svelte-1chdln3"),a(e,"class","thumbnail-card svelte-1chdln3")},m(L,C){w(L,e,C),g.block.m(e,g.anchor=null),g.mount=()=>e,g.anchor=n,o(e,n),o(e,s),o(s,r),o(r,c),o(s,u),o(s,f),o(f,m),o(e,v),_=!0,h||(S=N(e,"click",y),h=!0)},p(L,C){l=L,g.ctx=l,C&1&&t!==(t=l[8](l[25].name))&&mt(t,g)||bs(g,l,C),(!_||C&1)&&i!==(i=l[25].name+"")&&D(c,i),(!_||C&1)&&p!==(p=ol(l[25].size)+"")&&D(m,p)},i(L){_||(W(g.block),_=!0)},o(L){for(let C=0;C<3;C+=1){const T=g.blocks[C];Q(T)}_=!1},d(L){L&&k(e),g.block.d(),g.token=null,g=null,h=!1,S()}}}function Jn(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1chdln3">No captures yet</p> <p class="empty-hint svelte-1chdln3">Captured images will appear here</p>',a(e,"class","empty-state svelte-1chdln3")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function nl(l){let e,t,n,s,r,i=l[3].name+"",c,u,f,p=il(l[3].timestamp)+"",m,v,_,h,S,g,y,L,C,T,O,A,E,z,q=l[4]+1+"",R,I,M=l[0].length+"",B,P,j,U,K,J,X,oe,me,x,Z,re,se,V={ctx:l,current:null,token:null,hasCatch:!1,pending:Xn,then:Kn,catch:Qn,value:24,blocks:[,,,]};return mt(g=l[8](l[3].name),V),{c(){e=d("div"),t=d("div"),n=d("div"),s=d("div"),r=d("div"),c=F(i),u=b(),f=d("div"),m=F(p),v=b(),_=d("button"),_.textContent="Ã—",h=b(),S=d("div"),V.block.c(),y=b(),L=d("div"),C=d("div"),T=d("button"),O=F("â† Previous"),E=b(),z=d("span"),R=F(q),I=F(" / "),B=F(M),P=b(),j=d("button"),U=F("Next â†’"),J=b(),X=d("div"),oe=d("button"),oe.textContent="Download",me=b(),x=d("button"),x.textContent="Delete",a(r,"class","modal-filename svelte-1chdln3"),a(f,"class","modal-timestamp svelte-1chdln3"),a(s,"class","modal-title svelte-1chdln3"),a(_,"class","modal-close svelte-1chdln3"),a(n,"class","modal-header svelte-1chdln3"),a(S,"class","modal-body svelte-1chdln3"),a(T,"class","nav-btn svelte-1chdln3"),T.disabled=A=l[4]===0,a(z,"class","image-counter svelte-1chdln3"),a(j,"class","nav-btn svelte-1chdln3"),j.disabled=K=l[4]===l[0].length-1,a(C,"class","modal-nav svelte-1chdln3"),a(oe,"class","action-btn svelte-1chdln3"),a(x,"class","action-btn delete-btn svelte-1chdln3"),a(X,"class","modal-actions svelte-1chdln3"),a(L,"class","modal-footer svelte-1chdln3"),a(t,"class","modal-content svelte-1chdln3"),a(e,"class","modal-backdrop svelte-1chdln3")},m($,le){w($,e,le),o(e,t),o(t,n),o(n,s),o(s,r),o(r,c),o(s,u),o(s,f),o(f,m),o(n,v),o(n,_),o(t,h),o(t,S),V.block.m(S,V.anchor=null),V.mount=()=>S,V.anchor=null,o(t,y),o(t,L),o(L,C),o(C,T),o(T,O),o(C,E),o(C,z),o(z,R),o(z,I),o(z,B),o(C,P),o(C,j),o(j,U),o(L,J),o(L,X),o(X,oe),o(X,me),o(X,x),Z=!0,re||(se=[N(_,"click",l[10]),N(T,"click",l[11]),N(j,"click",l[12]),N(oe,"click",l[20]),N(x,"click",l[21]),N(t,"click",_s(l[18])),N(e,"click",l[10])],re=!0)},p($,le){l=$,(!Z||le&8)&&i!==(i=l[3].name+"")&&D(c,i),(!Z||le&8)&&p!==(p=il(l[3].timestamp)+"")&&D(m,p),V.ctx=l,le&8&&g!==(g=l[8](l[3].name))&&mt(g,V)||bs(V,l,le),(!Z||le&16&&A!==(A=l[4]===0))&&(T.disabled=A),(!Z||le&16)&&q!==(q=l[4]+1+"")&&D(R,q),(!Z||le&1)&&M!==(M=l[0].length+"")&&D(B,M),(!Z||le&17&&K!==(K=l[4]===l[0].length-1))&&(j.disabled=K)},i($){Z||(W(V.block),Z=!0)},o($){for(let le=0;le<3;le+=1){const de=V.blocks[le];Q(de)}Z=!1},d($){$&&k(e),V.block.d(),V.token=null,V=null,re=!1,_e(se)}}}function Qn(l){return{c:G,m:G,p:G,i:G,o:G,d:G}}function Kn(l){let e;function t(r,i){return r[24]?Zn:Yn}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,i){s.m(r,i),w(r,e,i)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},i:G,o:G,d(r){r&&k(e),s.d(r)}}}function Yn(l){let e;return{c(){e=d("div"),e.textContent="Failed to load image",a(e,"class","modal-error svelte-1chdln3")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function Zn(l){let e,t,n;return{c(){e=d("img"),lt(e.src,t=l[24])||a(e,"src",t),a(e,"alt",n=l[3].name),a(e,"class","modal-image svelte-1chdln3")},m(s,r){w(s,e,r)},p(s,r){r&8&&!lt(e.src,t=s[24])&&a(e,"src",t),r&8&&n!==(n=s[3].name)&&a(e,"alt",n)},d(s){s&&k(e)}}}function Xn(l){let e,t;return e=new Ue({}),{c(){fe(e.$$.fragment)},m(n,s){ce(e,n,s),t=!0},p:G,i(n){t||(W(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function rl(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S;return{c(){e=d("div"),t=d("div"),n=d("h3"),n.textContent="Confirm Delete",s=b(),r=d("p"),i=F("Are you sure you want to delete "),c=F(l[6]),u=F("?"),f=b(),p=d("div"),m=d("button"),m.textContent="Cancel",v=b(),_=d("button"),_.textContent="Delete",a(n,"class","svelte-1chdln3"),a(r,"class","svelte-1chdln3"),a(m,"class","confirm-btn cancel-btn svelte-1chdln3"),a(_,"class","confirm-btn delete-confirm-btn svelte-1chdln3"),a(p,"class","confirm-actions svelte-1chdln3"),a(t,"class","confirm-dialog svelte-1chdln3"),a(e,"class","confirm-backdrop svelte-1chdln3")},m(g,y){w(g,e,y),o(e,t),o(t,n),o(t,s),o(t,r),o(r,i),o(r,c),o(r,u),o(t,f),o(t,p),o(p,m),o(p,v),o(p,_),h||(S=[N(m,"click",l[16]),N(_,"click",l[15]),N(t,"click",_s(l[17])),N(e,"click",l[16])],h=!0)},p(g,y){y&64&&D(c,g[6])},d(g){g&&k(e),h=!1,_e(S)}}}function $n(l){let e,t,n,s,r,i=l[1]?"Loading...":"Refresh",c,u,f,p,m,v,_,h,S,g,y,L=l[2]&&ll(l);const C=[jn,Dn,Un],T=[];function O(z,q){return z[1]?0:z[0].length===0?1:2}p=O(l),m=T[p]=C[p](l);let A=l[3]&&nl(l),E=l[5]&&rl(l);return{c(){e=d("div"),t=d("div"),n=d("h1"),n.textContent="Image Gallery",s=b(),r=d("button"),c=F(i),u=b(),L&&L.c(),f=b(),m.c(),v=b(),A&&A.c(),_=b(),E&&E.c(),h=ze(),a(n,"class","svelte-1chdln3"),a(r,"class","refresh-btn svelte-1chdln3"),r.disabled=l[1],a(t,"class","header svelte-1chdln3"),a(e,"class","gallery-container svelte-1chdln3")},m(z,q){w(z,e,q),o(e,t),o(t,n),o(t,s),o(t,r),o(r,c),o(e,u),L&&L.m(e,null),o(e,f),T[p].m(e,null),w(z,v,q),A&&A.m(z,q),w(z,_,q),E&&E.m(z,q),w(z,h,q),S=!0,g||(y=N(r,"click",l[7]),g=!0)},p(z,[q]){(!S||q&2)&&i!==(i=z[1]?"Loading...":"Refresh")&&D(c,i),(!S||q&2)&&(r.disabled=z[1]),z[2]?L?(L.p(z,q),q&4&&W(L,1)):(L=ll(z),L.c(),W(L,1),L.m(e,f)):L&&(ke(),Q(L,1,1,()=>{L=null}),we());let R=p;p=O(z),p===R?T[p].p(z,q):(ke(),Q(T[R],1,1,()=>{T[R]=null}),we(),m=T[p],m?m.p(z,q):(m=T[p]=C[p](z),m.c()),W(m,1),m.m(e,null)),z[3]?A?(A.p(z,q),q&8&&W(A,1)):(A=nl(z),A.c(),W(A,1),A.m(_.parentNode,_)):A&&(ke(),Q(A,1,1,()=>{A=null}),we()),z[5]?E?E.p(z,q):(E=rl(z),E.c(),E.m(h.parentNode,h)):E&&(E.d(1),E=null)},i(z){S||(W(L),W(m),W(A),S=!0)},o(z){Q(L),Q(m),Q(A),S=!1},d(z){z&&(k(e),k(v),k(_),k(h)),L&&L.d(),T[p].d(),A&&A.d(z),E&&E.d(z),g=!1,y()}}}function il(l){return new Date(l).toLocaleString()}function ol(l){return l<1024?l+" B":l<1024*1024?(l/1024).toFixed(1)+" KB":(l/(1024*1024)).toFixed(1)+" MB"}function xn(l,e,t){let n=[],s=!0,r=null,i=null,c=-1,u={},f=!1,p=null;We(()=>{m(),document.addEventListener("keydown",S)}),it(()=>{document.removeEventListener("keydown",S),Object.values(u).forEach(I=>URL.revokeObjectURL(I))});async function m(){t(1,s=!0),t(2,r=null);try{const I=await en();t(0,n=I.files||[]),n.sort((M,B)=>B.name.localeCompare(M.name))}catch(I){t(2,r=I.message||"Failed to load gallery")}finally{t(1,s=!1)}}async function v(I){if(u[I])return u[I];try{const M=Jt(I);return u[I]=M,M}catch(M){return console.error("Failed to load image:",M),null}}async function _(I,M){t(3,i=I),t(4,c=M),await v(I.name)}function h(){t(3,i=null),t(4,c=-1),t(5,f=!1),t(6,p=null)}function S(I){i&&(I.key==="Escape"?h():I.key==="ArrowLeft"?g():I.key==="ArrowRight"&&y())}function g(){c>0&&(t(4,c--,c),t(3,i=n[c]),v(i.name))}function y(){c<n.length-1&&(t(4,c++,c),t(3,i=n[c]),v(i.name))}async function L(I){try{const M=Jt(I),P=await(await fetch(M)).blob(),j=URL.createObjectURL(P),U=document.createElement("a");U.href=j,U.download=I,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(j)}catch(M){console.error("Failed to download image:",M),alert("Failed to download image")}}function C(I){t(6,p=I),t(5,f=!0)}async function T(){if(p)try{await tn(p),u[p]&&(URL.revokeObjectURL(u[p]),delete u[p]),t(0,n=n.filter(I=>I.name!==p)),i&&i.name===p&&h(),t(5,f=!1),t(6,p=null)}catch(I){console.error("Failed to delete image:",I),alert("Failed to delete image")}}function O(){t(5,f=!1),t(6,p=null)}function A(I){Ut.call(this,l,I)}function E(I){Ut.call(this,l,I)}return[n,s,r,i,c,f,p,m,v,_,h,g,y,L,C,T,O,A,E,(I,M)=>_(I,M),()=>L(i.name),()=>C(i.name)]}class er extends Ee{constructor(e){super(),Fe(this,e,xn,$n,ye,{})}}function al(l){let e,t;return{c(){e=d("div"),t=F(l[5]),a(e,"class","message svelte-1iken05"),H(e,"success",l[6]==="success"),H(e,"error",l[6]==="error")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s&32&&D(t,n[5]),s&64&&H(e,"success",n[6]==="success"),s&64&&H(e,"error",n[6]==="error")},d(n){n&&k(e)}}}function tr(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C,T,O,A,E,z,q,R,I,M,B,P,j,U,K,J,X,oe,me,x,Z,re,se;return{c(){e=d("div"),t=d("div"),n=d("label"),n.textContent="False-Alarm Offset:",s=b(),r=d("span"),i=F(l[0]),c=F(" mm"),u=b(),f=d("div"),p=d("label"),p.textContent="Current Threshold:",m=b(),v=d("span"),_=F(l[1]),h=F(" mm"),S=b(),g=d("div"),y=d("label"),y.textContent="Calibration Offset:",L=b(),C=d("div"),T=d("input"),O=b(),A=d("span"),E=F(l[2]),z=F(" mm"),q=b(),R=d("div"),I=d("label"),I.textContent="Override Threshold (mm):",M=b(),B=d("input"),P=b(),j=d("div"),U=d("button"),K=F("ðŸ’¾ Save"),J=b(),X=d("button"),oe=F("ðŸ—‘ï¸ Clear Override"),me=b(),x=d("button"),Z=F("ðŸ”„ Recalibrate"),a(n,"class","svelte-1iken05"),a(r,"class","value svelte-1iken05"),a(t,"class","info-row svelte-1iken05"),a(p,"class","svelte-1iken05"),a(v,"class","value svelte-1iken05"),a(f,"class","info-row svelte-1iken05"),a(y,"for","calib-offset"),a(y,"class","svelte-1iken05"),a(T,"id","calib-offset"),a(T,"type","range"),a(T,"min","-100"),a(T,"max","100"),a(T,"step","1"),a(T,"class","slider svelte-1iken05"),T.disabled=l[4],a(A,"class","slider-value svelte-1iken05"),a(C,"class","slider-row svelte-1iken05"),a(g,"class","control-group svelte-1iken05"),a(I,"for","override-th"),a(I,"class","svelte-1iken05"),a(B,"id","override-th"),a(B,"type","number"),a(B,"placeholder",""),a(B,"min","0"),a(B,"class","input-field svelte-1iken05"),B.disabled=l[4],a(R,"class","control-group svelte-1iken05"),a(U,"class","btn btn-save svelte-1iken05"),U.disabled=l[4],a(X,"class","btn btn-clear svelte-1iken05"),X.disabled=l[4],a(x,"class","btn btn-recal svelte-1iken05"),x.disabled=l[4],a(j,"class","button-group svelte-1iken05"),a(e,"class","content svelte-1iken05")},m(V,$){w(V,e,$),o(e,t),o(t,n),o(t,s),o(t,r),o(r,i),o(r,c),o(e,u),o(e,f),o(f,p),o(f,m),o(f,v),o(v,_),o(v,h),o(e,S),o(e,g),o(g,y),o(g,L),o(g,C),o(C,T),te(T,l[2]),o(C,O),o(C,A),o(A,E),o(A,z),o(e,q),o(e,R),o(R,I),o(R,M),o(R,B),te(B,l[3]),o(e,P),o(e,j),o(j,U),o(U,K),o(j,J),o(j,X),o(X,oe),o(j,me),o(j,x),o(x,Z),re||(se=[N(T,"change",l[10]),N(T,"input",l[10]),N(B,"input",l[11]),N(U,"click",l[7]),N(X,"click",l[8]),N(x,"click",l[9])],re=!0)},p(V,$){$&1&&D(i,V[0]),$&2&&D(_,V[1]),$&16&&(T.disabled=V[4]),$&4&&te(T,V[2]),$&4&&D(E,V[2]),$&16&&(B.disabled=V[4]),$&8&&je(B.value)!==V[3]&&te(B,V[3]),$&16&&(U.disabled=V[4]),$&16&&(X.disabled=V[4]),$&16&&(x.disabled=V[4])},d(V){V&&k(e),re=!1,_e(se)}}}function lr(l){let e,t,n,s,r,i,c=l[5]&&al(l);return r=new Se({props:{title:"",$$slots:{default:[tr]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Calibration Settings",n=b(),c&&c.c(),s=b(),fe(r.$$.fragment),a(t,"class","svelte-1iken05"),a(e,"class","page svelte-1iken05")},m(u,f){w(u,e,f),o(e,t),o(e,n),c&&c.m(e,null),o(e,s),ce(r,e,null),i=!0},p(u,[f]){u[5]?c?c.p(u,f):(c=al(u),c.c(),c.m(e,s)):c&&(c.d(1),c=null);const p={};f&16415&&(p.$$scope={dirty:f,ctx:u}),r.$set(p)},i(u){i||(W(r.$$.fragment,u),i=!0)},o(u){Q(r.$$.fragment,u),i=!1},d(u){u&&k(e),c&&c.d(),ue(r)}}}function sr(l,e,t){let n=0,s=0,r=0,i="",c=!1,u="",f="";We(()=>{p();const g=localStorage.getItem("calibrationOffset");g!==null&&t(2,r=parseInt(g))});async function p(){try{const g=await It();t(1,s=g.threshold||0),t(0,n=g.falseAlarmOffset||0),g.calibrationOffset!==void 0&&(t(2,r=g.calibrationOffset),localStorage.setItem("calibrationOffset",r.toString())),g.overrideThreshold!==void 0&&g.overrideThreshold>0?t(3,i=g.overrideThreshold.toString()):t(3,i="")}catch(g){console.warn("Failed to load status:",g)}}async function m(){t(4,c=!0),t(5,u="");try{await ln(r),localStorage.setItem("calibrationOffset",r.toString()),i&&parseInt(i)>0?(await sn(parseInt(i)),t(5,u="Calibration offset and override threshold saved")):t(5,u="Calibration offset saved"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(g){t(5,u=`Failed to save: ${g.message||g}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,c=!1)}}async function v(){t(4,c=!0),t(5,u="");try{await nn(),t(3,i=""),t(5,u="Override cleared"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(g){t(5,u=`Failed to clear override: ${g.message||g}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,c=!1)}}async function _(){t(4,c=!0),t(5,u="");try{await rn(),t(5,u="Re-calibration started"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(g){t(5,u=`Failed to recalibrate: ${g.message||g}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,c=!1)}}function h(){r=je(this.value),t(2,r)}function S(){i=je(this.value),t(3,i)}return[n,s,r,i,c,u,f,m,v,_,h,S]}class nr extends Ee{constructor(e){super(),Fe(this,e,sr,lr,ye,{})}}function cl(l){let e,t;return{c(){e=d("div"),t=F(l[6]),a(e,"class","message svelte-1lrtwwl"),H(e,"success",l[7]==="success"),H(e,"error",l[7]==="error")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s&64&&D(t,n[6]),s&128&&H(e,"success",n[7]==="success"),s&128&&H(e,"error",n[7]==="error")},d(n){n&&k(e)}}}function rr(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C,T,O,A,E,z,q,R,I,M,B,P,j,U,K,J,X=l[4]?"Saving...":"Save",oe,me,x,Z=l[5]?"Testing...":"Test Servo",re,se,V,$;return{c(){e=d("div"),t=d("div"),n=d("label"),n.textContent="Start Position (Âµs):",s=b(),r=d("input"),i=b(),c=d("button"),u=F("Set"),f=b(),p=d("div"),m=d("label"),m.textContent="End Position (Âµs):",v=b(),_=d("input"),h=b(),S=d("button"),g=F("Set"),y=b(),L=d("div"),C=d("input"),T=b(),O=d("label"),O.textContent="Disable Servo",A=b(),E=d("div"),z=d("h3"),z.textContent="Live Control",q=b(),R=d("div"),I=d("input"),M=b(),B=d("div"),P=F(l[3]),j=F(" Âµs"),U=b(),K=d("div"),J=d("button"),oe=F(X),me=b(),x=d("button"),re=F(Z),a(n,"for","start-pos"),a(n,"class","svelte-1lrtwwl"),a(r,"id","start-pos"),a(r,"type","number"),a(r,"min","500"),a(r,"max","2500"),a(r,"step","10"),a(r,"class","svelte-1lrtwwl"),a(c,"class","btn btn-set svelte-1lrtwwl"),c.disabled=l[2],a(t,"class","position-row svelte-1lrtwwl"),a(m,"for","end-pos"),a(m,"class","svelte-1lrtwwl"),a(_,"id","end-pos"),a(_,"type","number"),a(_,"min","500"),a(_,"max","2500"),a(_,"step","10"),a(_,"class","svelte-1lrtwwl"),a(S,"class","btn btn-set svelte-1lrtwwl"),S.disabled=l[2],a(p,"class","position-row svelte-1lrtwwl"),a(C,"id","disable-servo"),a(C,"type","checkbox"),a(C,"class","svelte-1lrtwwl"),a(O,"for","disable-servo"),a(O,"class","svelte-1lrtwwl"),a(L,"class","checkbox-row svelte-1lrtwwl"),a(z,"class","svelte-1lrtwwl"),a(I,"type","range"),a(I,"min","500"),a(I,"max","2500"),a(I,"step","10"),I.disabled=l[2],a(I,"class","position-slider svelte-1lrtwwl"),a(B,"class","slider-value svelte-1lrtwwl"),a(R,"class","slider-container svelte-1lrtwwl"),a(E,"class","live-control svelte-1lrtwwl"),a(J,"class","btn btn-save svelte-1lrtwwl"),J.disabled=l[4],a(x,"class","btn btn-test svelte-1lrtwwl"),x.disabled=se=l[5]||l[2],a(K,"class","button-group svelte-1lrtwwl"),a(e,"class","settings-content svelte-1lrtwwl")},m(le,de){w(le,e,de),o(e,t),o(t,n),o(t,s),o(t,r),te(r,l[0]),o(t,i),o(t,c),o(c,u),o(e,f),o(e,p),o(p,m),o(p,v),o(p,_),te(_,l[1]),o(p,h),o(p,S),o(S,g),o(e,y),o(e,L),o(L,C),C.checked=l[2],o(L,T),o(L,O),o(e,A),o(e,E),o(E,z),o(E,q),o(E,R),o(R,I),te(I,l[3]),o(R,M),o(R,B),o(B,P),o(B,j),o(e,U),o(e,K),o(K,J),o(J,oe),o(K,me),o(K,x),o(x,re),V||($=[N(r,"input",l[12]),N(c,"click",l[13]),N(_,"input",l[14]),N(S,"click",l[15]),N(C,"change",l[16]),N(I,"change",l[17]),N(I,"input",l[17]),N(I,"input",l[11]),N(J,"click",l[9]),N(x,"click",l[10])],V=!0)},p(le,de){de&1&&je(r.value)!==le[0]&&te(r,le[0]),de&4&&(c.disabled=le[2]),de&2&&je(_.value)!==le[1]&&te(_,le[1]),de&4&&(S.disabled=le[2]),de&4&&(C.checked=le[2]),de&4&&(I.disabled=le[2]),de&8&&te(I,le[3]),de&8&&D(P,le[3]),de&16&&X!==(X=le[4]?"Saving...":"Save")&&D(oe,X),de&16&&(J.disabled=le[4]),de&32&&Z!==(Z=le[5]?"Testing...":"Test Servo")&&D(re,Z),de&36&&se!==(se=le[5]||le[2])&&(x.disabled=se)},d(le){le&&k(e),V=!1,_e($)}}}function ir(l){let e,t,n,s,r,i,c=l[6]&&cl(l);return r=new Se({props:{title:"",$$slots:{default:[rr]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Servo Settings",n=b(),c&&c.c(),s=b(),fe(r.$$.fragment),a(t,"class","svelte-1lrtwwl"),a(e,"class","page svelte-1lrtwwl")},m(u,f){w(u,e,f),o(e,t),o(e,n),c&&c.m(e,null),o(e,s),ce(r,e,null),i=!0},p(u,[f]){u[6]?c?c.p(u,f):(c=cl(u),c.c(),c.m(e,s)):c&&(c.d(1),c=null);const p={};f&524351&&(p.$$scope={dirty:f,ctx:u}),r.$set(p)},i(u){i||(W(r.$$.fragment,u),i=!0)},o(u){Q(r.$$.fragment,u),i=!1},d(u){u&&k(e),c&&c.d(),ue(r)}}}function or(l,e,t){let n=1500,s=1100,r=!1,i=1500,c=!1,u=!1,f="",p="";async function m(){try{const A=await an();A.startUS!==void 0&&t(0,n=A.startUS),A.endUS!==void 0&&t(1,s=A.endUS);const E=localStorage.getItem("disableServo");E!==null?t(2,r=E==="true"):A.disabled!==void 0&&t(2,r=A.disabled),t(3,i=n)}catch(A){console.warn("Failed to load servo settings:",A)}}async function v(A,E){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}try{await fetch(`/servoSet?val=${A}`),t(6,f=`${E} set to ${A}Âµs`),t(7,p="success"),setTimeout(()=>{t(6,f="")},2e3)}catch{t(6,f=`Failed to set ${E}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}}async function _(){t(4,c=!0),t(6,f="");try{await cn({startUS:n,endUS:s,disabled:r}),localStorage.setItem("disableServo",r.toString()),t(6,f="Settings saved successfully"),t(7,p="success"),setTimeout(()=>{t(6,f="")},3e3)}catch(A){t(6,f=`Failed to save: ${A.message}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}finally{t(4,c=!1)}}async function h(){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}t(5,u=!0),t(6,f="");try{await ws(),t(6,f="Servo triggered"),t(7,p="success"),setTimeout(()=>{t(6,f="")},2e3)}catch(A){t(6,f=`Failed to trigger servo: ${A.message}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}finally{t(5,u=!1)}}function S(){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}try{fetch(`/servoSet?val=${i}`)}catch(A){console.error("Failed to update live position:",A)}}We(()=>{m()});function g(){n=je(this.value),t(0,n)}const y=()=>v(n,"Start position");function L(){s=je(this.value),t(1,s)}const C=()=>v(s,"End position");function T(){r=this.checked,t(2,r)}function O(){i=je(this.value),t(3,i)}return[n,s,r,i,c,u,f,p,v,_,h,S,g,y,L,C,T,O]}class ar extends Ee{constructor(e){super(),Fe(this,e,or,ir,ye,{})}}function cr(l){let e,t,n,s,r,i,c;return t=new Se({props:{title:"IP Filtering",$$slots:{default:[dr]},$$scope:{ctx:l}}}),s=new Se({props:{title:"MQTT Configuration",$$slots:{default:[pr]},$$scope:{ctx:l}}}),i=new Se({props:{title:"Video Mode",$$slots:{default:[mr]},$$scope:{ctx:l}}}),{c(){e=d("div"),fe(t.$$.fragment),n=b(),fe(s.$$.fragment),r=b(),fe(i.$$.fragment),a(e,"class","settings-grid svelte-dlnskf")},m(u,f){w(u,e,f),ce(t,e,null),o(e,n),ce(s,e,null),o(e,r),ce(i,e,null),c=!0},p(u,f){const p={};f[0]&124|f[1]&128&&(p.$$scope={dirty:f,ctx:u}),t.$set(p);const m={};f[0]&130944|f[1]&128&&(m.$$scope={dirty:f,ctx:u}),s.$set(m);const v={};f[0]&917504|f[1]&128&&(v.$$scope={dirty:f,ctx:u}),i.$set(v)},i(u){c||(W(t.$$.fragment,u),W(s.$$.fragment,u),W(i.$$.fragment,u),c=!0)},o(u){Q(t.$$.fragment,u),Q(s.$$.fragment,u),Q(i.$$.fragment,u),c=!1},d(u){u&&k(e),ue(t),ue(s),ue(i)}}}function ur(l){let e,t;return e=new Ts({props:{message:l[1],onRetry:l[20]}}),{c(){fe(e.$$.fragment)},m(n,s){ce(e,n,s),t=!0},p(n,s){const r={};s[0]&2&&(r.message=n[1]),e.$set(r)},i(n){t||(W(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function fr(l){let e,t,n;return t=new Ue({}),{c(){e=d("div"),fe(t.$$.fragment),a(e,"class","loading-container svelte-dlnskf")},m(s,r){w(s,e,r),ce(t,e,null),n=!0},p:G,i(s){n||(W(t.$$.fragment,s),n=!0)},o(s){Q(t.$$.fragment,s),n=!1},d(s){s&&k(e),ue(t)}}}function ul(l){let e,t,n,s;return{c(){e=d("div"),t=F("Your IP: "),n=d("span"),s=F(l[4]),a(n,"class","client-ip svelte-dlnskf"),a(e,"class","info-text svelte-dlnskf")},m(r,i){w(r,e,i),o(e,t),o(e,n),o(n,s)},p(r,i){i[0]&16&&D(s,r[4])},d(r){r&&k(e)}}}function fl(l){let e,t;return{c(){e=d("div"),t=F(l[5]),a(e,"class","error-text svelte-dlnskf")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s[0]&32&&D(t,n[5])},d(n){n&&k(e)}}}function dr(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C=l[6]?"Saving...":"Save IP Filters",T,O,A,E=l[4]&&ul(l),z=l[5]&&fl(l);return{c(){e=d("div"),E&&E.c(),t=b(),n=d("div"),s=d("label"),s.textContent="Whitelist (comma-separated CIDRs)",r=b(),i=d("input"),c=b(),u=d("div"),u.textContent="Leave empty to allow all IPs",f=b(),p=d("div"),m=d("label"),m.textContent="Blacklist (comma-separated CIDRs)",v=b(),_=d("input"),h=b(),S=d("div"),S.textContent="Blocked IPs take precedence over whitelist",g=b(),z&&z.c(),y=b(),L=d("button"),T=F(C),a(s,"for","whitelist"),a(s,"class","svelte-dlnskf"),a(i,"id","whitelist"),a(i,"type","text"),a(i,"placeholder","192.168.1.0/24, 10.0.0.1"),i.disabled=l[6],a(i,"class","svelte-dlnskf"),a(u,"class","help-text svelte-dlnskf"),a(n,"class","form-group svelte-dlnskf"),a(m,"for","blacklist"),a(m,"class","svelte-dlnskf"),a(_,"id","blacklist"),a(_,"type","text"),a(_,"placeholder","192.168.99.0/24, 172.16.0.1"),_.disabled=l[6],a(_,"class","svelte-dlnskf"),a(S,"class","help-text svelte-dlnskf"),a(p,"class","form-group svelte-dlnskf"),a(L,"class","btn-primary svelte-dlnskf"),L.disabled=l[6],a(e,"class","form-section svelte-dlnskf")},m(q,R){w(q,e,R),E&&E.m(e,null),o(e,t),o(e,n),o(n,s),o(n,r),o(n,i),te(i,l[2]),o(n,c),o(n,u),o(e,f),o(e,p),o(p,m),o(p,v),o(p,_),te(_,l[3]),o(p,h),o(p,S),o(e,g),z&&z.m(e,null),o(e,y),o(e,L),o(L,T),O||(A=[N(i,"input",l[25]),N(_,"input",l[26]),N(L,"click",l[21])],O=!0)},p(q,R){q[4]?E?E.p(q,R):(E=ul(q),E.c(),E.m(e,t)):E&&(E.d(1),E=null),R[0]&64&&(i.disabled=q[6]),R[0]&4&&i.value!==q[2]&&te(i,q[2]),R[0]&64&&(_.disabled=q[6]),R[0]&8&&_.value!==q[3]&&te(_,q[3]),q[5]?z?z.p(q,R):(z=fl(q),z.c(),z.m(e,y)):z&&(z.d(1),z=null),R[0]&64&&C!==(C=q[6]?"Saving...":"Save IP Filters")&&D(T,C),R[0]&64&&(L.disabled=q[6])},d(q){q&&k(e),E&&E.d(),z&&z.d(),O=!1,_e(A)}}}function dl(l){let e,t;return{c(){e=d("div"),t=F(l[14]),a(e,"class","error-text svelte-dlnskf")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s[0]&16384&&D(t,n[14])},d(n){n&&k(e)}}}function pr(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C,T,O,A,E,z,q,R,I,M,B,P,j,U,K,J,X=l[13]?"Hide":"Show",oe,me,x,Z,re,se,V,$,le,de,Te,be,ie=l[15]?"Saving...":"Save MQTT Config",ee,Y,he,De=l[16]?"Testing...":"Test Connection",Be,Ve,Ze,Qe,Ce=l[14]&&dl(l);return{c(){e=d("div"),t=d("div"),n=d("label"),s=d("input"),r=b(),i=d("span"),i.textContent="Enable MQTT",c=b(),u=d("div"),f=d("label"),f.textContent="Broker Address",p=b(),m=d("input"),_=b(),h=d("div"),S=d("label"),S.textContent="Port",g=b(),y=d("input"),C=b(),T=d("div"),O=d("label"),O.textContent="Username",A=b(),E=d("input"),q=b(),R=d("div"),I=d("label"),I.textContent="Password",M=b(),B=d("div"),P=d("input"),K=b(),J=d("button"),oe=F(X),x=b(),Z=d("div"),re=d("label"),re.textContent="Topic Prefix",se=b(),V=d("input"),le=b(),Ce&&Ce.c(),de=b(),Te=d("div"),be=d("button"),ee=F(ie),Y=b(),he=d("button"),Be=F(De),a(s,"type","checkbox"),s.disabled=l[15],a(s,"class","svelte-dlnskf"),a(i,"class","svelte-dlnskf"),a(n,"class","svelte-dlnskf"),a(t,"class","form-group checkbox-group svelte-dlnskf"),a(f,"for","mqtt-broker"),a(f,"class","svelte-dlnskf"),a(m,"id","mqtt-broker"),a(m,"type","text"),a(m,"placeholder","mqtt.example.com"),m.disabled=v=l[15]||!l[12],a(m,"class","svelte-dlnskf"),a(u,"class","form-group svelte-dlnskf"),a(S,"for","mqtt-port"),a(S,"class","svelte-dlnskf"),a(y,"id","mqtt-port"),a(y,"type","number"),a(y,"placeholder","1883"),a(y,"min","1"),a(y,"max","65535"),y.disabled=L=l[15]||!l[12],a(y,"class","svelte-dlnskf"),a(h,"class","form-group svelte-dlnskf"),a(O,"for","mqtt-user"),a(O,"class","svelte-dlnskf"),a(E,"id","mqtt-user"),a(E,"type","text"),a(E,"placeholder","Optional"),E.disabled=z=l[15]||!l[12],a(E,"class","svelte-dlnskf"),a(T,"class","form-group svelte-dlnskf"),a(I,"for","mqtt-password"),a(I,"class","svelte-dlnskf"),a(P,"id","mqtt-password"),a(P,"type",j=l[13]?"text":"password"),P.value=l[10],a(P,"placeholder","Optional"),P.disabled=U=l[15]||!l[12],a(P,"class","svelte-dlnskf"),a(J,"type","button"),a(J,"class","toggle-password svelte-dlnskf"),J.disabled=me=!l[12],a(B,"class","password-input-group svelte-dlnskf"),a(R,"class","form-group svelte-dlnskf"),a(re,"for","mqtt-topic"),a(re,"class","svelte-dlnskf"),a(V,"id","mqtt-topic"),a(V,"type","text"),a(V,"placeholder","mousetrap"),V.disabled=$=l[15]||!l[12],a(V,"class","svelte-dlnskf"),a(Z,"class","form-group svelte-dlnskf"),a(be,"class","btn-primary svelte-dlnskf"),be.disabled=l[15],a(he,"class","btn-secondary svelte-dlnskf"),he.disabled=Ve=l[16]||!l[12]||!l[7],a(Te,"class","button-group svelte-dlnskf"),a(e,"class","form-section svelte-dlnskf")},m(ne,pe){w(ne,e,pe),o(e,t),o(t,n),o(n,s),s.checked=l[12],o(n,r),o(n,i),o(e,c),o(e,u),o(u,f),o(u,p),o(u,m),te(m,l[7]),o(e,_),o(e,h),o(h,S),o(h,g),o(h,y),te(y,l[8]),o(e,C),o(e,T),o(T,O),o(T,A),o(T,E),te(E,l[9]),o(e,q),o(e,R),o(R,I),o(R,M),o(R,B),o(B,P),o(B,K),o(B,J),o(J,oe),o(e,x),o(e,Z),o(Z,re),o(Z,se),o(Z,V),te(V,l[11]),o(e,le),Ce&&Ce.m(e,null),o(e,de),o(e,Te),o(Te,be),o(be,ee),o(Te,Y),o(Te,he),o(he,Be),Ze||(Qe=[N(s,"change",l[27]),N(m,"input",l[28]),N(y,"input",l[29]),N(E,"input",l[30]),N(P,"input",l[31]),N(J,"click",l[32]),N(V,"input",l[33]),N(be,"click",l[22]),N(he,"click",l[23])],Ze=!0)},p(ne,pe){pe[0]&32768&&(s.disabled=ne[15]),pe[0]&4096&&(s.checked=ne[12]),pe[0]&36864&&v!==(v=ne[15]||!ne[12])&&(m.disabled=v),pe[0]&128&&m.value!==ne[7]&&te(m,ne[7]),pe[0]&36864&&L!==(L=ne[15]||!ne[12])&&(y.disabled=L),pe[0]&256&&je(y.value)!==ne[8]&&te(y,ne[8]),pe[0]&36864&&z!==(z=ne[15]||!ne[12])&&(E.disabled=z),pe[0]&512&&E.value!==ne[9]&&te(E,ne[9]),pe[0]&8192&&j!==(j=ne[13]?"text":"password")&&a(P,"type",j),pe[0]&1024&&P.value!==ne[10]&&(P.value=ne[10]),pe[0]&36864&&U!==(U=ne[15]||!ne[12])&&(P.disabled=U),pe[0]&8192&&X!==(X=ne[13]?"Hide":"Show")&&D(oe,X),pe[0]&4096&&me!==(me=!ne[12])&&(J.disabled=me),pe[0]&36864&&$!==($=ne[15]||!ne[12])&&(V.disabled=$),pe[0]&2048&&V.value!==ne[11]&&te(V,ne[11]),ne[14]?Ce?Ce.p(ne,pe):(Ce=dl(ne),Ce.c(),Ce.m(e,de)):Ce&&(Ce.d(1),Ce=null),pe[0]&32768&&ie!==(ie=ne[15]?"Saving...":"Save MQTT Config")&&D(ee,ie),pe[0]&32768&&(be.disabled=ne[15]),pe[0]&65536&&De!==(De=ne[16]?"Testing...":"Test Connection")&&D(Be,De),pe[0]&69760&&Ve!==(Ve=ne[16]||!ne[12]||!ne[7])&&(he.disabled=Ve)},d(ne){ne&&k(e),Ce&&Ce.d(),Ze=!1,_e(Qe)}}}function pl(l){let e,t;return{c(){e=d("div"),t=F(l[19]),a(e,"class","error-text svelte-dlnskf")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s[0]&524288&&D(t,n[19])},d(n){n&&k(e)}}}function mr(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C,T,O,A,E,z,q=l[18]?"Applying...":"Apply Video Mode",R,I,M,B,P=l[19]&&pl(l);return I=Is(l[35][0]),{c(){e=d("div"),t=d("div"),t.textContent="Changing video mode will restart the camera",n=b(),s=d("div"),r=d("label"),r.textContent="Resolution",i=b(),c=d("div"),u=d("label"),f=d("input"),p=b(),m=d("span"),m.textContent="SVGA (800x600)",v=b(),_=d("label"),h=d("input"),S=b(),g=d("span"),g.textContent="VGA (640x480)",y=b(),L=d("label"),C=d("input"),T=b(),O=d("span"),O.textContent="CIF (352x288)",A=b(),P&&P.c(),E=b(),z=d("button"),R=F(q),a(t,"class","warning-text svelte-dlnskf"),a(r,"class","svelte-dlnskf"),a(f,"type","radio"),f.__value="SVGA",te(f,f.__value),f.disabled=l[18],a(f,"class","svelte-dlnskf"),a(m,"class","svelte-dlnskf"),a(u,"class","radio-label svelte-dlnskf"),a(h,"type","radio"),h.__value="VGA",te(h,h.__value),h.disabled=l[18],a(h,"class","svelte-dlnskf"),a(g,"class","svelte-dlnskf"),a(_,"class","radio-label svelte-dlnskf"),a(C,"type","radio"),C.__value="CIF",te(C,C.__value),C.disabled=l[18],a(C,"class","svelte-dlnskf"),a(O,"class","svelte-dlnskf"),a(L,"class","radio-label svelte-dlnskf"),a(c,"class","radio-group svelte-dlnskf"),a(s,"class","form-group svelte-dlnskf"),a(z,"class","btn-primary svelte-dlnskf"),z.disabled=l[18],a(e,"class","form-section svelte-dlnskf"),I.p(f,h,C)},m(j,U){w(j,e,U),o(e,t),o(e,n),o(e,s),o(s,r),o(s,i),o(s,c),o(c,u),o(u,f),f.checked=f.__value===l[17],o(u,p),o(u,m),o(c,v),o(c,_),o(_,h),h.checked=h.__value===l[17],o(_,S),o(_,g),o(c,y),o(c,L),o(L,C),C.checked=C.__value===l[17],o(L,T),o(L,O),o(e,A),P&&P.m(e,null),o(e,E),o(e,z),o(z,R),M||(B=[N(f,"change",l[34]),N(h,"change",l[36]),N(C,"change",l[37]),N(z,"click",l[24])],M=!0)},p(j,U){U[0]&262144&&(f.disabled=j[18]),U[0]&131072&&(f.checked=f.__value===j[17]),U[0]&262144&&(h.disabled=j[18]),U[0]&131072&&(h.checked=h.__value===j[17]),U[0]&262144&&(C.disabled=j[18]),U[0]&131072&&(C.checked=C.__value===j[17]),j[19]?P?P.p(j,U):(P=pl(j),P.c(),P.m(e,E)):P&&(P.d(1),P=null),U[0]&262144&&q!==(q=j[18]?"Applying...":"Apply Video Mode")&&D(R,q),U[0]&262144&&(z.disabled=j[18])},d(j){j&&k(e),P&&P.d(),I.r(),M=!1,_e(B)}}}function vr(l){let e,t,n,s,r,i;const c=[fr,ur,cr],u=[];function f(p,m){return p[0]?0:p[1]?1:2}return s=f(l),r=u[s]=c[s](l),{c(){e=d("div"),t=d("div"),t.innerHTML='<h1 class="svelte-dlnskf">Settings</h1>',n=b(),r.c(),a(t,"class","header svelte-dlnskf"),a(e,"class","settings-container svelte-dlnskf")},m(p,m){w(p,e,m),o(e,t),o(e,n),u[s].m(e,null),i=!0},p(p,m){let v=s;s=f(p),s===v?u[s].p(p,m):(ke(),Q(u[v],1,1,()=>{u[v]=null}),we(),r=u[s],r?r.p(p,m):(r=u[s]=c[s](p),r.c()),W(r,1),r.m(e,null))},i(p){i||(W(r),i=!0)},o(p){Q(r),i=!1},d(p){p&&k(e),u[s].d()}}}function ml(l){if(l=l.trim(),!l)return!0;if(!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$/.test(l))return!1;const t=l.split("/"),n=t[0].split(".");for(let s of n){const r=parseInt(s);if(r<0||r>255)return!1}if(t[1]){const s=parseInt(t[1]);if(s<0||s>32)return!1}return!0}function _r(l,e,t){let n=!0,s=null,r="",i="",c="",u="",f=!1,p="",m=1883,v="",_="",h="",S=!1,g=!1,y="",L=!1,C=!1,T="SVGA",O=!1,A="";We(async()=>{await E()});async function E(){t(0,n=!0),t(1,s=null);try{const[se,V,$]=await Promise.all([un(),dn(),mn()]);t(2,r=se.whitelist.join(", ")),t(3,i=se.blacklist.join(", ")),t(4,c=se.clientIP||""),t(7,p=V.broker||""),t(8,m=V.port||1883),t(9,v=V.user||""),t(10,_=V.password||""),t(11,h=V.topic||""),t(12,S=V.enabled||!1),t(17,T=$.mode||"SVGA"),t(0,n=!1)}catch(se){t(1,s=se.message||"Failed to load settings"),t(0,n=!1)}}async function z(){t(5,u="");const se=r.split(",").map($=>$.trim()).filter($=>$),V=i.split(",").map($=>$.trim()).filter($=>$);for(let $ of se)if(!ml($)){t(5,u=`Invalid CIDR format in whitelist: ${$}`);return}for(let $ of V)if(!ml($)){t(5,u=`Invalid CIDR format in blacklist: ${$}`);return}t(6,f=!0);try{await fn({whitelist:se,blacklist:V}),t(6,f=!1)}catch($){t(5,u=$.message||"Failed to save IP filters"),t(6,f=!1)}}async function q(){if(t(14,y=""),S&&!p){t(14,y="Broker address is required when MQTT is enabled");return}if(m<1||m>65535){t(14,y="Port must be between 1 and 65535");return}t(15,L=!0);try{await pn({broker:p,port:m,user:v,password:_,topic:h,enabled:S}),t(15,L=!1)}catch(se){t(14,y=se.message||"Failed to save MQTT configuration"),t(15,L=!1)}}async function R(){if(t(14,y=""),!p){t(14,y="Broker address is required");return}t(16,C=!0);try{await new Promise(se=>setTimeout(se,1e3)),t(16,C=!1),alert("MQTT connection test successful")}catch(se){t(14,y=se.message||"Connection test failed"),t(16,C=!1)}}async function I(){if(t(19,A=""),!!confirm("Changing video mode will restart the camera. Continue?")){t(18,O=!0);try{await vn({mode:T}),t(18,O=!1)}catch(V){t(19,A=V.message||"Failed to apply video mode"),t(18,O=!1)}}}const M=[[]];function B(){r=this.value,t(2,r)}function P(){i=this.value,t(3,i)}function j(){S=this.checked,t(12,S)}function U(){p=this.value,t(7,p)}function K(){m=je(this.value),t(8,m)}function J(){v=this.value,t(9,v)}const X=se=>t(10,_=se.target.value),oe=()=>t(13,g=!g);function me(){h=this.value,t(11,h)}function x(){T=this.__value,t(17,T)}function Z(){T=this.__value,t(17,T)}function re(){T=this.__value,t(17,T)}return[n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C,T,O,A,E,z,q,R,I,B,P,j,U,K,J,X,oe,me,x,M,Z,re]}class br extends Ee{constructor(e){super(),Fe(this,e,_r,vr,ye,{},null,[-1,-1])}}const{document:hr}=vs;function vl(l,e,t){const n=l.slice();return n[45]=e[t],n}function _l(l,e,t){const n=l.slice();return n[45]=e[t],n}function bl(l,e,t){const n=l.slice();return n[45]=e[t],n}function hl(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",a(e,"class","btn-small svelte-16e85dp")},m(s,r){w(s,e,r),t||(n=N(e,"click",l[26]),t=!0)},p:G,d(s){s&&k(e),t=!1,n()}}}function gl(l){let e;function t(r,i){return r[6]?Sr:r[9]?Cr:r[21].length===0&&r[3]?wr:r[0].length===0?kr:gr}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),a(e,"class","log-content svelte-16e85dp"),H(e,"expanded",l[13])},m(r,i){w(r,e,i),s.m(e,null),l[35](e)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),i[0]&8192&&H(e,"expanded",r[13])},d(r){r&&k(e),s.d(),l[35](null)}}}function gr(l){let e,t,n,s=Le(l[21]),r=[];for(let c=0;c<s.length;c+=1)r[c]=kl(bl(l,s,c));let i=l[3]&&l[21].length>0&&wl(l);return{c(){e=d("div");for(let c=0;c<r.length;c+=1)r[c].c();t=b(),i&&i.c(),n=ze(),a(e,"class","log-list svelte-16e85dp")},m(c,u){w(c,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);w(c,t,u),i&&i.m(c,u),w(c,n,u)},p(c,u){if(u[0]&2097152){s=Le(c[21]);let f;for(f=0;f<s.length;f+=1){const p=bl(c,s,f);r[f]?r[f].p(p,u):(r[f]=kl(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}c[3]&&c[21].length>0?i?i.p(c,u):(i=wl(c),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(c){c&&(k(e),k(t),k(n)),Je(r,c),i&&i.d(c)}}}function kr(l){let e;return{c(){e=d("div"),e.textContent="No system logs available",a(e,"class","no-data svelte-16e85dp")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function wr(l){let e,t,n,s;return{c(){e=d("div"),t=F('No logs match filter "'),n=F(l[3]),s=F('"'),a(e,"class","no-results svelte-16e85dp")},m(r,i){w(r,e,i),o(e,t),o(e,n),o(e,s)},p(r,i){i[0]&8&&D(n,r[3])},d(r){r&&k(e)}}}function Cr(l){let e,t,n;return{c(){e=d("div"),t=F("Error: "),n=F(l[9]),a(e,"class","error svelte-16e85dp")},m(s,r){w(s,e,r),o(e,t),o(e,n)},p(s,r){r[0]&512&&D(n,s[9])},d(s){s&&k(e)}}}function Sr(l){let e;return{c(){e=d("div"),e.textContent="Loading system logs...",a(e,"class","loading svelte-16e85dp")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function kl(l){let e,t=l[45]+"",n;return{c(){e=d("div"),n=F(t),a(e,"class","log-line svelte-16e85dp")},m(s,r){w(s,e,r),o(e,n)},p(s,r){r[0]&2097152&&t!==(t=s[45]+"")&&D(n,t)},d(s){s&&k(e)}}}function wl(l){let e,t,n=l[21].length+"",s,r,i=l[0].length+"",c,u;return{c(){e=d("div"),t=F("Showing "),s=F(n),r=F(" of "),c=F(i),u=F(" logs"),a(e,"class","filter-info svelte-16e85dp")},m(f,p){w(f,e,p),o(e,t),o(e,s),o(e,r),o(e,c),o(e,u)},p(f,p){p[0]&2097152&&n!==(n=f[21].length+"")&&D(s,n),p[0]&1&&i!==(i=f[0].length+"")&&D(c,i)},d(f){f&&k(e)}}}function Cl(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",a(e,"class","btn-small svelte-16e85dp")},m(s,r){w(s,e,r),t||(n=N(e,"click",l[27]),t=!0)},p:G,d(s){s&&k(e),t=!1,n()}}}function Sl(l){let e;function t(r,i){return r[7]?Fr:r[10]?zr:r[20].length===0&&r[4]?Lr:r[1].length===0?Tr:yr}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),a(e,"class","log-content svelte-16e85dp"),H(e,"expanded",l[14])},m(r,i){w(r,e,i),s.m(e,null),l[38](e)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),i[0]&16384&&H(e,"expanded",r[14])},d(r){r&&k(e),s.d(),l[38](null)}}}function yr(l){let e,t,n,s=Le(l[20]),r=[];for(let c=0;c<s.length;c+=1)r[c]=yl(_l(l,s,c));let i=l[4]&&l[20].length>0&&Tl(l);return{c(){e=d("div");for(let c=0;c<r.length;c+=1)r[c].c();t=b(),i&&i.c(),n=ze(),a(e,"class","log-list svelte-16e85dp")},m(c,u){w(c,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);w(c,t,u),i&&i.m(c,u),w(c,n,u)},p(c,u){if(u[0]&1048576){s=Le(c[20]);let f;for(f=0;f<s.length;f+=1){const p=_l(c,s,f);r[f]?r[f].p(p,u):(r[f]=yl(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}c[4]&&c[20].length>0?i?i.p(c,u):(i=Tl(c),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(c){c&&(k(e),k(t),k(n)),Je(r,c),i&&i.d(c)}}}function Tr(l){let e;return{c(){e=d("div"),e.textContent="No previous logs available",a(e,"class","no-data svelte-16e85dp")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function Lr(l){let e,t,n,s;return{c(){e=d("div"),t=F('No logs match filter "'),n=F(l[4]),s=F('"'),a(e,"class","no-results svelte-16e85dp")},m(r,i){w(r,e,i),o(e,t),o(e,n),o(e,s)},p(r,i){i[0]&16&&D(n,r[4])},d(r){r&&k(e)}}}function zr(l){let e,t,n;return{c(){e=d("div"),t=F("Error: "),n=F(l[10]),a(e,"class","error svelte-16e85dp")},m(s,r){w(s,e,r),o(e,t),o(e,n)},p(s,r){r[0]&1024&&D(n,s[10])},d(s){s&&k(e)}}}function Fr(l){let e;return{c(){e=d("div"),e.textContent="Loading previous logs...",a(e,"class","loading svelte-16e85dp")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function yl(l){let e,t=l[45]+"",n;return{c(){e=d("div"),n=F(t),a(e,"class","log-line svelte-16e85dp")},m(s,r){w(s,e,r),o(e,n)},p(s,r){r[0]&1048576&&t!==(t=s[45]+"")&&D(n,t)},d(s){s&&k(e)}}}function Tl(l){let e,t,n=l[20].length+"",s,r,i=l[1].length+"",c,u;return{c(){e=d("div"),t=F("Showing "),s=F(n),r=F(" of "),c=F(i),u=F(" logs"),a(e,"class","filter-info svelte-16e85dp")},m(f,p){w(f,e,p),o(e,t),o(e,s),o(e,r),o(e,c),o(e,u)},p(f,p){p[0]&1048576&&n!==(n=f[20].length+"")&&D(s,n),p[0]&2&&i!==(i=f[1].length+"")&&D(c,i)},d(f){f&&k(e)}}}function Ll(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",a(e,"class","btn-small svelte-16e85dp")},m(s,r){w(s,e,r),t||(n=N(e,"click",l[28]),t=!0)},p:G,d(s){s&&k(e),t=!1,n()}}}function zl(l){let e;function t(r,i){return r[8]?Or:r[11]?Ir:r[19].length===0&&r[5]?qr:r[2].length===0?Ar:Er}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),a(e,"class","log-content svelte-16e85dp"),H(e,"expanded",l[15])},m(r,i){w(r,e,i),s.m(e,null),l[41](e)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),i[0]&32768&&H(e,"expanded",r[15])},d(r){r&&k(e),s.d(),l[41](null)}}}function Er(l){let e,t,n,s=Le(l[19]),r=[];for(let c=0;c<s.length;c+=1)r[c]=Fl(vl(l,s,c));let i=l[5]&&l[19].length>0&&El(l);return{c(){e=d("div");for(let c=0;c<r.length;c+=1)r[c].c();t=b(),i&&i.c(),n=ze(),a(e,"class","log-list svelte-16e85dp")},m(c,u){w(c,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);w(c,t,u),i&&i.m(c,u),w(c,n,u)},p(c,u){if(u[0]&524288){s=Le(c[19]);let f;for(f=0;f<s.length;f+=1){const p=vl(c,s,f);r[f]?r[f].p(p,u):(r[f]=Fl(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}c[5]&&c[19].length>0?i?i.p(c,u):(i=El(c),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(c){c&&(k(e),k(t),k(n)),Je(r,c),i&&i.d(c)}}}function Ar(l){let e;return{c(){e=d("div"),e.textContent="No older logs available (logs from 2 boots ago)",a(e,"class","no-data svelte-16e85dp")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function qr(l){let e,t,n,s;return{c(){e=d("div"),t=F('No logs match filter "'),n=F(l[5]),s=F('"'),a(e,"class","no-results svelte-16e85dp")},m(r,i){w(r,e,i),o(e,t),o(e,n),o(e,s)},p(r,i){i[0]&32&&D(n,r[5])},d(r){r&&k(e)}}}function Ir(l){let e,t,n;return{c(){e=d("div"),t=F("Error: "),n=F(l[11]),a(e,"class","error svelte-16e85dp")},m(s,r){w(s,e,r),o(e,t),o(e,n)},p(s,r){r[0]&2048&&D(n,s[11])},d(s){s&&k(e)}}}function Or(l){let e;return{c(){e=d("div"),e.textContent="Loading older logs...",a(e,"class","loading svelte-16e85dp")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function Fl(l){let e,t=l[45]+"",n;return{c(){e=d("div"),n=F(t),a(e,"class","log-line svelte-16e85dp")},m(s,r){w(s,e,r),o(e,n)},p(s,r){r[0]&524288&&t!==(t=s[45]+"")&&D(n,t)},d(s){s&&k(e)}}}function El(l){let e,t,n=l[19].length+"",s,r,i=l[2].length+"",c,u;return{c(){e=d("div"),t=F("Showing "),s=F(n),r=F(" of "),c=F(i),u=F(" logs"),a(e,"class","filter-info svelte-16e85dp")},m(f,p){w(f,e,p),o(e,t),o(e,s),o(e,r),o(e,c),o(e,u)},p(f,p){p[0]&524288&&n!==(n=f[19].length+"")&&D(s,n),p[0]&4&&i!==(i=f[2].length+"")&&D(c,i)},d(f){f&&k(e)}}}function Pr(l){let e,t,n,s,r,i,c,u=l[12]?"Auto-refresh On":"Auto-refresh Off",f,p,m,v,_,h,S,g,y,L,C=l[13]?"â–¼":"â–¶",T,O,A,E,z,q,R,I,M,B,P,j,U,K,J,X,oe=l[14]?"â–¼":"â–¶",me,x,Z,re,se,V,$,le,de,Te,be,ie,ee,Y,he,De,Be=l[15]?"â–¼":"â–¶",Ve,Ze,Qe,Ce,ne,pe,Ot,bt,Ke,Pt,at,Nt,ht,Rt,Ae=l[3]&&hl(l),qe=l[13]&&gl(l),Ie=l[4]&&Cl(l),Oe=l[14]&&Sl(l),Pe=l[5]&&Ll(l),Ne=l[15]&&zl(l);return{c(){e=b(),t=d("div"),n=d("div"),s=d("h1"),s.textContent="Logs & Diagnostics",r=b(),i=d("div"),c=d("button"),f=F(u),p=F(" ("),m=F(Ls),v=F("s)"),_=b(),h=d("button"),h.textContent="Refresh Now",S=b(),g=d("div"),y=d("div"),L=d("button"),T=F(C),O=b(),A=d("h2"),A.textContent="System Logs",E=b(),z=d("div"),q=d("input"),R=b(),Ae&&Ae.c(),I=b(),M=d("button"),B=F("Export"),j=b(),qe&&qe.c(),U=b(),K=d("div"),J=d("div"),X=d("button"),me=F(oe),x=b(),Z=d("h2"),Z.textContent="Previous System Logs",re=b(),se=d("div"),V=d("input"),$=b(),Ie&&Ie.c(),le=b(),de=d("button"),Te=F("Export"),ie=b(),Oe&&Oe.c(),ee=b(),Y=d("div"),he=d("div"),De=d("button"),Ve=F(Be),Ze=b(),Qe=d("h2"),Qe.textContent="Older Logs (2 boots ago)",Ce=b(),ne=d("div"),pe=d("input"),Ot=b(),Pe&&Pe.c(),bt=b(),Ke=d("button"),Pt=F("Export"),Nt=b(),Ne&&Ne.c(),hr.title="Logs & Diagnostics - MouseTrap",a(s,"class","svelte-16e85dp"),a(c,"class","btn svelte-16e85dp"),H(c,"active",l[12]),a(h,"class","btn svelte-16e85dp"),a(i,"class","header-controls svelte-16e85dp"),a(n,"class","header svelte-16e85dp"),a(L,"class","expand-btn svelte-16e85dp"),a(A,"class","svelte-16e85dp"),a(q,"type","text"),a(q,"class","filter-input svelte-16e85dp"),a(q,"placeholder","Filter logs..."),a(M,"class","btn-small svelte-16e85dp"),M.disabled=P=l[0].length===0,a(z,"class","log-controls svelte-16e85dp"),a(y,"class","log-header svelte-16e85dp"),a(g,"class","log-section svelte-16e85dp"),a(X,"class","expand-btn svelte-16e85dp"),a(Z,"class","svelte-16e85dp"),a(V,"type","text"),a(V,"class","filter-input svelte-16e85dp"),a(V,"placeholder","Filter logs..."),a(de,"class","btn-small svelte-16e85dp"),de.disabled=be=l[1].length===0,a(se,"class","log-controls svelte-16e85dp"),a(J,"class","log-header svelte-16e85dp"),a(K,"class","log-section svelte-16e85dp"),a(De,"class","expand-btn svelte-16e85dp"),a(Qe,"class","svelte-16e85dp"),a(pe,"type","text"),a(pe,"class","filter-input svelte-16e85dp"),a(pe,"placeholder","Filter logs..."),a(Ke,"class","btn-small svelte-16e85dp"),Ke.disabled=at=l[2].length===0,a(ne,"class","log-controls svelte-16e85dp"),a(he,"class","log-header svelte-16e85dp"),a(Y,"class","log-section svelte-16e85dp"),a(t,"class","logs-container svelte-16e85dp")},m(ae,ge){w(ae,e,ge),w(ae,t,ge),o(t,n),o(n,s),o(n,r),o(n,i),o(i,c),o(c,f),o(c,p),o(c,m),o(c,v),o(i,_),o(i,h),o(t,S),o(t,g),o(g,y),o(y,L),o(L,T),o(y,O),o(y,A),o(y,E),o(y,z),o(z,q),te(q,l[3]),o(z,R),Ae&&Ae.m(z,null),o(z,I),o(z,M),o(M,B),o(g,j),qe&&qe.m(g,null),o(t,U),o(t,K),o(K,J),o(J,X),o(X,me),o(J,x),o(J,Z),o(J,re),o(J,se),o(se,V),te(V,l[4]),o(se,$),Ie&&Ie.m(se,null),o(se,le),o(se,de),o(de,Te),o(K,ie),Oe&&Oe.m(K,null),o(t,ee),o(t,Y),o(Y,he),o(he,De),o(De,Ve),o(he,Ze),o(he,Qe),o(he,Ce),o(he,ne),o(ne,pe),te(pe,l[5]),o(ne,Ot),Pe&&Pe.m(ne,null),o(ne,bt),o(ne,Ke),o(Ke,Pt),o(Y,Nt),Ne&&Ne.m(Y,null),ht||(Rt=[N(c,"click",l[25]),N(h,"click",l[32]),N(L,"click",l[29]),N(q,"input",l[33]),N(M,"click",l[34]),N(X,"click",l[30]),N(V,"input",l[36]),N(de,"click",l[37]),N(De,"click",l[31]),N(pe,"input",l[39]),N(Ke,"click",l[40])],ht=!0)},p(ae,ge){ge[0]&4096&&u!==(u=ae[12]?"Auto-refresh On":"Auto-refresh Off")&&D(f,u),ge[0]&4096&&H(c,"active",ae[12]),ge[0]&8192&&C!==(C=ae[13]?"â–¼":"â–¶")&&D(T,C),ge[0]&8&&q.value!==ae[3]&&te(q,ae[3]),ae[3]?Ae?Ae.p(ae,ge):(Ae=hl(ae),Ae.c(),Ae.m(z,I)):Ae&&(Ae.d(1),Ae=null),ge[0]&1&&P!==(P=ae[0].length===0)&&(M.disabled=P),ae[13]?qe?qe.p(ae,ge):(qe=gl(ae),qe.c(),qe.m(g,null)):qe&&(qe.d(1),qe=null),ge[0]&16384&&oe!==(oe=ae[14]?"â–¼":"â–¶")&&D(me,oe),ge[0]&16&&V.value!==ae[4]&&te(V,ae[4]),ae[4]?Ie?Ie.p(ae,ge):(Ie=Cl(ae),Ie.c(),Ie.m(se,le)):Ie&&(Ie.d(1),Ie=null),ge[0]&2&&be!==(be=ae[1].length===0)&&(de.disabled=be),ae[14]?Oe?Oe.p(ae,ge):(Oe=Sl(ae),Oe.c(),Oe.m(K,null)):Oe&&(Oe.d(1),Oe=null),ge[0]&32768&&Be!==(Be=ae[15]?"â–¼":"â–¶")&&D(Ve,Be),ge[0]&32&&pe.value!==ae[5]&&te(pe,ae[5]),ae[5]?Pe?Pe.p(ae,ge):(Pe=Ll(ae),Pe.c(),Pe.m(ne,bt)):Pe&&(Pe.d(1),Pe=null),ge[0]&4&&at!==(at=ae[2].length===0)&&(Ke.disabled=at),ae[15]?Ne?Ne.p(ae,ge):(Ne=zl(ae),Ne.c(),Ne.m(Y,null)):Ne&&(Ne.d(1),Ne=null)},i:G,o:G,d(ae){ae&&(k(e),k(t)),Ae&&Ae.d(),qe&&qe.d(),Ie&&Ie.d(),Oe&&Oe.d(),Pe&&Pe.d(),Ne&&Ne.d(),ht=!1,_e(Rt)}}}let Ls=5;function Ct(l,e){const t=l.join(`
`),n=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=e,r.click(),URL.revokeObjectURL(s)}function Nr(l,e,t){let n,s,r,i=[],c=[],u=[],f=!0,p=!0,m=!0,v=null,_=null,h=null,S=!1,g=null,y="",L="",C="",T=!0,O=!0,A=!1,E,z,q;async function R(ie=!0){const ee=(E==null?void 0:E.scrollTop)||0;ie&&t(6,f=!0),t(9,v=null);try{t(0,i=await _n())}catch(Y){console.error("Failed to fetch system logs:",Y),t(9,v=Y.message),t(0,i=[])}finally{ie&&t(6,f=!1),E&&ee>0&&requestAnimationFrame(()=>{t(16,E.scrollTop=ee,E)})}}async function I(ie=!0){const ee=(z==null?void 0:z.scrollTop)||0;ie&&t(7,p=!0),t(10,_=null);try{t(1,c=await bn())}catch(Y){console.error("Failed to fetch previous logs:",Y),t(10,_=Y.message),t(1,c=[])}finally{ie&&t(7,p=!1),z&&ee>0&&requestAnimationFrame(()=>{t(17,z.scrollTop=ee,z)})}}async function M(ie=!0){const ee=(q==null?void 0:q.scrollTop)||0;ie&&t(8,m=!0),t(11,h=null);try{t(2,u=await hn())}catch(Y){console.error("Failed to fetch older logs:",Y),t(11,h=Y.message),t(2,u=[])}finally{ie&&t(8,m=!1),q&&ee>0&&requestAnimationFrame(()=>{t(18,q.scrollTop=ee,q)})}}function B(){t(12,S=!S),S?P():j()}function P(){j(),g=setInterval(()=>{R(!1),I(!1),M(!1)},Ls*1e3)}function j(){g&&(clearInterval(g),g=null)}function U(){t(3,y="")}function K(){t(4,L="")}function J(){t(5,C="")}function X(){t(13,T=!T)}function oe(){t(14,O=!O)}function me(){t(15,A=!A)}We(()=>{R(),I(),M()}),it(()=>{j()});const x=()=>{R(!0),I(!0),M(!0)};function Z(){y=this.value,t(3,y)}const re=()=>Ct(i,"system-logs.txt");function se(ie){et[ie?"unshift":"push"](()=>{E=ie,t(16,E)})}function V(){L=this.value,t(4,L)}const $=()=>Ct(c,"previous-logs.txt");function le(ie){et[ie?"unshift":"push"](()=>{z=ie,t(17,z)})}function de(){C=this.value,t(5,C)}const Te=()=>Ct(u,"older-logs.txt");function be(ie){et[ie?"unshift":"push"](()=>{q=ie,t(18,q)})}return l.$$.update=()=>{l.$$.dirty[0]&9&&t(21,n=i.filter(ie=>ie.toLowerCase().includes(y.toLowerCase()))),l.$$.dirty[0]&18&&t(20,s=c.filter(ie=>ie.toLowerCase().includes(L.toLowerCase()))),l.$$.dirty[0]&36&&t(19,r=u.filter(ie=>ie.toLowerCase().includes(C.toLowerCase())))},[i,c,u,y,L,C,f,p,m,v,_,h,S,T,O,A,E,z,q,r,s,n,R,I,M,B,U,K,J,X,oe,me,x,Z,re,se,V,$,le,de,Te,be]}class Al extends Ee{constructor(e){super(),Fe(this,e,Nr,Pr,ye,{},null,[-1,-1])}}function Rr(l){let e,t,n,s,r,i,c,u,f,p,m=l[6]&&ql();return n=new Se({props:{$$slots:{default:[Ur]},$$scope:{ctx:l}}}),r=new Se({props:{$$slots:{default:[Dr]},$$scope:{ctx:l}}}),c=new Se({props:{$$slots:{default:[Gr]},$$scope:{ctx:l}}}),f=new Se({props:{$$slots:{default:[Kr]},$$scope:{ctx:l}}}),{c(){m&&m.c(),e=b(),t=d("div"),fe(n.$$.fragment),s=b(),fe(r.$$.fragment),i=b(),fe(c.$$.fragment),u=b(),fe(f.$$.fragment),a(t,"class","cards-grid svelte-qwtv9g")},m(v,_){m&&m.m(v,_),w(v,e,_),w(v,t,_),ce(n,t,null),o(t,s),ce(r,t,null),o(t,i),ce(c,t,null),o(t,u),ce(f,t,null),p=!0},p(v,_){v[6]?m||(m=ql(),m.c(),m.m(e.parentNode,e)):m&&(m.d(1),m=null);const h={};_&65537&&(h.$$scope={dirty:_,ctx:v}),n.$set(h);const S={};_&65552&&(S.$$scope={dirty:_,ctx:v}),r.$set(S);const g={};_&65596&&(g.$$scope={dirty:_,ctx:v}),c.$set(g);const y={};_&65537&&(y.$$scope={dirty:_,ctx:v}),f.$set(y)},i(v){p||(W(n.$$.fragment,v),W(r.$$.fragment,v),W(c.$$.fragment,v),W(f.$$.fragment,v),p=!0)},o(v){Q(n.$$.fragment,v),Q(r.$$.fragment,v),Q(c.$$.fragment,v),Q(f.$$.fragment,v),p=!1},d(v){v&&(k(e),k(t)),m&&m.d(v),ue(n),ue(r),ue(c),ue(f)}}}function Mr(l){let e,t,n;return t=new Ue({}),{c(){e=d("div"),fe(t.$$.fragment),a(e,"class","loading-container svelte-qwtv9g")},m(s,r){w(s,e,r),ce(t,e,null),n=!0},p:G,i(s){n||(W(t.$$.fragment,s),n=!0)},o(s){Q(t.$$.fragment,s),n=!1},d(s){s&&k(e),ue(t)}}}function ql(l){let e;return{c(){e=d("div"),e.textContent="Device is back online!",a(e,"class","online-banner svelte-qwtv9g")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Il(l){let e,t,n=l[0].buildDate+"",s;return{c(){e=d("div"),t=F("Built: "),s=F(n),a(e,"class","build-date svelte-qwtv9g")},m(r,i){w(r,e,i),o(e,t),o(e,s)},p(r,i){i&1&&n!==(n=r[0].buildDate+"")&&D(s,n)},d(r){r&&k(e)}}}function Ol(l){let e,t,n,s,r=l[0].chipModel+"",i;return{c(){e=d("tr"),t=d("td"),t.textContent="Chip Model",n=b(),s=d("td"),i=F(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),o(s,i)},p(c,u){u&1&&r!==(r=c[0].chipModel+"")&&D(i,r)},d(c){c&&k(e)}}}function Pl(l){let e,t,n,s,r=jl(l[0].cpuFreq)+"",i;return{c(){e=d("tr"),t=d("td"),t.textContent="CPU Frequency",n=b(),s=d("td"),i=F(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),o(s,i)},p(c,u){u&1&&r!==(r=jl(c[0].cpuFreq)+"")&&D(i,r)},d(c){c&&k(e)}}}function Nl(l){let e,t,n,s,r=vt(l[0].flashSize)+"",i;return{c(){e=d("tr"),t=d("td"),t.textContent="Flash Size",n=b(),s=d("td"),i=F(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),o(s,i)},p(c,u){u&1&&r!==(r=vt(c[0].flashSize)+"")&&D(i,r)},d(c){c&&k(e)}}}function Rl(l){let e,t,n,s,r=vt(l[0].psramSize)+"",i;return{c(){e=d("tr"),t=d("td"),t.textContent="PSRAM Size",n=b(),s=d("td"),i=F(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),o(s,i)},p(c,u){u&1&&r!==(r=vt(c[0].psramSize)+"")&&D(i,r)},d(c){c&&k(e)}}}function Ml(l){let e,t,n,s,r=l[0].macAddress+"",i;return{c(){e=d("tr"),t=d("td"),t.textContent="MAC Address",n=b(),s=d("td"),i=F(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),o(s,i)},p(c,u){u&1&&r!==(r=c[0].macAddress+"")&&D(i,r)},d(c){c&&k(e)}}}function Ur(l){var O,A,E,z,q,R,I;let e,t,n,s=(((O=l[0])==null?void 0:O.firmwareVersion)||"Unknown")+"",r,i,c,u,f,p,m,v,_,h,S=((A=l[0])==null?void 0:A.buildDate)&&Il(l),g=((E=l[0])==null?void 0:E.chipModel)&&Ol(l),y=((z=l[0])==null?void 0:z.cpuFreq)&&Pl(l),L=((q=l[0])==null?void 0:q.flashSize)&&Nl(l),C=((R=l[0])==null?void 0:R.psramSize)&&Rl(l),T=((I=l[0])==null?void 0:I.macAddress)&&Ml(l);return{c(){e=d("h2"),e.textContent="ESP32 Sketch",t=b(),n=d("div"),r=F(s),i=b(),S&&S.c(),c=b(),u=d("div"),f=d("table"),p=d("tbody"),g&&g.c(),m=b(),y&&y.c(),v=b(),L&&L.c(),_=b(),C&&C.c(),h=b(),T&&T.c(),a(e,"class","svelte-qwtv9g"),a(n,"class","firmware-version svelte-qwtv9g"),a(f,"class","svelte-qwtv9g"),a(u,"class","device-info svelte-qwtv9g")},m(M,B){w(M,e,B),w(M,t,B),w(M,n,B),o(n,r),w(M,i,B),S&&S.m(M,B),w(M,c,B),w(M,u,B),o(u,f),o(f,p),g&&g.m(p,null),o(p,m),y&&y.m(p,null),o(p,v),L&&L.m(p,null),o(p,_),C&&C.m(p,null),o(p,h),T&&T.m(p,null)},p(M,B){var P,j,U,K,J,X,oe;B&1&&s!==(s=(((P=M[0])==null?void 0:P.firmwareVersion)||"Unknown")+"")&&D(r,s),(j=M[0])!=null&&j.buildDate?S?S.p(M,B):(S=Il(M),S.c(),S.m(c.parentNode,c)):S&&(S.d(1),S=null),(U=M[0])!=null&&U.chipModel?g?g.p(M,B):(g=Ol(M),g.c(),g.m(p,m)):g&&(g.d(1),g=null),(K=M[0])!=null&&K.cpuFreq?y?y.p(M,B):(y=Pl(M),y.c(),y.m(p,v)):y&&(y.d(1),y=null),(J=M[0])!=null&&J.flashSize?L?L.p(M,B):(L=Nl(M),L.c(),L.m(p,_)):L&&(L.d(1),L=null),(X=M[0])!=null&&X.psramSize?C?C.p(M,B):(C=Rl(M),C.c(),C.m(p,h)):C&&(C.d(1),C=null),(oe=M[0])!=null&&oe.macAddress?T?T.p(M,B):(T=Ml(M),T.c(),T.m(p,null)):T&&(T.d(1),T=null)},d(M){M&&(k(e),k(t),k(n),k(i),k(c),k(u)),S&&S.d(M),g&&g.d(),y&&y.d(),L&&L.d(),C&&C.d(),T&&T.d()}}}function Dr(l){let e,t,n,s,r,i,c,u,f,p;return{c(){e=d("h2"),e.textContent="OTA Update",t=b(),n=d("p"),n.textContent="Upload new firmware via the web-based OTA interface.",s=b(),r=d("button"),i=F("Open OTA Update Interface"),c=b(),u=d("div"),u.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 12H7V7h2v5zm0-6H7V4h2v2z"></path></svg>
          Device will reboot after update`,a(e,"class","svelte-qwtv9g"),a(n,"class","description svelte-qwtv9g"),a(r,"class","ota-button svelte-qwtv9g"),r.disabled=l[4],a(u,"class","warning-text svelte-qwtv9g")},m(m,v){w(m,e,v),w(m,t,v),w(m,n,v),w(m,s,v),w(m,r,v),o(r,i),w(m,c,v),w(m,u,v),f||(p=N(r,"click",Zr),f=!0)},p(m,v){v&16&&(r.disabled=m[4])},d(m){m&&(k(e),k(t),k(n),k(s),k(r),k(c),k(u)),f=!1,p()}}}function jr(l){let e,t,n,s,r,i,c;return{c(){e=d("p"),e.textContent="Restart the device to apply configuration changes or recover from errors.",t=b(),n=d("button"),n.textContent="Reboot Device",s=b(),r=d("div"),r.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 12H7V7h2v5zm0-6H7V4h2v2z"></path></svg>
            Device will be unavailable for approximately 30 seconds`,a(e,"class","description svelte-qwtv9g"),a(n,"class","reboot-button svelte-qwtv9g"),a(r,"class","warning-text svelte-qwtv9g")},m(u,f){w(u,e,f),w(u,t,f),w(u,n,f),w(u,s,f),w(u,r,f),i||(c=N(n,"click",l[7]),i=!0)},p:G,i:G,o:G,d(u){u&&(k(e),k(t),k(n),k(s),k(r)),i=!1,c()}}}function Wr(l){let e,t,n,s,r,i,c,u=l[3]!==1?"s":"",f,p,m,v,_,h;return{c(){e=d("div"),t=d("p"),t.textContent="Are you sure you want to reboot the device?",n=b(),s=d("div"),r=F("Rebooting in "),i=F(l[3]),c=F(" second"),f=F(u),p=F("..."),m=b(),v=d("button"),v.textContent="Cancel",a(t,"class","confirm-text svelte-qwtv9g"),a(s,"class","countdown svelte-qwtv9g"),a(v,"class","cancel-button svelte-qwtv9g"),a(e,"class","confirm-container svelte-qwtv9g")},m(S,g){w(S,e,g),o(e,t),o(e,n),o(e,s),o(s,r),o(s,i),o(s,c),o(s,f),o(s,p),o(e,m),o(e,v),_||(h=N(v,"click",l[8]),_=!0)},p(S,g){g&8&&D(i,S[3]),g&8&&u!==(u=S[3]!==1?"s":"")&&D(f,u)},i:G,o:G,d(S){S&&k(e),_=!1,h()}}}function Hr(l){let e,t,n,s,r;t=new Ue({});function i(f,p){return f[5]?Vr:Br}let c=i(l),u=c(l);return{c(){e=d("div"),fe(t.$$.fragment),n=b(),s=d("div"),u.c(),a(s,"class","rebooting-text svelte-qwtv9g"),a(e,"class","rebooting-container svelte-qwtv9g")},m(f,p){w(f,e,p),ce(t,e,null),o(e,n),o(e,s),u.m(s,null),r=!0},p(f,p){c!==(c=i(f))&&(u.d(1),u=c(f),u&&(u.c(),u.m(s,null)))},i(f){r||(W(t.$$.fragment,f),r=!0)},o(f){Q(t.$$.fragment,f),r=!1},d(f){f&&k(e),ue(t),u.d()}}}function Br(l){let e;return{c(){e=F("Rebooting device...")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Vr(l){let e;return{c(){e=F("Waiting for device to come back online...")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Gr(l){let e,t,n,s,r,i;const c=[Hr,Wr,jr],u=[];function f(p,m){return p[4]?0:p[2]?1:2}return n=f(l),s=u[n]=c[n](l),{c(){e=d("h2"),e.textContent="Device Reboot",t=b(),s.c(),r=ze(),a(e,"class","svelte-qwtv9g")},m(p,m){w(p,e,m),w(p,t,m),u[n].m(p,m),w(p,r,m),i=!0},p(p,m){let v=n;n=f(p),n===v?u[n].p(p,m):(ke(),Q(u[v],1,1,()=>{u[v]=null}),we(),s=u[n],s?s.p(p,m):(s=u[n]=c[n](p),s.c()),W(s,1),s.m(r.parentNode,r))},i(p){i||(W(s),i=!0)},o(p){Q(s),i=!1},d(p){p&&(k(e),k(t),k(r)),u[n].d(p)}}}function Jr(l){let e;return{c(){e=d("p"),e.textContent="No version information available",a(e,"class","placeholder-text svelte-qwtv9g")},m(t,n){w(t,e,n)},p:G,d(t){t&&k(e)}}}function Qr(l){let e,t,n,s,r,i=(l[0].firmwareVersion||"Unknown")+"",c,u,f,p,m,v,_=ut(l[0].firmwareUpdateTime)+"",h,S,g,y,L,C,T,O=ut(l[0].filesystemUpdateTime)+"",A,E,z=l[0].filesystemVersion&&Ul(l),q=l[0].sdkVersion&&Dl(l);return{c(){e=d("div"),t=d("div"),n=d("div"),n.textContent="Sketch Version:",s=b(),r=d("div"),c=F(i),u=b(),f=d("div"),p=d("div"),p.textContent="Last Firmware Update:",m=b(),v=d("div"),h=F(_),S=b(),z&&z.c(),g=b(),y=d("div"),L=d("div"),L.textContent="Last Filesystem Update:",C=b(),T=d("div"),A=F(O),E=b(),q&&q.c(),a(n,"class","history-label svelte-qwtv9g"),a(r,"class","history-value svelte-qwtv9g"),a(t,"class","history-item svelte-qwtv9g"),a(p,"class","timestamp-label svelte-qwtv9g"),a(v,"class","timestamp-value svelte-qwtv9g"),a(f,"class","timestamp-item svelte-qwtv9g"),a(L,"class","timestamp-label svelte-qwtv9g"),a(T,"class","timestamp-value svelte-qwtv9g"),a(y,"class","timestamp-item svelte-qwtv9g"),a(e,"class","update-history svelte-qwtv9g")},m(R,I){w(R,e,I),o(e,t),o(t,n),o(t,s),o(t,r),o(r,c),o(e,u),o(e,f),o(f,p),o(f,m),o(f,v),o(v,h),o(e,S),z&&z.m(e,null),o(e,g),o(e,y),o(y,L),o(y,C),o(y,T),o(T,A),o(e,E),q&&q.m(e,null)},p(R,I){I&1&&i!==(i=(R[0].firmwareVersion||"Unknown")+"")&&D(c,i),I&1&&_!==(_=ut(R[0].firmwareUpdateTime)+"")&&D(h,_),R[0].filesystemVersion?z?z.p(R,I):(z=Ul(R),z.c(),z.m(e,g)):z&&(z.d(1),z=null),I&1&&O!==(O=ut(R[0].filesystemUpdateTime)+"")&&D(A,O),R[0].sdkVersion?q?q.p(R,I):(q=Dl(R),q.c(),q.m(e,null)):q&&(q.d(1),q=null)},d(R){R&&k(e),z&&z.d(),q&&q.d()}}}function Ul(l){let e,t,n,s,r=l[0].filesystemVersion+"",i;return{c(){e=d("div"),t=d("div"),t.textContent="Svelte App Version:",n=b(),s=d("div"),i=F(r),a(t,"class","history-label svelte-qwtv9g"),a(s,"class","history-value svelte-qwtv9g"),a(e,"class","history-item svelte-qwtv9g")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),o(s,i)},p(c,u){u&1&&r!==(r=c[0].filesystemVersion+"")&&D(i,r)},d(c){c&&k(e)}}}function Dl(l){let e,t,n,s,r=l[0].sdkVersion+"",i;return{c(){e=d("div"),t=d("div"),t.textContent="ESP32 SDK:",n=b(),s=d("div"),i=F(r),a(t,"class","history-label svelte-qwtv9g"),a(s,"class","history-value svelte-qwtv9g"),a(e,"class","history-item svelte-qwtv9g")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),o(s,i)},p(c,u){u&1&&r!==(r=c[0].sdkVersion+"")&&D(i,r)},d(c){c&&k(e)}}}function Kr(l){let e,t,n;function s(c,u){return c[0]?Qr:Jr}let r=s(l),i=r(l);return{c(){e=d("h2"),e.textContent="Version Information",t=b(),i.c(),n=ze(),a(e,"class","svelte-qwtv9g")},m(c,u){w(c,e,u),w(c,t,u),i.m(c,u),w(c,n,u)},p(c,u){r===(r=s(c))&&i?i.p(c,u):(i.d(1),i=r(c),i&&(i.c(),i.m(n.parentNode,n)))},d(c){c&&(k(e),k(t),k(n)),i.d(c)}}}function Yr(l){let e,t,n,s,r,i;const c=[Mr,Rr],u=[];function f(p,m){return p[1]?0:1}return s=f(l),r=u[s]=c[s](l),{c(){e=d("div"),t=d("h1"),t.textContent="Firmware & Updates",n=b(),r.c(),a(t,"class","svelte-qwtv9g"),a(e,"class","firmware-container svelte-qwtv9g")},m(p,m){w(p,e,m),o(e,t),o(e,n),u[s].m(e,null),i=!0},p(p,[m]){let v=s;s=f(p),s===v?u[s].p(p,m):(ke(),Q(u[v],1,1,()=>{u[v]=null}),we(),r=u[s],r?r.p(p,m):(r=u[s]=c[s](p),r.c()),W(r,1),r.m(e,null))},i(p){i||(W(r),i=!0)},o(p){Q(r),i=!1},d(p){p&&k(e),u[s].d()}}}function Zr(){window.open("/update","_blank")}function vt(l){return l?`${(l/(1024*1024)).toFixed(2)} MB`:"N/A"}function jl(l){return l?`${l} MHz`:"N/A"}function ut(l){return!l||l===0?"Never":new Date(l*1e3).toLocaleString()}function Xr(l,e,t){let n=null,s=!0,r=!1,i=0,c=!1,u=!1,f=!1,p=null,m=null,v=null;We(async()=>{await _(),v=setInterval(async()=>{!c&&!r&&await _()},3e4)}),it(()=>{p&&clearInterval(p),m&&clearInterval(m),v&&clearInterval(v)});async function _(){t(1,s=!0);try{t(0,n=await gn())}catch(L){console.warn("Failed to load system info:",L),t(0,n=null)}finally{t(1,s=!1)}}function h(){t(2,r=!0),t(3,i=3),p=setInterval(()=>{t(3,i--,i),i<=0&&(clearInterval(p),p=null,g())},1e3)}function S(){t(2,r=!1),p&&(clearInterval(p),p=null),t(3,i=0)}async function g(){t(2,r=!1),t(4,c=!0);try{await kn()}catch{}setTimeout(()=>{t(5,u=!0),y()},5e3)}function y(){m=setInterval(async()=>{try{(await fetch("/status",{method:"GET",cache:"no-cache"})).ok&&(clearInterval(m),m=null,t(5,u=!1),t(4,c=!1),t(6,f=!0),await _(),setTimeout(()=>{t(6,f=!1)},5e3))}catch{}},2e3)}return[n,s,r,i,c,u,f,h,S]}class Wl extends Ee{constructor(e){super(),Fe(this,e,Xr,Yr,ye,{})}}function Hl(l){let e,t;return{c(){e=d("div"),t=F(l[2]),a(e,"class","message svelte-1gg1mca"),H(e,"success",l[3]==="success"),H(e,"error",l[3]==="error")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s&4&&D(t,n[2]),s&8&&H(e,"success",n[3]==="success"),s&8&&H(e,"error",n[3]==="error")},d(n){n&&k(e)}}}function $r(l){let e,t,n,s,r,i=l[0]?"â³":l[4]?"ðŸ”„":"ðŸ””",c,u,f=l[4]?"Reset Alert":"Test Alert",p,m,v,_=l[1]?"â³":"âš™ï¸",h,S,g,y,L,C=l[2]&&Hl(l);return{c(){e=d("div"),t=d("p"),t.textContent="Press a button to simulate an event or just fire the servo.",n=b(),s=d("div"),r=d("button"),c=F(i),u=b(),p=F(f),m=b(),v=d("button"),h=F(_),S=F(" Test Servo"),g=b(),C&&C.c(),a(t,"class","description svelte-1gg1mca"),a(r,"class","btn test-alert-btn svelte-1gg1mca"),r.disabled=l[0],H(r,"alert-active",l[4]),a(v,"class","btn test-servo-btn svelte-1gg1mca"),v.disabled=l[1],a(s,"class","button-group svelte-1gg1mca"),a(e,"class","content svelte-1gg1mca")},m(T,O){w(T,e,O),o(e,t),o(e,n),o(e,s),o(s,r),o(r,c),o(r,u),o(r,p),o(s,m),o(s,v),o(v,h),o(v,S),o(e,g),C&&C.m(e,null),y||(L=[N(r,"click",l[5]),N(v,"click",l[6])],y=!0)},p(T,O){O&17&&i!==(i=T[0]?"â³":T[4]?"ðŸ”„":"ðŸ””")&&D(c,i),O&16&&f!==(f=T[4]?"Reset Alert":"Test Alert")&&D(p,f),O&1&&(r.disabled=T[0]),O&16&&H(r,"alert-active",T[4]),O&2&&_!==(_=T[1]?"â³":"âš™ï¸")&&D(h,_),O&2&&(v.disabled=T[1]),T[2]?C?C.p(T,O):(C=Hl(T),C.c(),C.m(e,null)):C&&(C.d(1),C=null)},d(T){T&&k(e),C&&C.d(),y=!1,_e(L)}}}function xr(l){let e,t,n,s,r;return s=new Se({props:{title:"",$$slots:{default:[$r]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Test Alert",n=b(),fe(s.$$.fragment),a(t,"class","svelte-1gg1mca"),a(e,"class","page svelte-1gg1mca")},m(i,c){w(i,e,c),o(e,t),o(e,n),ce(s,e,null),r=!0},p(i,[c]){const u={};c&543&&(u.$$scope={dirty:c,ctx:i}),s.$set(u)},i(i){r||(W(s.$$.fragment,i),r=!0)},o(i){Q(s.$$.fragment,i),r=!1},d(i){i&&k(e),ue(s)}}}function ei(l,e,t){let n=!1,s=!1,r="",i="",c=!1,u=null;async function f(){try{const v=await It();t(4,c=v.detectionState||!1)}catch(v){console.error("Failed to check alert status:",v)}}async function p(){t(0,n=!0),t(2,r=""),t(3,i="");try{if(c)await Ss(),t(2,r="âœ… Alert reset successfully"),t(3,i="success"),t(4,c=!1);else{const v=await Cs();t(2,r=v||"âœ… Test alert started â€“ check /gallery or /captures"),t(3,i="success"),t(4,c=!0)}}catch(v){t(2,r=`Error: ${v.message||(c?"Failed to reset alert":"Failed to trigger test alert")}`),t(3,i="error")}finally{t(0,n=!1),f()}}async function m(){t(1,s=!0),t(2,r=""),t(3,i="");try{await ws(),t(2,r="Servo triggered"),t(3,i="success")}catch(v){t(2,r=`Error: ${v.message||"Failed to trigger servo"}`),t(3,i="error")}finally{t(1,s=!1)}}return We(()=>{f(),u=setInterval(f,2e3)}),it(()=>{u&&clearInterval(u)}),[n,s,r,i,c,p,m]}class ti extends Ee{constructor(e){super(),Fe(this,e,ei,xr,ye,{})}}function Bl(l,e,t){const n=l.slice();return n[46]=e[t],n}function Vl(l,e,t){const n=l.slice();return n[49]=e[t],n}function Gl(l){let e,t;return{c(){e=d("div"),t=d("div"),a(t,"class","progress-fill svelte-1827szp"),Ge(t,"width",l[7]/(ts-1)*100+"%"),a(e,"class","progress-bar svelte-1827szp")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s[0]&128&&Ge(t,"width",n[7]/(ts-1)*100+"%")},d(n){n&&k(e)}}}function Jl(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C;const T=[si,li],O=[];function A(E,z){return E[8]?0:1}return f=A(l),p=O[f]=T[f](l),{c(){e=d("div"),t=d("div"),t.innerHTML='<span class="mouse-emoji svelte-1827szp" role="img" aria-label="mouse">ðŸ</span>',n=b(),s=d("h1"),s.textContent="MouseTrap Setup",r=b(),i=d("p"),i.textContent="Let's get your device connected and ready to protect your home.",c=b(),u=d("button"),p.c(),m=b(),v=d("div"),_=d("button"),h=F("Standalone Mode (Local Only)"),S=b(),g=d("p"),g.textContent="Connect to WiFi without cloud registration",a(t,"class","welcome-icon svelte-1827szp"),a(s,"class","svelte-1827szp"),a(i,"class","welcome-text svelte-1827szp"),a(u,"class","btn-primary btn-large svelte-1827szp"),u.disabled=l[8],a(_,"class","btn-link svelte-1827szp"),_.disabled=l[8],a(g,"class","standalone-hint svelte-1827szp"),a(v,"class","standalone-option svelte-1827szp"),a(e,"class","step welcome-step svelte-1827szp")},m(E,z){w(E,e,z),o(e,t),o(e,n),o(e,s),o(e,r),o(e,i),o(e,c),o(e,u),O[f].m(u,null),o(e,m),o(e,v),o(v,_),o(_,h),o(v,S),o(v,g),y=!0,L||(C=[N(u,"click",l[28]),N(_,"click",l[26])],L=!0)},p(E,z){let q=f;f=A(E),f!==q&&(ke(),Q(O[q],1,1,()=>{O[q]=null}),we(),p=O[f],p||(p=O[f]=T[f](E),p.c()),W(p,1),p.m(u,null)),(!y||z[0]&256)&&(u.disabled=E[8]),(!y||z[0]&256)&&(_.disabled=E[8])},i(E){y||(W(p),y=!0)},o(E){Q(p),y=!1},d(E){E&&k(e),O[f].d(),L=!1,_e(C)}}}function li(l){let e,t;return{c(){e=F("Get Started "),t=d("span"),t.textContent="â†’",a(t,"class","arrow svelte-1827szp")},m(n,s){w(n,e,s),w(n,t,s)},i:G,o:G,d(n){n&&(k(e),k(t))}}}function si(l){let e,t,n;return e=new Ue({props:{size:"small"}}),{c(){fe(e.$$.fragment),t=F(" Loading...")},m(s,r){ce(e,s,r),w(s,t,r),n=!0},i(s){n||(W(e.$$.fragment,s),n=!0)},o(s){Q(e.$$.fragment,s),n=!1},d(s){s&&k(t),ue(e,s)}}}function Ql(l){let e,t,n,s,r,i,c,u,f,p,m,v,_,h;const S=[ii,ri,ni],g=[];function y(O,A){return O[11]?0:O[10]||O[9].length===0?1:2}s=y(l),r=g[s]=S[s](l);const L=[ui,ci],C=[];function T(O,A){return O[16]?0:1}return p=T(l),m=C[p]=L[p](l),{c(){e=d("div"),t=d("h2"),t.textContent="Select your WiFi network",n=b(),r.c(),i=b(),c=d("div"),u=d("button"),u.innerHTML='<span class="arrow svelte-1827szp">â†</span> Back',f=b(),m.c(),a(t,"class","svelte-1827szp"),a(u,"class","btn-secondary svelte-1827szp"),a(c,"class","button-row svelte-1827szp"),a(e,"class","step wifi-step svelte-1827szp")},m(O,A){w(O,e,A),o(e,t),o(e,n),g[s].m(e,null),o(e,i),o(e,c),o(c,u),o(c,f),C[p].m(c,null),v=!0,_||(h=N(u,"click",l[36]),_=!0)},p(O,A){let E=s;s=y(O),s===E?g[s].p(O,A):(ke(),Q(g[E],1,1,()=>{g[E]=null}),we(),r=g[s],r?r.p(O,A):(r=g[s]=S[s](O),r.c()),W(r,1),r.m(e,i));let z=p;p=T(O),p===z?C[p].p(O,A):(ke(),Q(C[z],1,1,()=>{C[z]=null}),we(),m=C[p],m?m.p(O,A):(m=C[p]=L[p](O),m.c()),W(m,1),m.m(c,null))},i(O){v||(W(r),W(m),v=!0)},o(O){Q(r),Q(m),v=!1},d(O){O&&k(e),g[s].d(),C[p].d(),_=!1,h()}}}function ni(l){let e,t,n,s,r=l[0]==="manual"?"â—‰":"â—‹",i,c,u,f,p,m,v,_,h,S,g,y=l[12]?"Hide":"Show",L,C,T,O=l[2].length+"",A,E,z,q,R=Le(l[9]),I=[];for(let U=0;U<R.length;U+=1)I[U]=Kl(Vl(l,R,U));let M=l[0]==="manual"&&Yl(l);function B(U,K){return U[12]?ai:oi}let P=B(l),j=P(l);return{c(){e=d("div");for(let U=0;U<I.length;U+=1)I[U].c();t=b(),n=d("button"),s=d("span"),i=F(r),c=b(),u=d("span"),u.textContent="Enter manually...",f=b(),M&&M.c(),p=b(),m=d("div"),v=d("label"),v.textContent="Password",_=b(),h=d("div"),j.c(),S=b(),g=d("button"),L=F(y),C=b(),T=d("p"),A=F(O),E=F("/8 characters minimum"),a(s,"class","network-radio svelte-1827szp"),a(u,"class","network-name svelte-1827szp"),a(n,"class","network-item manual-entry svelte-1827szp"),H(n,"selected",l[0]==="manual"),a(e,"class","network-list svelte-1827szp"),a(v,"for","wifi-password"),a(v,"class","svelte-1827szp"),a(g,"type","button"),a(g,"class","toggle-password svelte-1827szp"),a(h,"class","password-input-group svelte-1827szp"),a(T,"class","field-hint svelte-1827szp"),H(T,"valid",l[2].length>=8),a(m,"class","form-group svelte-1827szp")},m(U,K){w(U,e,K);for(let J=0;J<I.length;J+=1)I[J]&&I[J].m(e,null);o(e,t),o(e,n),o(n,s),o(s,i),o(n,c),o(n,u),w(U,f,K),M&&M.m(U,K),w(U,p,K),w(U,m,K),o(m,v),o(m,_),o(m,h),j.m(h,null),o(h,S),o(h,g),o(g,L),o(m,C),o(m,T),o(T,A),o(T,E),z||(q=[N(n,"click",l[31]),N(g,"click",l[35])],z=!0)},p(U,K){if(K[0]&4194817){R=Le(U[9]);let J;for(J=0;J<R.length;J+=1){const X=Vl(U,R,J);I[J]?I[J].p(X,K):(I[J]=Kl(X),I[J].c(),I[J].m(e,t))}for(;J<I.length;J+=1)I[J].d(1);I.length=R.length}K[0]&1&&r!==(r=U[0]==="manual"?"â—‰":"â—‹")&&D(i,r),K[0]&1&&H(n,"selected",U[0]==="manual"),U[0]==="manual"?M?M.p(U,K):(M=Yl(U),M.c(),M.m(p.parentNode,p)):M&&(M.d(1),M=null),P===(P=B(U))&&j?j.p(U,K):(j.d(1),j=P(U),j&&(j.c(),j.m(h,S))),K[0]&4096&&y!==(y=U[12]?"Hide":"Show")&&D(L,y),K[0]&4&&O!==(O=U[2].length+"")&&D(A,O),K[0]&4&&H(T,"valid",U[2].length>=8)},i:G,o:G,d(U){U&&(k(e),k(f),k(p),k(m)),Je(I,U),M&&M.d(U),j.d(),z=!1,_e(q)}}}function ri(l){let e,t,n=(l[10]||"No networks found")+"",s,r,i,c,u,f,p;return{c(){e=d("div"),t=d("p"),s=F(n),r=b(),i=d("button"),i.textContent="Retry Scan",c=b(),u=d("p"),u.textContent="Tap Retry to scan again. This may take 10-15 seconds.",a(t,"class","svelte-1827szp"),a(i,"class","btn-primary svelte-1827szp"),a(u,"class","hint svelte-1827szp"),a(e,"class","error-box svelte-1827szp")},m(m,v){w(m,e,v),o(e,t),o(t,s),o(e,r),o(e,i),o(e,c),o(e,u),f||(p=N(i,"click",l[29]),f=!0)},p(m,v){v[0]&1024&&n!==(n=(m[10]||"No networks found")+"")&&D(s,n)},i:G,o:G,d(m){m&&k(e),f=!1,p()}}}function ii(l){let e,t,n,s,r;return t=new Ue({}),{c(){e=d("div"),fe(t.$$.fragment),n=b(),s=d("p"),s.textContent="Scanning for networks...",a(e,"class","loading-container svelte-1827szp")},m(i,c){w(i,e,c),ce(t,e,null),o(e,n),o(e,s),r=!0},p:G,i(i){r||(W(t.$$.fragment,i),r=!0)},o(i){Q(t.$$.fragment,i),r=!1},d(i){i&&k(e),ue(t)}}}function Kl(l){let e,t,n=l[0]===l[49].ssid?"â—‰":"â—‹",s,r,i,c=l[49].ssid+"",u,f,p,m,v,_,h=ss(ls(l[49].rssi))+"",S,g,y;function L(){return l[30](l[49])}return{c(){e=d("button"),t=d("span"),s=F(n),r=b(),i=d("span"),u=F(c),f=b(),p=d("span"),m=d("span"),m.textContent="ðŸ“¶",v=b(),_=d("span"),S=F(h),a(t,"class","network-radio svelte-1827szp"),a(i,"class","network-name svelte-1827szp"),a(m,"class","signal-label svelte-1827szp"),a(_,"class","signal-bars svelte-1827szp"),a(p,"class","signal-icon svelte-1827szp"),a(p,"title","Signal strength"),a(e,"class","network-item svelte-1827szp"),H(e,"selected",l[0]===l[49].ssid)},m(C,T){w(C,e,T),o(e,t),o(t,s),o(e,r),o(e,i),o(i,u),o(e,f),o(e,p),o(p,m),o(p,v),o(p,_),o(_,S),g||(y=N(e,"click",L),g=!0)},p(C,T){l=C,T[0]&513&&n!==(n=l[0]===l[49].ssid?"â—‰":"â—‹")&&D(s,n),T[0]&512&&c!==(c=l[49].ssid+"")&&D(u,c),T[0]&512&&h!==(h=ss(ls(l[49].rssi))+"")&&D(S,h),T[0]&513&&H(e,"selected",l[0]===l[49].ssid)},d(C){C&&k(e),g=!1,y()}}}function Yl(l){let e,t,n,s,r,i;return{c(){e=d("div"),t=d("label"),t.textContent="Network Name (SSID)",n=b(),s=d("input"),a(t,"for","manual-ssid"),a(t,"class","svelte-1827szp"),a(s,"id","manual-ssid"),a(s,"type","text"),a(s,"placeholder","Enter network name"),a(s,"autocomplete","off"),a(s,"class","svelte-1827szp"),a(e,"class","form-group svelte-1827szp")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s),te(s,l[1]),r||(i=N(s,"input",l[32]),r=!0)},p(c,u){u[0]&2&&s.value!==c[1]&&te(s,c[1])},d(c){c&&k(e),r=!1,i()}}}function oi(l){let e,t,n;return{c(){e=d("input"),a(e,"id","wifi-password"),a(e,"type","password"),a(e,"placeholder","Enter WiFi password"),a(e,"autocomplete","off"),a(e,"class","svelte-1827szp")},m(s,r){w(s,e,r),te(e,l[2]),t||(n=N(e,"input",l[34]),t=!0)},p(s,r){r[0]&4&&e.value!==s[2]&&te(e,s[2])},d(s){s&&k(e),t=!1,n()}}}function ai(l){let e,t,n;return{c(){e=d("input"),a(e,"id","wifi-password"),a(e,"type","text"),a(e,"placeholder","Enter WiFi password"),a(e,"autocomplete","off"),a(e,"class","svelte-1827szp")},m(s,r){w(s,e,r),te(e,l[2]),t||(n=N(e,"input",l[33]),t=!0)},p(s,r){r[0]&4&&e.value!==s[2]&&te(e,s[2])},d(s){s&&k(e),t=!1,n()}}}function ci(l){let e,t,n,s,r,i;return{c(){e=d("button"),t=F("Next "),n=d("span"),n.textContent="â†’",a(n,"class","arrow svelte-1827szp"),a(e,"class","btn-primary svelte-1827szp"),e.disabled=s=!l[20]},m(c,u){w(c,e,u),o(e,t),o(e,n),r||(i=N(e,"click",l[37]),r=!0)},p(c,u){u[0]&1048576&&s!==(s=!c[20])&&(e.disabled=s)},i:G,o:G,d(c){c&&k(e),r=!1,i()}}}function ui(l){let e,t,n,s,r,i,c;const u=[di,fi],f=[];function p(m,v){return m[17]?0:1}return t=p(l),n=f[t]=u[t](l),{c(){e=d("button"),n.c(),a(e,"class","btn-primary svelte-1827szp"),e.disabled=s=!l[20]||l[17]},m(m,v){w(m,e,v),f[t].m(e,null),r=!0,i||(c=N(e,"click",l[27]),i=!0)},p(m,v){let _=t;t=p(m),t!==_&&(ke(),Q(f[_],1,1,()=>{f[_]=null}),we(),n=f[t],n||(n=f[t]=u[t](m),n.c()),W(n,1),n.m(e,null)),(!r||v[0]&1179648&&s!==(s=!m[20]||m[17]))&&(e.disabled=s)},i(m){r||(W(n),r=!0)},o(m){Q(n),r=!1},d(m){m&&k(e),f[t].d(),i=!1,c()}}}function fi(l){let e;return{c(){e=F("Enable Standalone Mode")},m(t,n){w(t,e,n)},i:G,o:G,d(t){t&&k(e)}}}function di(l){let e,t,n;return e=new Ue({props:{size:"small"}}),{c(){fe(e.$$.fragment),t=F(" Enabling...")},m(s,r){ce(e,s,r),w(s,t,r),n=!0},i(s){n||(W(e.$$.fragment,s),n=!0)},o(s){Q(e.$$.fragment,s),n=!1},d(s){s&&k(t),ue(e,s)}}}function Zl(l){let e,t,n,s,r,i,c,u=l[3]?"Create your account":"Sign in",f,p,m,v,_,h,S,g,y,L,C,T,O,A=l[13]?"Hide":"Show",E,z,q,R=l[5].length+"",I,M,B,P,j,U,K,J,X,oe,me,x,Z=l[3]?"Create & Activate":"Sign In & Activate",re,se,V,$,le,de;function Te(ee,Y){return ee[13]?mi:pi}let be=Te(l),ie=be(l);return{c(){e=d("div"),t=d("div"),n=d("button"),n.textContent="Sign In",s=b(),r=d("button"),r.textContent="Create Account",i=b(),c=d("h2"),f=F(u),p=b(),m=d("div"),v=d("label"),v.textContent="Email",_=b(),h=d("input"),S=b(),g=d("div"),y=d("label"),y.textContent="Password",L=b(),C=d("div"),ie.c(),T=b(),O=d("button"),E=F(A),z=b(),q=d("p"),I=F(R),M=F("/8 characters minimum"),B=b(),P=d("div"),j=d("label"),j.textContent="Name this device",U=b(),K=d("input"),J=b(),X=d("div"),oe=d("button"),oe.innerHTML='<span class="arrow svelte-1827szp">â†</span> Back',me=b(),x=d("button"),re=F(Z),se=b(),V=d("span"),V.textContent="â†’",a(n,"class","tab-btn svelte-1827szp"),H(n,"active",!l[3]),a(r,"class","tab-btn svelte-1827szp"),H(r,"active",l[3]),a(t,"class","account-tabs svelte-1827szp"),a(c,"class","svelte-1827szp"),a(v,"for","email"),a(v,"class","svelte-1827szp"),a(h,"id","email"),a(h,"type","email"),a(h,"placeholder","you@example.com"),a(h,"autocomplete","email"),a(h,"class","svelte-1827szp"),a(m,"class","form-group svelte-1827szp"),a(y,"for","account-password"),a(y,"class","svelte-1827szp"),a(O,"type","button"),a(O,"class","toggle-password svelte-1827szp"),a(C,"class","password-input-group svelte-1827szp"),a(q,"class","field-hint svelte-1827szp"),H(q,"valid",l[5].length>=8),a(g,"class","form-group svelte-1827szp"),a(j,"for","device-name"),a(j,"class","svelte-1827szp"),a(K,"id","device-name"),a(K,"type","text"),a(K,"placeholder","Kitchen"),a(K,"autocomplete","off"),a(K,"class","svelte-1827szp"),a(P,"class","form-group svelte-1827szp"),a(oe,"class","btn-secondary svelte-1827szp"),a(V,"class","arrow svelte-1827szp"),a(x,"class","btn-primary svelte-1827szp"),x.disabled=$=!l[19],a(X,"class","button-row svelte-1827szp"),a(e,"class","step account-step svelte-1827szp")},m(ee,Y){w(ee,e,Y),o(e,t),o(t,n),o(t,s),o(t,r),o(e,i),o(e,c),o(c,f),o(e,p),o(e,m),o(m,v),o(m,_),o(m,h),te(h,l[4]),o(e,S),o(e,g),o(g,y),o(g,L),o(g,C),ie.m(C,null),o(C,T),o(C,O),o(O,E),o(g,z),o(g,q),o(q,I),o(q,M),o(e,B),o(e,P),o(P,j),o(P,U),o(P,K),te(K,l[6]),o(e,J),o(e,X),o(X,oe),o(X,me),o(X,x),o(x,re),o(x,se),o(x,V),le||(de=[N(n,"click",l[38]),N(r,"click",l[39]),N(h,"input",l[40]),N(O,"click",l[43]),N(K,"input",l[44]),N(oe,"click",l[45]),N(x,"click",l[24])],le=!0)},p(ee,Y){Y[0]&8&&H(n,"active",!ee[3]),Y[0]&8&&H(r,"active",ee[3]),Y[0]&8&&u!==(u=ee[3]?"Create your account":"Sign in")&&D(f,u),Y[0]&16&&h.value!==ee[4]&&te(h,ee[4]),be===(be=Te(ee))&&ie?ie.p(ee,Y):(ie.d(1),ie=be(ee),ie&&(ie.c(),ie.m(C,T))),Y[0]&8192&&A!==(A=ee[13]?"Hide":"Show")&&D(E,A),Y[0]&32&&R!==(R=ee[5].length+"")&&D(I,R),Y[0]&32&&H(q,"valid",ee[5].length>=8),Y[0]&64&&K.value!==ee[6]&&te(K,ee[6]),Y[0]&8&&Z!==(Z=ee[3]?"Create & Activate":"Sign In & Activate")&&D(re,Z),Y[0]&524288&&$!==($=!ee[19])&&(x.disabled=$)},d(ee){ee&&k(e),ie.d(),le=!1,_e(de)}}}function pi(l){let e,t,n,s,r;return{c(){e=d("input"),a(e,"id","account-password"),a(e,"type","password"),a(e,"placeholder",t=l[3]?"Create a password":"Enter your password"),a(e,"autocomplete",n=l[3]?"new-password":"current-password"),a(e,"class","svelte-1827szp")},m(i,c){w(i,e,c),te(e,l[5]),s||(r=N(e,"input",l[42]),s=!0)},p(i,c){c[0]&8&&t!==(t=i[3]?"Create a password":"Enter your password")&&a(e,"placeholder",t),c[0]&8&&n!==(n=i[3]?"new-password":"current-password")&&a(e,"autocomplete",n),c[0]&32&&e.value!==i[5]&&te(e,i[5])},d(i){i&&k(e),s=!1,r()}}}function mi(l){let e,t,n,s,r;return{c(){e=d("input"),a(e,"id","account-password"),a(e,"type","text"),a(e,"placeholder",t=l[3]?"Create a password":"Enter your password"),a(e,"autocomplete",n=l[3]?"new-password":"current-password"),a(e,"class","svelte-1827szp")},m(i,c){w(i,e,c),te(e,l[5]),s||(r=N(e,"input",l[41]),s=!0)},p(i,c){c[0]&8&&t!==(t=i[3]?"Create a password":"Enter your password")&&a(e,"placeholder",t),c[0]&8&&n!==(n=i[3]?"new-password":"current-password")&&a(e,"autocomplete",n),c[0]&32&&e.value!==i[5]&&te(e,i[5])},d(i){i&&k(e),s=!1,r()}}}function Xl(l){let e,t,n,s,r=Le(l[18]),i=[];for(let c=0;c<r.length;c+=1)i[c]=xl(Bl(l,r,c));return{c(){e=d("div"),t=d("h2"),t.textContent="Setting up your device...",n=b(),s=d("div");for(let c=0;c<i.length;c+=1)i[c].c();a(t,"class","svelte-1827szp"),a(s,"class","progress-list svelte-1827szp"),a(e,"class","step progress-step svelte-1827szp")},m(c,u){w(c,e,u),o(e,t),o(e,n),o(e,s);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(s,null)},p(c,u){if(u[0]&262144){r=Le(c[18]);let f;for(f=0;f<r.length;f+=1){const p=Bl(c,r,f);i[f]?i[f].p(p,u):(i[f]=xl(p),i[f].c(),i[f].m(s,null))}for(;f<i.length;f+=1)i[f].d(1);i.length=r.length}},d(c){c&&k(e),Je(i,c)}}}function $l(l){let e;return{c(){e=d("span"),a(e,"class","progress-spinner svelte-1827szp")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function xl(l){let e,t,n=ns(l[46].status)+"",s,r,i,c=l[46].label+"",u,f,p,m=l[46].status==="in_progress"&&$l();return{c(){e=d("div"),t=d("span"),s=F(n),r=b(),i=d("span"),u=F(c),f=b(),m&&m.c(),p=b(),a(t,"class","progress-icon svelte-1827szp"),a(i,"class","progress-label svelte-1827szp"),a(e,"class","progress-item svelte-1827szp"),H(e,"completed",l[46].status==="completed"),H(e,"in-progress",l[46].status==="in_progress"),H(e,"failed",l[46].status==="failed")},m(v,_){w(v,e,_),o(e,t),o(t,s),o(e,r),o(e,i),o(i,u),o(e,f),m&&m.m(e,null),o(e,p)},p(v,_){_[0]&262144&&n!==(n=ns(v[46].status)+"")&&D(s,n),_[0]&262144&&c!==(c=v[46].label+"")&&D(u,c),v[46].status==="in_progress"?m||(m=$l(),m.c(),m.m(e,p)):m&&(m.d(1),m=null),_[0]&262144&&H(e,"completed",v[46].status==="completed"),_[0]&262144&&H(e,"in-progress",v[46].status==="in_progress"),_[0]&262144&&H(e,"failed",v[46].status==="failed")},d(v){v&&k(e),m&&m.d()}}}function es(l){let e;function t(r,i){return r[14]?_i:vi}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,i){s.m(r,i),w(r,e,i)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){r&&k(e),s.d(r)}}}function vi(l){let e,t,n,s,r,i,c,u,f,p,m;return{c(){e=d("div"),t=d("div"),t.innerHTML='<span role="img" aria-label="error">âŒ</span>',n=b(),s=d("h2"),s.textContent="Setup Failed",r=b(),i=d("p"),c=F(l[15]),u=b(),f=d("button"),f.textContent="Try Again",a(t,"class","result-icon error svelte-1827szp"),a(s,"class","svelte-1827szp"),a(i,"class","error-message svelte-1827szp"),a(f,"class","btn-primary btn-large svelte-1827szp"),a(e,"class","step error-step svelte-1827szp")},m(v,_){w(v,e,_),o(e,t),o(e,n),o(e,s),o(e,r),o(e,i),o(i,c),o(e,u),o(e,f),p||(m=N(f,"click",l[25]),p=!0)},p(v,_){_[0]&32768&&D(c,v[15])},d(v){v&&k(e),p=!1,m()}}}function _i(l){let e;function t(r,i){return r[16]?hi:bi}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),a(e,"class","step success-step svelte-1827szp")},m(r,i){w(r,e,i),s.m(e,null)},p(r,i){n===(n=t(r))&&s?s.p(r,i):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null)))},d(r){r&&k(e),s.d()}}}function bi(l){let e,t,n,s,r,i,c,u,f,p,m,v;return{c(){e=d("div"),e.innerHTML='<span role="img" aria-label="in progress">â³</span>',t=b(),n=d("h2"),n.textContent="Setup In Progress",s=b(),r=d("p"),i=F('Your device "'),c=F(l[6]),u=F('" is connecting to your WiFi and registering with the server.'),f=b(),p=d("div"),p.innerHTML='<p class="svelte-1827szp">Check your dashboard to confirm the device appears:</p> <a href="https://dashboard.mousetrap.com" class="dashboard-link svelte-1827szp" target="_blank" rel="noopener noreferrer">https://dashboard.mousetrap.com</a>',m=b(),v=d("p"),v.innerHTML=`The device will disconnect from this network to complete setup.<br/>
              If registration fails, the device will restart in setup mode.`,a(e,"class","result-icon in-progress svelte-1827szp"),a(n,"class","svelte-1827szp"),a(r,"class","result-text svelte-1827szp"),a(p,"class","dashboard-link-box svelte-1827szp"),a(v,"class","auto-close-text svelte-1827szp")},m(_,h){w(_,e,h),w(_,t,h),w(_,n,h),w(_,s,h),w(_,r,h),o(r,i),o(r,c),o(r,u),w(_,f,h),w(_,p,h),w(_,m,h),w(_,v,h)},p(_,h){h[0]&64&&D(c,_[6])},d(_){_&&(k(e),k(t),k(n),k(s),k(r),k(f),k(p),k(m),k(v))}}}function hi(l){let e,t,n,s,r,i,c,u,f;return{c(){e=d("div"),e.innerHTML='<span role="img" aria-label="success">âœ…</span>',t=b(),n=d("h2"),n.textContent="Standalone Mode Enabled",s=b(),r=d("p"),r.textContent="Device will reboot and connect to WiFi without cloud registration.",i=b(),c=d("div"),c.innerHTML='<p class="svelte-1827szp">After reboot, access the device at:</p> <p class="dashboard-link svelte-1827szp">http://192.168.4.1</p> <p class="hint-text svelte-1827szp">(Connect to the MouseTrap WiFi network first)</p>',u=b(),f=d("p"),f.innerHTML=`Device is rebooting...<br/>
              You can view system logs at /app/#/logs`,a(e,"class","result-icon success svelte-1827szp"),a(n,"class","svelte-1827szp"),a(r,"class","result-text svelte-1827szp"),a(c,"class","dashboard-link-box svelte-1827szp"),a(f,"class","auto-close-text svelte-1827szp")},m(p,m){w(p,e,m),w(p,t,m),w(p,n,m),w(p,s,m),w(p,r,m),w(p,i,m),w(p,c,m),w(p,u,m),w(p,f,m)},p:G,d(p){p&&(k(e),k(t),k(n),k(s),k(r),k(i),k(c),k(u),k(f))}}}function gi(l){let e,t,n,s,r,i,c,u,f=l[7]<5&&Gl(l),p=l[7]===1&&Jl(l),m=l[7]===2&&Ql(l),v=l[7]===3&&Zl(l),_=l[7]===4&&Xl(l),h=l[7]===5&&es(l);return{c(){e=d("div"),t=d("div"),f&&f.c(),n=b(),p&&p.c(),s=b(),m&&m.c(),r=b(),v&&v.c(),i=b(),_&&_.c(),c=b(),h&&h.c(),a(t,"class","setup-card svelte-1827szp"),a(e,"class","setup-container svelte-1827szp")},m(S,g){w(S,e,g),o(e,t),f&&f.m(t,null),o(t,n),p&&p.m(t,null),o(t,s),m&&m.m(t,null),o(t,r),v&&v.m(t,null),o(t,i),_&&_.m(t,null),o(t,c),h&&h.m(t,null),u=!0},p(S,g){S[7]<5?f?f.p(S,g):(f=Gl(S),f.c(),f.m(t,n)):f&&(f.d(1),f=null),S[7]===1?p?(p.p(S,g),g[0]&128&&W(p,1)):(p=Jl(S),p.c(),W(p,1),p.m(t,s)):p&&(ke(),Q(p,1,1,()=>{p=null}),we()),S[7]===2?m?(m.p(S,g),g[0]&128&&W(m,1)):(m=Ql(S),m.c(),W(m,1),m.m(t,r)):m&&(ke(),Q(m,1,1,()=>{m=null}),we()),S[7]===3?v?v.p(S,g):(v=Zl(S),v.c(),v.m(t,i)):v&&(v.d(1),v=null),S[7]===4?_?_.p(S,g):(_=Xl(S),_.c(),_.m(t,c)):_&&(_.d(1),_=null),S[7]===5?h?h.p(S,g):(h=es(S),h.c(),h.m(t,null)):h&&(h.d(1),h=null)},i(S){u||(W(p),W(m),u=!0)},o(S){Q(p),Q(m),u=!1},d(S){S&&k(e),f&&f.d(),p&&p.d(),m&&m.d(),v&&v.d(),_&&_.d(),h&&h.d()}}}const ts=5;function ls(l){return l>=-50?4:l>=-60?3:l>=-70?2:1}function ss(l){const e="â–ˆ",t="â–‘";let n="";for(let s=0;s<4;s++)n+=s<l?e:t;return n}function ns(l){switch(l){case"completed":return"âœ“";case"in_progress":return"â³";case"failed":return"âœ—";default:return"â—‹"}}function ki(l,e,t){let n,s,r,i=1,c=!1,u=[],f=null,p=!1,m=null,v="",_="",h=!1,S=!1,g="",y="",L=!1,C="",T=!1,O=null,A=!1,E=!1;We(()=>{});async function z(ee=!1){console.log("[SETUP] loadNetworks called, forceRescan="+ee),t(11,p=!0),t(10,f=null),t(9,u=[]);try{console.log("[SETUP] About to call scanWiFiNetworks...");const Y=await ys(ee);console.log("[SETUP] scanWiFiNetworks returned:",JSON.stringify(Y)),t(9,u=Y.networks||[]),console.log("[SETUP] Networks set to:",u.length,"items"),u.length===0&&t(10,f="No networks found. Tap Retry to scan again.")}catch(Y){console.error("[SETUP] Scan error:",Y),console.error("[SETUP] Error details:",Y.message,Y.stack),t(10,f="Scan failed: "+(Y.message||"Unknown error")),t(9,u=[])}finally{console.log("[SETUP] loadNetworks finished, setting networkLoading=false"),t(11,p=!1)}}function q(ee){t(0,m=ee),ee!=="manual"&&t(1,v="")}async function R(ee){t(8,c=!0);try{ee===2&&await z(),t(7,i=ee)}finally{t(8,c=!1)}}async function I(){t(7,i=4),t(14,T=!1),t(15,O=null);const ee=m==="manual"?v:m;t(18,n=n.map(Y=>Y.id==="wifi"?{...Y,status:"in_progress"}:Y));try{await Sn({ssid:ee,password:_,email:g,accountPassword:y,deviceName:C,isNewAccount:S}),t(18,n=n.map(Y=>Y.id==="wifi"?{...Y,status:"completed"}:Y)),t(18,n=n.map(Y=>Y.id==="account"?{...Y,status:"in_progress"}:Y)),await new Promise(Y=>setTimeout(Y,1500)),t(18,n=n.map(Y=>Y.id==="account"?{...Y,status:"completed"}:Y)),t(18,n=n.map(Y=>Y.id==="activate"?{...Y,status:"in_progress"}:Y)),await new Promise(Y=>setTimeout(Y,2e3)),t(18,n=n.map(Y=>Y.id==="activate"?{...Y,status:"completed"}:Y)),t(14,T=!0),t(7,i=5)}catch(Y){t(15,O=Y.message||"Setup failed. Please try again."),t(18,n=n.map(he=>he.status==="in_progress"?{...he,status:"failed"}:he)),t(7,i=5)}}function M(){t(7,i=1),t(0,m=null),t(1,v=""),t(2,_=""),t(4,g=""),t(5,y=""),t(6,C=""),t(14,T=!1),t(15,O=null),t(18,n=[{id:"wifi",label:"Connecting to WiFi",status:"pending"},{id:"account",label:"Creating your account",status:"pending"},{id:"activate",label:"Activating device",status:"pending"}])}async function B(){t(16,A=!0),await R(2)}async function P(){t(17,E=!0),t(15,O=null);const ee=m==="manual"?v:m;try{await yn({ssid:ee,password:_}),t(14,T=!0),t(7,i=5)}catch(Y){t(15,O=Y.message||"Failed to enable standalone mode"),t(7,i=5),t(14,T=!1)}finally{t(17,E=!1)}}const j=()=>{t(16,A=!1),R(2)},U=()=>{console.log("[SETUP] Retry clicked!"),z(!0)},K=ee=>q(ee.ssid),J=()=>q("manual");function X(){v=this.value,t(1,v)}function oe(){_=this.value,t(2,_)}function me(){_=this.value,t(2,_)}const x=()=>t(12,h=!h),Z=()=>{t(7,i=1),t(16,A=!1)},re=()=>t(7,i=3),se=()=>t(3,S=!1),V=()=>t(3,S=!0);function $(){g=this.value,t(4,g)}function le(){y=this.value,t(5,y)}function de(){y=this.value,t(5,y)}const Te=()=>t(13,L=!L);function be(){C=this.value,t(6,C)}const ie=()=>t(7,i=2);return l.$$.update=()=>{l.$$.dirty[0]&8&&t(18,n=[{id:"wifi",label:"Connecting to WiFi",status:"pending"},{id:"account",label:S?"Creating account":"Signing in",status:"pending"},{id:"activate",label:"Activating device",status:"pending"}]),l.$$.dirty[0]&7&&t(20,s=(m||v.trim())&&(m!=="manual"||v.trim())&&_.length>=8),l.$$.dirty[0]&112&&t(19,r=g.trim()&&y.length>=8&&C.trim())},[m,v,_,S,g,y,C,i,c,u,f,p,h,L,T,O,A,E,n,r,s,z,q,R,I,M,B,P,j,U,K,J,X,oe,me,x,Z,re,se,V,$,le,de,Te,be,ie]}class wi extends Ee{constructor(e){super(),Fe(this,e,ki,gi,ye,{},null,[-1,-1])}}function rs(l,e,t){const n=l.slice();return n[19]=e[t],n}function Ci(l){let e,t,n,s;return e=new Se({props:{title:"Update WiFi Network",$$slots:{default:[Ai]},$$scope:{ctx:l}}}),{c(){fe(e.$$.fragment),t=b(),n=d("div"),n.innerHTML='<a href="/" class="svelte-1p30553">â† Back to Dashboard</a>',a(n,"class","back-link svelte-1p30553")},m(r,i){ce(e,r,i),w(r,t,i),w(r,n,i),s=!0},p(r,i){const c={};i&4195310&&(c.$$scope={dirty:i,ctx:r}),e.$set(c)},i(r){s||(W(e.$$.fragment,r),s=!0)},o(r){Q(e.$$.fragment,r),s=!1},d(r){r&&(k(t),k(n)),ue(e,r)}}}function Si(l){let e,t;return e=new Se({props:{$$slots:{default:[qi]},$$scope:{ctx:l}}}),{c(){fe(e.$$.fragment)},m(n,s){ce(e,n,s),t=!0},p(n,s){const r={};s&4194320&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(W(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function yi(l){let e,t,n,s,r;return t=new Ue({}),{c(){e=d("div"),fe(t.$$.fragment),n=b(),s=d("p"),s.textContent="Scanning for networks...",a(e,"class","loading-container svelte-1p30553")},m(i,c){w(i,e,c),ce(t,e,null),o(e,n),o(e,s),r=!0},p:G,i(i){r||(W(t.$$.fragment,i),r=!0)},o(i){Q(t.$$.fragment,i),r=!1},d(i){i&&k(e),ue(t)}}}function is(l){let e,t;return{c(){e=d("div"),t=F(l[3]),a(e,"class","error-text svelte-1p30553")},m(n,s){w(n,e,s),o(e,t)},p(n,s){s&8&&D(t,n[3])},d(n){n&&k(e)}}}function os(l){let e,t,n,s,r,i=l[1]?"Scanning...":"Rescan",c,u,f,p,m,v,_;const h=[zi,Li,Ti],S=[];function g(y,L){return y[1]?0:y[8].length===0?1:2}return f=g(l),p=S[f]=h[f](l),{c(){e=d("div"),t=d("div"),n=d("span"),n.textContent="Available Networks",s=b(),r=d("button"),c=F(i),u=b(),p.c(),a(r,"type","button"),a(r,"class","btn-link svelte-1p30553"),r.disabled=l[1],a(t,"class","network-list-header svelte-1p30553"),a(e,"class","network-list svelte-1p30553")},m(y,L){w(y,e,L),o(e,t),o(t,n),o(t,s),o(t,r),o(r,c),o(e,u),S[f].m(e,null),m=!0,v||(_=N(r,"click",l[10]),v=!0)},p(y,L){(!m||L&2)&&i!==(i=y[1]?"Scanning...":"Rescan")&&D(c,i),(!m||L&2)&&(r.disabled=y[1]);let C=f;f=g(y),f===C?S[f].p(y,L):(ke(),Q(S[C],1,1,()=>{S[C]=null}),we(),p=S[f],p?p.p(y,L):(p=S[f]=h[f](y),p.c()),W(p,1),p.m(e,null))},i(y){m||(W(p),m=!0)},o(y){Q(p),m=!1},d(y){y&&k(e),S[f].d(),v=!1,_()}}}function Ti(l){let e,t=Le(l[8]),n=[];for(let s=0;s<t.length;s+=1)n[s]=cs(rs(l,t,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=ze()},m(s,r){for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,r);w(s,e,r)},p(s,r){if(r&2336){t=Le(s[8]);let i;for(i=0;i<t.length;i+=1){const c=rs(s,t,i);n[i]?n[i].p(c,r):(n[i]=cs(c),n[i].c(),n[i].m(e.parentNode,e))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},i:G,o:G,d(s){s&&k(e),Je(n,s)}}}function Li(l){let e;return{c(){e=d("div"),e.textContent="No networks found. Try rescanning or enter SSID manually.",a(e,"class","no-networks svelte-1p30553")},m(t,n){w(t,e,n)},p:G,i:G,o:G,d(t){t&&k(e)}}}function zi(l){let e,t,n,s,r;return t=new Ue({props:{size:"small"}}),{c(){e=d("div"),fe(t.$$.fragment),n=b(),s=d("span"),s.textContent="Scanning...",a(e,"class","scanning svelte-1p30553")},m(i,c){w(i,e,c),ce(t,e,null),o(e,n),o(e,s),r=!0},p:G,i(i){r||(W(t.$$.fragment,i),r=!0)},o(i){Q(t.$$.fragment,i),r=!1},d(i){i&&k(e),ue(t)}}}function as(l){let e;return{c(){e=d("span"),e.textContent="ðŸ”’",a(e,"class","lock svelte-1p30553")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function cs(l){let e,t,n=l[19].ssid+"",s,r,i,c,u=us(l[19].rssi)+"",f,p,m,v,_,h=l[19].secure&&as();function S(){return l[15](l[19])}return{c(){e=d("button"),t=d("span"),s=F(n),r=b(),i=d("span"),c=d("span"),f=F(u),p=b(),h&&h.c(),m=b(),a(t,"class","network-name svelte-1p30553"),a(c,"class","signal svelte-1p30553"),a(i,"class","network-info svelte-1p30553"),a(e,"type","button"),a(e,"class","network-item svelte-1p30553"),H(e,"selected",l[5]===l[19].ssid)},m(g,y){w(g,e,y),o(e,t),o(t,s),o(e,r),o(e,i),o(i,c),o(c,f),o(i,p),h&&h.m(i,null),o(e,m),v||(_=N(e,"click",S),v=!0)},p(g,y){l=g,y&256&&n!==(n=l[19].ssid+"")&&D(s,n),y&256&&u!==(u=us(l[19].rssi)+"")&&D(f,u),l[19].secure?h||(h=as(),h.c(),h.m(i,null)):h&&(h.d(1),h=null),y&288&&H(e,"selected",l[5]===l[19].ssid)},d(g){g&&k(e),h&&h.d(),v=!1,_()}}}function Fi(l){let e,t,n;return{c(){e=d("input"),a(e,"id","password"),a(e,"type","password"),a(e,"placeholder","Enter WiFi password"),e.disabled=l[2],a(e,"class","svelte-1p30553")},m(s,r){w(s,e,r),te(e,l[6]),t||(n=N(e,"input",l[17]),t=!0)},p(s,r){r&4&&(e.disabled=s[2]),r&64&&e.value!==s[6]&&te(e,s[6])},d(s){s&&k(e),t=!1,n()}}}function Ei(l){let e,t,n;return{c(){e=d("input"),a(e,"id","password"),a(e,"type","text"),a(e,"placeholder","Enter WiFi password"),e.disabled=l[2],a(e,"class","svelte-1p30553")},m(s,r){w(s,e,r),te(e,l[6]),t||(n=N(e,"input",l[16]),t=!0)},p(s,r){r&4&&(e.disabled=s[2]),r&64&&e.value!==s[6]&&te(e,s[6])},d(s){s&&k(e),t=!1,n()}}}function Ai(l){let e,t,n,s,r,i,c,u,f,p=l[9]?"Hide":"Browse",m,v,_,h,S,g,y,L,C,T=l[7]?"Hide":"Show",O,A,E,z,q,R,I,M=l[2]?"Saving...":"Update WiFi Settings",B,P,j,U,K,J=l[3]&&is(l),X=l[9]&&os(l);function oe(Z,re){return Z[7]?Ei:Fi}let me=oe(l),x=me(l);return{c(){e=d("div"),J&&J.c(),t=b(),n=d("div"),s=d("label"),s.textContent="WiFi Network (SSID)",r=b(),i=d("div"),c=d("input"),u=b(),f=d("button"),m=F(p),v=b(),X&&X.c(),_=b(),h=d("div"),S=d("label"),S.textContent="Password",g=b(),y=d("div"),x.c(),L=b(),C=d("button"),O=F(T),A=b(),E=d("div"),E.textContent="Minimum 8 characters",z=b(),q=d("div"),q.textContent=`The device will restart after saving. You may need to reconnect
          to the new network to continue using the device.`,R=b(),I=d("button"),B=F(M),a(s,"for","ssid"),a(s,"class","svelte-1p30553"),a(c,"id","ssid"),a(c,"type","text"),a(c,"placeholder","Enter network name"),c.disabled=l[2],a(c,"class","svelte-1p30553"),a(f,"type","button"),a(f,"class","btn-secondary scan-btn svelte-1p30553"),f.disabled=l[2],a(i,"class","ssid-input-group svelte-1p30553"),a(n,"class","form-group svelte-1p30553"),a(S,"for","password"),a(S,"class","svelte-1p30553"),a(C,"type","button"),a(C,"class","toggle-password svelte-1p30553"),a(y,"class","password-input-group svelte-1p30553"),a(E,"class","help-text svelte-1p30553"),a(h,"class","form-group svelte-1p30553"),a(q,"class","warning-text svelte-1p30553"),a(I,"type","button"),a(I,"class","btn-primary svelte-1p30553"),I.disabled=P=l[2]||!l[5].trim()||l[6].length<8,a(e,"class","form-section svelte-1p30553")},m(Z,re){w(Z,e,re),J&&J.m(e,null),o(e,t),o(e,n),o(n,s),o(n,r),o(n,i),o(i,c),te(c,l[5]),o(i,u),o(i,f),o(f,m),o(e,v),X&&X.m(e,null),o(e,_),o(e,h),o(h,S),o(h,g),o(h,y),x.m(y,null),o(y,L),o(y,C),o(C,O),o(h,A),o(h,E),o(e,z),o(e,q),o(e,R),o(e,I),o(I,B),j=!0,U||(K=[N(c,"input",l[13]),N(f,"click",l[14]),N(C,"click",l[18]),N(I,"click",l[12])],U=!0)},p(Z,re){Z[3]?J?J.p(Z,re):(J=is(Z),J.c(),J.m(e,t)):J&&(J.d(1),J=null),(!j||re&4)&&(c.disabled=Z[2]),re&32&&c.value!==Z[5]&&te(c,Z[5]),(!j||re&512)&&p!==(p=Z[9]?"Hide":"Browse")&&D(m,p),(!j||re&4)&&(f.disabled=Z[2]),Z[9]?X?(X.p(Z,re),re&512&&W(X,1)):(X=os(Z),X.c(),W(X,1),X.m(e,_)):X&&(ke(),Q(X,1,1,()=>{X=null}),we()),me===(me=oe(Z))&&x?x.p(Z,re):(x.d(1),x=me(Z),x&&(x.c(),x.m(y,L))),(!j||re&128)&&T!==(T=Z[7]?"Hide":"Show")&&D(O,T),(!j||re&4)&&M!==(M=Z[2]?"Saving...":"Update WiFi Settings")&&D(B,M),(!j||re&100&&P!==(P=Z[2]||!Z[5].trim()||Z[6].length<8))&&(I.disabled=P)},i(Z){j||(W(X),j=!0)},o(Z){Q(X),j=!1},d(Z){Z&&k(e),J&&J.d(),X&&X.d(),x.d(),U=!1,_e(K)}}}function qi(l){let e,t,n,s,r,i,c,u,f;return{c(){e=d("div"),t=d("div"),t.textContent="âœ“",n=b(),s=d("h2"),s.textContent="Success!",r=b(),i=d("p"),c=F(l[4]),u=b(),f=d("p"),f.textContent=`The device is restarting. Once it connects to your WiFi network,
          you can access it at its new IP address.`,a(t,"class","success-icon svelte-1p30553"),a(s,"class","svelte-1p30553"),a(i,"class","svelte-1p30553"),a(f,"class","reconnect-info svelte-1p30553"),a(e,"class","success-message svelte-1p30553")},m(p,m){w(p,e,m),o(e,t),o(e,n),o(e,s),o(e,r),o(e,i),o(i,c),o(e,u),o(e,f)},p(p,m){m&16&&D(c,p[4])},d(p){p&&k(e)}}}function Ii(l){let e,t,n,s,r,i;const c=[yi,Si,Ci],u=[];function f(p,m){return p[0]?0:p[4]?1:2}return s=f(l),r=u[s]=c[s](l),{c(){e=d("div"),t=d("div"),t.innerHTML='<h1 class="svelte-1p30553">WiFi Settings</h1> <p class="subtitle svelte-1p30553">Update your WiFi connection without losing device registration</p>',n=b(),r.c(),a(t,"class","header svelte-1p30553"),a(e,"class","wifi-container svelte-1p30553")},m(p,m){w(p,e,m),o(e,t),o(e,n),u[s].m(e,null),i=!0},p(p,[m]){let v=s;s=f(p),s===v?u[s].p(p,m):(ke(),Q(u[v],1,1,()=>{u[v]=null}),we(),r=u[s],r?r.p(p,m):(r=u[s]=c[s](p),r.c()),W(r,1),r.m(e,null))},i(p){i||(W(r),i=!0)},o(p){Q(r),i=!1},d(p){p&&k(e),u[s].d()}}}function us(l){return l>=-50?"â–ˆâ–ˆâ–ˆâ–ˆ":l>=-60?"â–ˆâ–ˆâ–ˆâ–‘":l>=-70?"â–ˆâ–ˆâ–‘â–‘":"â–ˆâ–‘â–‘â–‘"}function Oi(l,e,t){let n=!0,s=!1,r=!1,i=null,c=null,u="",f="",p=!1,m=[],v=!1;We(async()=>{await _(),t(0,n=!1)});async function _(){t(1,s=!0),t(3,i=null);try{const A=await ys(!0);t(8,m=A.networks||[]),console.log("[WIFI] Found networks:",m)}catch(A){console.error("[WIFI] Scan error:",A),t(8,m=[])}t(1,s=!1)}function h(A){t(5,u=A.ssid),t(9,v=!1)}async function S(){if(t(3,i=null),t(4,c=null),!u.trim()){t(3,i="Please enter or select a WiFi network");return}if(f.length<8){t(3,i="Password must be at least 8 characters");return}t(2,r=!0);try{await Tn({ssid:u.trim(),password:f}),t(4,c="WiFi credentials saved. Device is restarting...")}catch(A){const E=A.message||"";if(E.includes("Failed to fetch")||E.includes("NetworkError")||E.includes("network")||E.includes("Load failed"))t(4,c="WiFi credentials saved. Device is restarting...");else{t(3,i=A.message||"Failed to update WiFi settings"),t(2,r=!1);return}}t(2,r=!1)}function g(){u=this.value,t(5,u)}const y=()=>t(9,v=!v),L=A=>h(A);function C(){f=this.value,t(6,f)}function T(){f=this.value,t(6,f)}return[n,s,r,i,c,u,f,p,m,v,_,h,S,g,y,L,C,T,()=>t(7,p=!p)]}class Pi extends Ee{constructor(e){super(),Fe(this,e,Oi,Ii,ye,{})}}function Ni(l){let e,t;return e=new Ks({props:{$$slots:{default:[Mi]},$$scope:{ctx:l}}}),{c(){fe(e.$$.fragment)},m(n,s){ce(e,n,s),t=!0},p(n,s){const r={};s&18&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(W(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ue(e,n)}}}function Ri(l){let e,t,n;var s=l[1];function r(i,c){return{}}return s&&(e=pt(s,r())),{c(){e&&fe(e.$$.fragment),t=ze()},m(i,c){e&&ce(e,i,c),w(i,t,c),n=!0},p(i,c){if(c&2&&s!==(s=i[1])){if(e){ke();const u=e;Q(u.$$.fragment,1,0,()=>{ue(u,1)}),we()}s?(e=pt(s,r()),fe(e.$$.fragment),W(e.$$.fragment,1),ce(e,t.parentNode,t)):e=null}},i(i){n||(e&&W(e.$$.fragment,i),n=!0)},o(i){e&&Q(e.$$.fragment,i),n=!1},d(i){i&&k(t),e&&ue(e,i)}}}function Mi(l){let e,t,n;var s=l[1];function r(i,c){return{}}return s&&(e=pt(s,r())),{c(){e&&fe(e.$$.fragment),t=ze()},m(i,c){e&&ce(e,i,c),w(i,t,c),n=!0},p(i,c){if(c&2&&s!==(s=i[1])){if(e){ke();const u=e;Q(u.$$.fragment,1,0,()=>{ue(u,1)}),we()}s?(e=pt(s,r()),fe(e.$$.fragment),W(e.$$.fragment,1),ce(e,t.parentNode,t)):e=null}},i(i){n||(e&&W(e.$$.fragment,i),n=!0)},o(i){e&&Q(e.$$.fragment,i),n=!1},d(i){i&&k(t),e&&ue(e,i)}}}function Ui(l){let e,t,n,s;const r=[Ri,Ni],i=[];function c(u,f){return u[0]?0:1}return e=c(l),t=i[e]=r[e](l),{c(){t.c(),n=ze()},m(u,f){i[e].m(u,f),w(u,n,f),s=!0},p(u,[f]){let p=e;e=c(u),e===p?i[e].p(u,f):(ke(),Q(i[p],1,1,()=>{i[p]=null}),we(),t=i[e],t?t.p(u,f):(t=i[e]=r[e](u),t.c()),W(t,1),t.m(n.parentNode,n))},i(u){s||(W(t),s=!0)},o(u){Q(t),s=!1},d(u){u&&k(n),i[e].d(u)}}}function Di(l,e,t){let n,s,r;dt(l,qt,c=>t(2,r=c));function i(c){const u=c.startsWith("/")?c:"/"+c;return u==="/"||u===""?$t:u==="/gallery"?er:u==="/calibration"?nr:u==="/servo"?ar:u==="/settings"?br:u==="/logs"||u==="/status"?Al:u==="/firmware"||u.startsWith("/reboot")?Wl:u==="/test"?ti:u==="/setup"?wi:u==="/wifi"?Pi:$t}return l.$$.update=()=>{l.$$.dirty&4&&t(1,n=i(r)),l.$$.dirty&4&&t(0,s=r==="/setup"||r==="setup")},[s,n,r]}class ji extends Ee{constructor(e){super(),Fe(this,e,Di,Ui,ye,{})}}const rt=(...l)=>console.log("[JS]",...l);function fs(l){rt("app-main: FATAL",l);const e=document.getElementById("app");e&&e.childElementCount===0&&(e.innerHTML=`
      <div style="font: 14px system-ui, sans-serif; color:#ddd; background:#111; padding:16px; line-height:1.35">
        <div style="font-weight:600; margin-bottom:8px; color:#ff6b6b">âš ï¸ App failed to load</div>
        <div style="opacity:.85; margin-bottom:8px">Check console for full stack. Error:</div>
        <pre style="white-space:pre-wrap; background:#181818; border:1px solid #ff6b6b; padding:12px; border-radius:6px; overflow:auto; color:#ffcccc">
${String(l&&(l.stack||l.message)||l)}
        </pre>
      </div>`)}window.addEventListener("error",l=>rt("global-error:",l.message||l.error));window.addEventListener("unhandledrejection",l=>rt("unhandled-rejection:",l.reason));(function(){rt("app-main: start");const e=document.getElementById("app");if(!e){fs("Missing #app container in HTML");return}try{const t=new ji({target:e});window.__MOUSETRAP_APP={ok:!0,mountedAt:Date.now(),app:t},rt("app-main: mounted OK")}catch(t){window.__MOUSETRAP_APP={ok:!1,error:t,when:Date.now()},fs(t)}})();
