var xl=Object.defineProperty;var es=(l,e,t)=>e in l?xl(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var ot=(l,e,t)=>es(l,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function Y(){}function ts(l,e){for(const t in e)l[t]=e[t];return l}function ls(l){return!!l&&(typeof l=="object"||typeof l=="function")&&typeof l.then=="function"}function Dl(l){return l()}function kt(){return Object.create(null)}function de(l){l.forEach(Dl)}function it(l){return typeof l=="function"}function ge(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let xe;function We(l,e){return l===e?!0:(xe||(xe=document.createElement("a")),xe.href=e,l===xe.href)}function ss(l){return Object.keys(l).length===0}function Ul(l,...e){if(l==null){for(const n of e)n(void 0);return Y}const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function lt(l,e,t){l.$$.on_destroy.push(Ul(e,t))}function ut(l,e,t,n){if(l){const s=Hl(l,e,t,n);return l[0](s)}}function Hl(l,e,t,n){return l[1]&&n?ts(t.ctx.slice(),l[1](n(e))):t.ctx}function ft(l,e,t,n){if(l[2]&&n){const s=l[2](n(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],o=Math.max(e.dirty.length,s.length);for(let c=0;c<o;c+=1)r[c]=e.dirty[c]|s[c];return r}return e.dirty|s}return e.dirty}function dt(l,e,t,n,s,r){if(s){const o=Hl(e,t,n,r);l.p(o,s)}}function pt(l){if(l.ctx.length>32){const e=[],t=l.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function Ee(l){return l&&it(l.destroy)?l.destroy:Y}const Vl=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function i(l,e){l.appendChild(e)}function z(l,e,t){l.insertBefore(e,t||null)}function T(l){l.parentNode&&l.parentNode.removeChild(l)}function Ge(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function d(l){return document.createElement(l)}function A(l){return document.createTextNode(l)}function b(){return A(" ")}function ze(){return A("")}function M(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function at(l){return function(e){return e.preventDefault(),l.call(this,e)}}function Bl(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function a(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function ns(l){let e;return{p(...t){e=t,e.forEach(n=>l.push(n))},r(){e.forEach(t=>l.splice(l.indexOf(t),1))}}}function Fe(l){return l===""?null:+l}function rs(l){return Array.from(l.childNodes)}function D(l,e){e=""+e,l.data!==e&&(l.data=e)}function ee(l,e){l.value=e??""}function Re(l,e,t,n){t==null?l.style.removeProperty(e):l.style.setProperty(e,t,"")}function W(l,e,t){l.classList.toggle(e,!!t)}function st(l,e){return new l(e)}let Ke;function Oe(l){Ke=l}function _t(){if(!Ke)throw new Error("Function called outside component initialization");return Ke}function Pe(l){_t().$$.on_mount.push(l)}function Xe(l){_t().$$.on_destroy.push(l)}function wt(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const Ve=[],Ye=[];let Be=[];const Ct=[],is=Promise.resolve();let mt=!1;function os(){mt||(mt=!0,is.then(bt))}function vt(l){Be.push(l)}const ct=new Set;let Ue=0;function bt(){if(Ue!==0)return;const l=Ke;do{try{for(;Ue<Ve.length;){const e=Ve[Ue];Ue++,Oe(e),as(e.$$)}}catch(e){throw Ve.length=0,Ue=0,e}for(Oe(null),Ve.length=0,Ue=0;Ye.length;)Ye.pop()();for(let e=0;e<Be.length;e+=1){const t=Be[e];ct.has(t)||(ct.add(t),t())}Be.length=0}while(Ve.length);for(;Ct.length;)Ct.pop()();mt=!1,ct.clear(),Oe(l)}function as(l){if(l.fragment!==null){l.update(),de(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(vt)}}function cs(l){const e=[],t=[];Be.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Be=e}const tt=new Set;let De;function we(){De={r:0,c:[],p:De}}function Ce(){De.r||de(De.c),De=De.p}function Q(l,e){l&&l.i&&(tt.delete(l),l.i(e))}function X(l,e,t,n){if(l&&l.o){if(tt.has(l))return;tt.add(l),De.c.push(()=>{tt.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function nt(l,e){const t=e.token={};function n(s,r,o,c){if(e.token!==t)return;e.resolved=c;let u=e.ctx;o!==void 0&&(u=u.slice(),u[o]=c);const f=s&&(e.current=s)(u);let p=!1;e.block&&(e.blocks?e.blocks.forEach((m,v)=>{v!==r&&m&&(we(),X(m,1,1,()=>{e.blocks[v]===m&&(e.blocks[v]=null)}),Ce())}):e.block.d(1),f.c(),Q(f,1),f.m(e.mount(),e.anchor),p=!0),e.block=f,e.blocks&&(e.blocks[r]=f),p&&bt()}if(ls(l)){const s=_t();if(l.then(r=>{Oe(s),n(e.then,1,e.value,r),Oe(null)},r=>{if(Oe(s),n(e.catch,2,e.error,r),Oe(null),!e.hasCatch)throw r}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,l),!0;e.resolved=l}}function Wl(l,e,t){const n=e.slice(),{resolved:s}=l;l.current===l.then&&(n[l.value]=s),l.current===l.catch&&(n[l.error]=s),l.block.p(n,t)}function Le(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function ce(l){l&&l.c()}function ie(l,e,t){const{fragment:n,after_update:s}=l.$$;n&&n.m(e,t),vt(()=>{const r=l.$$.on_mount.map(Dl).filter(it);l.$$.on_destroy?l.$$.on_destroy.push(...r):de(r),l.$$.on_mount=[]}),s.forEach(vt)}function oe(l,e){const t=l.$$;t.fragment!==null&&(cs(t.after_update),de(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function us(l,e){l.$$.dirty[0]===-1&&(Ve.push(l),os(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function ye(l,e,t,n,s,r,o=null,c=[-1]){const u=Ke;Oe(l);const f=l.$$={fragment:null,ctx:[],props:r,update:Y,not_equal:s,bound:kt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:kt(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};o&&o(f.root);let p=!1;if(f.ctx=t?t(l,e.props||{},(m,v,..._)=>{const h=_.length?_[0]:v;return f.ctx&&s(f.ctx[m],f.ctx[m]=h)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](h),p&&us(l,m)),v}):[],f.update(),p=!0,de(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const m=rs(e.target);f.fragment&&f.fragment.l(m),m.forEach(T)}else f.fragment&&f.fragment.c();e.intro&&Q(l.$$.fragment),ie(l,e.target,e.anchor),bt()}Oe(u)}class Se{constructor(){ot(this,"$$");ot(this,"$$set")}$destroy(){oe(this,1),this.$destroy=Y}$on(e,t){if(!it(t))return Y;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!ss(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const fs="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(fs);const He=[];function ds(l,e){return{subscribe:$e(l,e).subscribe}}function $e(l,e=Y){let t;const n=new Set;function s(c){if(ge(l,c)&&(l=c,t)){const u=!He.length;for(const f of n)f[1](),He.push(f,l);if(u){for(let f=0;f<He.length;f+=2)He[f][0](He[f+1]);He.length=0}}}function r(c){s(c(l))}function o(c,u=Y){const f=[c,u];return n.add(f),n.size===1&&(t=e(s,r)||Y),c(l),()=>{n.delete(f),n.size===0&&t&&(t(),t=null)}}return{set:s,update:r,subscribe:o}}function Gl(l,e,t){const n=!Array.isArray(l),s=n?[l]:l;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return ds(t,(o,c)=>{let u=!1;const f=[];let p=0,m=Y;const v=()=>{if(p)return;m();const h=e(n?f[0]:f,o,c);r?o(h):m=it(h)?h:Y},_=s.map((h,k)=>Ul(h,g=>{f[k]=g,p&=~(1<<k),u&&v()},()=>{p|=1<<k}));return u=!0,v(),function(){de(_),m(),u=!1}})}const Jl=$e({threshold:0,sensorReading:0,detectionState:!1,uptime:"",wifiRSSI:0,heap:0,psram:0,lastUpdate:null}),Qe=$e(!1);function ps(l,e){const t=localStorage.getItem(l),n=t?JSON.parse(t):e,{subscribe:s,set:r,update:o}=$e(n);return{subscribe:s,set:c=>{localStorage.setItem(l,JSON.stringify(c)),r(c)},update:c=>{o(u=>{const f=c(u);return localStorage.setItem(l,JSON.stringify(f)),f})}}}ps("mousetrap-prefs",{theme:"dark",refreshInterval:5e3});Gl(Jl,l=>l.detectionState);Gl(Jl,l=>l.lastUpdate?l.detectionState?"red":"green":"gray");const ht=$e(window.location.hash.slice(1)||"/");window.addEventListener("hashchange",()=>{const l=window.location.hash.slice(1)||"/";ht.set(l)});function ms(l){window.location.hash=l}function Ie(l){function e(t){const n=l.getAttribute("href");n&&n.startsWith("#/")&&(t.preventDefault(),ms(n.slice(1)))}return l.addEventListener("click",e),{destroy(){l.removeEventListener("click",e)}}}function yt(l){let e,t,n,s,r,o,c,u;return{c(){e=d("div"),t=d("a"),t.textContent="Servo Settings",n=b(),s=d("a"),s.textContent="Calibration",r=b(),o=d("a"),o.textContent="Options & Access",a(t,"href","#/servo"),a(t,"class","svelte-1n65rh9"),W(t,"active",l[0]==="/servo"),a(s,"href","#/calibration"),a(s,"class","svelte-1n65rh9"),W(s,"active",l[0]==="/calibration"),a(o,"href","#/settings"),a(o,"class","svelte-1n65rh9"),W(o,"active",l[0]==="/settings"),a(e,"class","submenu svelte-1n65rh9")},m(f,p){z(f,e,p),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),c||(u=[Ee(Ie.call(null,t)),M(t,"click",l[5]),Ee(Ie.call(null,s)),M(s,"click",l[5]),Ee(Ie.call(null,o)),M(o,"click",l[5])],c=!0)},p(f,p){p&1&&W(t,"active",f[0]==="/servo"),p&1&&W(s,"active",f[0]==="/calibration"),p&1&&W(o,"active",f[0]==="/settings")},d(f){f&&T(e),c=!1,de(u)}}}function St(l){let e,t,n,s,r,o,c,u;return{c(){e=d("div"),t=d("a"),t.textContent="Status",n=b(),s=d("a"),s.textContent="System Logs",r=b(),o=d("a"),o.textContent="Gallery",a(t,"href","#/status"),a(t,"class","svelte-1n65rh9"),W(t,"active",l[0]==="/status"),a(s,"href","#/logs"),a(s,"class","svelte-1n65rh9"),W(s,"active",l[0]==="/logs"),a(o,"href","#/gallery"),a(o,"class","svelte-1n65rh9"),W(o,"active",l[0]==="/gallery"),a(e,"class","submenu svelte-1n65rh9")},m(f,p){z(f,e,p),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),c||(u=[Ee(Ie.call(null,t)),M(t,"click",l[5]),Ee(Ie.call(null,s)),M(s,"click",l[5]),Ee(Ie.call(null,o)),M(o,"click",l[5])],c=!0)},p(f,p){p&1&&W(t,"active",f[0]==="/status"),p&1&&W(s,"active",f[0]==="/logs"),p&1&&W(o,"active",f[0]==="/gallery")},d(f){f&&T(e),c=!1,de(u)}}}function Tt(l){let e,t,n,s,r,o,c,u,f,p;return{c(){e=d("div"),t=d("a"),t.textContent="Claim",n=b(),s=d("a"),s.textContent="Test Alert",r=b(),o=d("a"),o.textContent="Firmware / OTA",c=b(),u=d("a"),u.textContent="Reboot",a(t,"href","/claim"),a(t,"class","svelte-1n65rh9"),a(s,"href","#/test"),a(s,"class","svelte-1n65rh9"),W(s,"active",l[0]==="/test"),a(o,"href","#/firmware"),a(o,"class","svelte-1n65rh9"),W(o,"active",l[0]==="/firmware"),a(u,"href","#/reboot"),a(u,"class","svelte-1n65rh9"),W(u,"active",l[0].startsWith("/reboot")),a(e,"class","submenu svelte-1n65rh9")},m(m,v){z(m,e,v),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(e,c),i(e,u),f||(p=[M(t,"click",l[5]),Ee(Ie.call(null,s)),M(s,"click",l[5]),Ee(Ie.call(null,o)),M(o,"click",l[5]),Ee(Ie.call(null,u)),M(u,"click",l[5])],f=!0)},p(m,v){v&1&&W(s,"active",m[0]==="/test"),v&1&&W(o,"active",m[0]==="/firmware"),v&1&&W(u,"active",m[0].startsWith("/reboot"))},d(m){m&&T(e),f=!1,de(p)}}}function zt(l){let e,t,n;return{c(){e=d("div"),a(e,"class","backdrop svelte-1n65rh9")},m(s,r){z(s,e,r),t||(n=M(e,"click",l[5]),t=!0)},p:Y,d(s){s&&T(e),t=!1,n()}}}function vs(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k,g,y,S,C,w,R,I=l[1]&&yt(l),O=l[2]&&St(l),q=l[3]&&Tt(l),E=l[4]&&zt(l);return{c(){e=d("div"),t=d("a"),t.textContent="Home",n=b(),s=d("a"),r=A(`Settings
    `),o=d("span"),o.textContent="â–¸",c=b(),I&&I.c(),u=b(),f=d("a"),p=A(`Logs & Diagnostics
    `),m=d("span"),m.textContent="â–¸",v=b(),O&&O.c(),_=b(),h=d("a"),k=A(`Maintenance
    `),g=d("span"),g.textContent="â–¸",y=b(),q&&q.c(),S=b(),E&&E.c(),C=ze(),a(t,"href","#/"),a(t,"class","svelte-1n65rh9"),W(t,"active",l[0]==="/"),a(o,"class","arrow svelte-1n65rh9"),W(o,"expanded",l[1]),a(s,"href","#"),a(s,"class","parent svelte-1n65rh9"),a(m,"class","arrow svelte-1n65rh9"),W(m,"expanded",l[2]),a(f,"href","#"),a(f,"class","parent svelte-1n65rh9"),a(g,"class","arrow svelte-1n65rh9"),W(g,"expanded",l[3]),a(h,"href","#"),a(h,"class","parent svelte-1n65rh9"),a(e,"class","menu svelte-1n65rh9"),W(e,"open",l[4])},m(P,L){z(P,e,L),i(e,t),i(e,n),i(e,s),i(s,r),i(s,o),i(e,c),I&&I.m(e,null),i(e,u),i(e,f),i(f,p),i(f,m),i(e,v),O&&O.m(e,null),i(e,_),i(e,h),i(h,k),i(h,g),i(e,y),q&&q.m(e,null),z(P,S,L),E&&E.m(P,L),z(P,C,L),w||(R=[Ee(Ie.call(null,t)),M(t,"click",l[5]),M(s,"click",at(l[7])),M(f,"click",at(l[8])),M(h,"click",at(l[9]))],w=!0)},p(P,[L]){L&1&&W(t,"active",P[0]==="/"),L&2&&W(o,"expanded",P[1]),P[1]?I?I.p(P,L):(I=yt(P),I.c(),I.m(e,u)):I&&(I.d(1),I=null),L&4&&W(m,"expanded",P[2]),P[2]?O?O.p(P,L):(O=St(P),O.c(),O.m(e,_)):O&&(O.d(1),O=null),L&8&&W(g,"expanded",P[3]),P[3]?q?q.p(P,L):(q=Tt(P),q.c(),q.m(e,null)):q&&(q.d(1),q=null),L&16&&W(e,"open",P[4]),P[4]?E?E.p(P,L):(E=zt(P),E.c(),E.m(C.parentNode,C)):E&&(E.d(1),E=null)},i:Y,o:Y,d(P){P&&(T(e),T(S),T(C)),I&&I.d(),O&&O.d(),q&&q.d(),E&&E.d(P),w=!1,de(R)}}}function _s(l,e,t){let n,s;lt(l,ht,_=>t(0,n=_)),lt(l,Qe,_=>t(4,s=_));let r=!1,o=!1,c=!1;function u(){Qe.set(!1)}function f(_){_==="settings"&&t(1,r=!r),_==="logs"&&t(2,o=!o),_==="maintenance"&&t(3,c=!c)}const p=()=>f("settings"),m=()=>f("logs"),v=()=>f("maintenance");return l.$$.update=()=>{if(l.$$.dirty&1){const _=n;t(1,r=_.startsWith("/servo")||_.startsWith("/calibration")||_.startsWith("/settings")),t(2,o=_.startsWith("/logs")||_.startsWith("/status")||_.startsWith("/gallery")),t(3,c=_.startsWith("/claim")||_.startsWith("/test")||_.startsWith("/firmware")||_.startsWith("/reboot"))}},[n,r,o,c,s,u,f,p,m,v]}class bs extends Se{constructor(e){super(),ye(this,e,_s,vs,ge,{})}}function hs(l){let e,t,n,s,r,o,c,u,f;s=new bs({});const p=l[3].default,m=ut(p,l,l[2],null);return{c(){e=d("div"),t=d("div"),t.innerHTML='<div class="bar svelte-1stvkey"></div> <div class="bar svelte-1stvkey"></div> <div class="bar svelte-1stvkey"></div>',n=b(),ce(s.$$.fragment),r=b(),o=d("main"),m&&m.c(),a(t,"class","hamburger svelte-1stvkey"),a(t,"role","button"),a(t,"tabindex","0"),a(t,"aria-label","Toggle navigation menu"),a(o,"class","content svelte-1stvkey"),a(e,"class","layout svelte-1stvkey")},m(v,_){z(v,e,_),i(e,t),i(e,n),ie(s,e,null),i(e,r),i(e,o),m&&m.m(o,null),c=!0,u||(f=[M(window,"keydown",l[1]),M(t,"click",l[0]),M(t,"keydown",l[4])],u=!0)},p(v,[_]){m&&m.p&&(!c||_&4)&&dt(m,p,v,v[2],c?ft(p,v[2],_,null):pt(v[2]),null)},i(v){c||(Q(s.$$.fragment,v),Q(m,v),c=!0)},o(v){X(s.$$.fragment,v),X(m,v),c=!1},d(v){v&&T(e),oe(s),m&&m.d(v),u=!1,de(f)}}}function gs(l,e,t){let n;lt(l,Qe,f=>t(5,n=f));let{$$slots:s={},$$scope:r}=e;function o(){Qe.update(f=>!f)}function c(f){f.key==="Escape"&&n&&Qe.set(!1)}const u=f=>f.key==="Enter"&&o();return l.$$set=f=>{"$$scope"in f&&t(2,r=f.$$scope)},[o,c,r,s,u]}class ks extends Se{constructor(e){super(),ye(this,e,gs,hs,ge,{})}}const ws=l=>({}),qt=l=>({});function At(l){let e,t;return{c(){e=d("h3"),t=A(l[0]),a(e,"class","card-title svelte-q6oxq0")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s&1&&D(t,n[0])},d(n){n&&T(e)}}}function Cs(l){let e,t,n,s,r,o,c,u=l[0]&&At(l);const f=l[2].actions,p=ut(f,l,l[1],qt),m=l[2].default,v=ut(m,l,l[1],null);return{c(){e=d("div"),t=d("div"),u&&u.c(),n=b(),s=d("div"),p&&p.c(),r=b(),o=d("div"),v&&v.c(),a(s,"class","card-actions svelte-q6oxq0"),a(t,"class","card-header svelte-q6oxq0"),a(o,"class","card-content svelte-q6oxq0"),a(e,"class","card svelte-q6oxq0")},m(_,h){z(_,e,h),i(e,t),u&&u.m(t,null),i(t,n),i(t,s),p&&p.m(s,null),i(e,r),i(e,o),v&&v.m(o,null),c=!0},p(_,[h]){_[0]?u?u.p(_,h):(u=At(_),u.c(),u.m(t,n)):u&&(u.d(1),u=null),p&&p.p&&(!c||h&2)&&dt(p,f,_,_[1],c?ft(f,_[1],h,ws):pt(_[1]),qt),v&&v.p&&(!c||h&2)&&dt(v,m,_,_[1],c?ft(m,_[1],h,null):pt(_[1]),null)},i(_){c||(Q(p,_),Q(v,_),c=!0)},o(_){X(p,_),X(v,_),c=!1},d(_){_&&T(e),u&&u.d(),p&&p.d(_),v&&v.d(_)}}}function ys(l,e,t){let{$$slots:n={},$$scope:s}=e,{title:r=""}=e;return l.$$set=o=>{"title"in o&&t(0,r=o.title),"$$scope"in o&&t(1,s=o.$$scope)},[r,s,n]}class ke extends Se{constructor(e){super(),ye(this,e,ys,Cs,ge,{title:0})}}const Ql=window.location.origin;async function ue(l,e={}){try{const t=`${Ql}${l}`,n=await fetch(t,{...e,headers:{"Content-Type":"application/json",Accept:"application/json",...e.headers}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const s=n.headers.get("content-type");return s&&s.includes("application/json")?await n.json():s&&s.includes("image/")?await n.blob():await n.text()}catch(t){throw console.error(`API Error [${l}]:`,t),t}}async function gt(){try{const[l,e]=await Promise.all([ue("/data"),ue("/systemStatus").catch(()=>null)]);return{threshold:l.threshold||0,sensorReading:l.currentHourAverage||0,detectionState:l.triggered||!1,uptime:(e==null?void 0:e.uptime)||"",heap:(e==null?void 0:e.heapFree)||0,anomalies:l.anomalies||[],calibrationOffset:l.calibrationOffset||0,falseAlarmOffset:l.falseAlarmOffset||0,overrideThreshold:l.overrideThreshold||0}}catch{const e=await ue("/data");return{threshold:e.threshold||0,sensorReading:e.currentHourAverage||0,detectionState:e.triggered||!1,uptime:"",heap:0,anomalies:e.anomalies||[],calibrationOffset:e.calibrationOffset||0,falseAlarmOffset:e.falseAlarmOffset||0,overrideThreshold:e.overrideThreshold||0}}}async function Ss(){return ue("/toggleLED")}async function Ts(){return ue("/api/captures")}function Lt(l){return`${Ql}/captures/${l}`}async function zs(l){return ue(`/captures/${l}`,{method:"DELETE"})}async function qs(l){return ue(`/setCalib?calib=${l}`)}async function As(l){return ue(`/setCalib?overrideTh=${l}`)}async function Ls(){return ue("/setCalib?overrideTh=0")}async function Es(){return ue("/recalib")}async function Fs(){return ue("/falseAlarm")}async function Is(){return Promise.resolve({startUS:1500,endUS:1100,disabled:!1})}async function Os(l){const e=new FormData;return e.append("start",l.startUS),e.append("end",l.endUS),l.disabled&&e.append("disableServo","on"),fetch("/setServoSettings",{method:"POST",body:e,headers:{Authorization:"Basic "+btoa("ops:changeme")}}).then(async t=>{if(!t.ok){const n=await t.text();throw new Error(n||`HTTP ${t.status}`)}return t.text()})}async function Kl(){return ue("/servo")}async function Yl(){return await ue("/testAlert")}async function Ps(){return ue("/api/ip-filters")}async function Rs(l){return ue("/api/ip-filters",{method:"POST",body:JSON.stringify(l)})}async function Ns(){return ue("/api/mqtt-config")}async function Ms(l){return ue("/api/mqtt-config",{method:"POST",body:JSON.stringify(l)})}async function js(){return ue("/api/video-mode")}async function Ds(l){return ue("/api/video-mode",{method:"POST",body:JSON.stringify(l)})}async function Us(){return ue("/api/system-logs")}async function Hs(){return ue("/api/previous-logs")}async function Vs(){return ue("/api/system-info")}async function Bs(){return ue("/reboot",{headers:{Authorization:"Basic "+btoa("ops:changeme")}})}async function Ws(){return ue("/sendHeartbeat")}async function Zl(){return ue("/reset")}async function Gs(){return ue("/api/device/claim-status")}async function Js(){for(let t=0;t<10;t++){const n=await ue("/api/wifi/scan");if(!n.scanning&&n.networks)return n;await new Promise(s=>setTimeout(s,500))}return{networks:[],scanning:!1}}async function Qs(l){return ue("/api/setup/connect",{method:"POST",body:JSON.stringify(l)})}const{document:Et}=Vl;function Ft(l,e,t){const n=l.slice();return n[27]=e[t],n}function It(l){let e;return{c(){e=d("div"),e.textContent="TRAP TRIGGERED!",a(e,"class","trap-alert svelte-1kjtmub")},m(t,n){z(t,e,n)},d(t){t&&T(e)}}}function Ks(l){let e,t,n,s,r,o,c,u,f,p=l[2]?"On":"Off",m,v,_,h,k,g,y;return{c(){e=d("div"),t=d("img"),s=b(),r=d("div"),o=d("button"),o.textContent="Refresh",c=b(),u=d("button"),f=A("Live "),m=A(p),v=b(),_=d("button"),_.textContent="Toggle LED",h=b(),k=d("button"),k.textContent="Capture",We(t.src,n=l[0])||a(t,"src",n),a(t,"alt","Camera Feed"),a(t,"class","svelte-1kjtmub"),W(t,"error",l[1]),W(t,"zoomed",l[3]),a(o,"class","btn svelte-1kjtmub"),a(u,"class","btn svelte-1kjtmub"),W(u,"active",l[2]),a(_,"class","btn svelte-1kjtmub"),a(k,"class","btn svelte-1kjtmub"),a(r,"class","camera-controls svelte-1kjtmub"),a(e,"class","camera-container svelte-1kjtmub"),W(e,"zoomed",l[3])},m(S,C){z(S,e,C),i(e,t),i(e,s),i(e,r),i(r,o),i(r,c),i(r,u),i(u,f),i(u,m),i(r,v),i(r,_),i(r,h),i(r,k),g||(y=[M(t,"error",l[14]),M(t,"click",l[15]),M(o,"click",l[7]),M(u,"click",l[8]),M(_,"click",l[9]),M(k,"click",l[13])],g=!0)},p(S,C){C&1&&!We(t.src,n=S[0])&&a(t,"src",n),C&2&&W(t,"error",S[1]),C&8&&W(t,"zoomed",S[3]),C&4&&p!==(p=S[2]?"On":"Off")&&D(m,p),C&4&&W(u,"active",S[2]),C&8&&W(e,"zoomed",S[3])},d(S){S&&T(e),g=!1,de(y)}}}function Ys(l){let e,t,n,s,r,o,c,u=l[4].sensorReading+"",f,p,m,v,_,h=l[4].threshold+"",k;return{c(){e=d("div"),t=d("canvas"),n=b(),s=d("div"),r=d("div"),o=A("Current: "),c=d("strong"),f=A(u),p=b(),m=d("div"),v=A("Threshold: "),_=d("strong"),k=A(h),a(e,"class","chart-container svelte-1kjtmub"),a(c,"class","svelte-1kjtmub"),a(_,"class","svelte-1kjtmub"),a(s,"class","sensor-info svelte-1kjtmub")},m(g,y){z(g,e,y),i(e,t),l[16](t),z(g,n,y),z(g,s,y),i(s,r),i(r,o),i(r,c),i(c,f),i(s,p),i(s,m),i(m,v),i(m,_),i(_,k)},p(g,y){y&16&&u!==(u=g[4].sensorReading+"")&&D(f,u),y&16&&h!==(h=g[4].threshold+"")&&D(k,h)},d(g){g&&(T(e),T(n),T(s)),l[16](null)}}}function Zs(l){let e,t,n,s,r,o=l[4].uptime+"",c,u,f,p,m,v,_=l[4].heap+"",h,k,g,y,S,C,w,R=l[5].message+"",I,O,q,E,P,L,N,V,F,B;return{c(){e=d("div"),t=d("div"),n=d("span"),n.textContent="Uptime:",s=b(),r=d("span"),c=A(o),u=b(),f=d("div"),p=d("span"),p.textContent="Free Heap:",m=b(),v=d("span"),h=A(_),k=A(" bytes"),g=b(),y=d("div"),S=d("span"),S.textContent="Claim Status:",C=b(),w=d("span"),I=A(R),O=b(),q=d("div"),E=d("button"),E.textContent="Reset Alarm",P=b(),L=d("button"),L.textContent="False Alarm",N=b(),V=d("button"),V.textContent="Send Heartbeat",a(t,"class","status-row svelte-1kjtmub"),a(f,"class","status-row svelte-1kjtmub"),a(w,"class","claimed-status"),W(w,"unclaimed",!l[5].claimed),a(y,"class","status-row svelte-1kjtmub"),a(e,"class","status-info svelte-1kjtmub"),a(E,"class","btn svelte-1kjtmub"),a(L,"class","btn svelte-1kjtmub"),a(V,"class","btn svelte-1kjtmub"),a(q,"class","action-buttons svelte-1kjtmub")},m(j,J){z(j,e,J),i(e,t),i(t,n),i(t,s),i(t,r),i(r,c),i(e,u),i(e,f),i(f,p),i(f,m),i(f,v),i(v,h),i(v,k),i(e,g),i(e,y),i(y,S),i(y,C),i(y,w),i(w,I),z(j,O,J),z(j,q,J),i(q,E),i(q,P),i(q,L),i(q,N),i(q,V),F||(B=[M(E,"click",l[10]),M(L,"click",l[11]),M(V,"click",l[12])],F=!0)},p(j,J){J&16&&o!==(o=j[4].uptime+"")&&D(c,o),J&16&&_!==(_=j[4].heap+"")&&D(h,_),J&32&&R!==(R=j[5].message+"")&&D(I,R),J&32&&W(w,"unclaimed",!j[5].claimed)},d(j){j&&(T(e),T(O),T(q)),F=!1,de(B)}}}function Xs(l){let e;return{c(){e=d("p"),e.textContent="No anomalies detected",a(e,"class","no-data svelte-1kjtmub")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function $s(l){let e,t=Le(l[4].anomalies),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ot(Ft(l,t,s));return{c(){e=d("div");for(let s=0;s<n.length;s+=1)n[s].c();a(e,"class","anomalies-list svelte-1kjtmub")},m(s,r){z(s,e,r);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(s,r){if(r&16){t=Le(s[4].anomalies);let o;for(o=0;o<t.length;o+=1){const c=Ft(s,t,o);n[o]?n[o].p(c,r):(n[o]=Ot(c),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(s){s&&T(e),Ge(n,s)}}}function Ot(l){let e,t,n=l[27].timestamp+"",s,r,o,c=l[27].distance+"",u,f,p;return{c(){e=d("div"),t=d("span"),s=A(n),r=b(),o=d("span"),u=A(c),f=A(" cm"),p=b(),a(t,"class","timestamp svelte-1kjtmub"),a(o,"class","distance svelte-1kjtmub"),a(e,"class","anomaly-item svelte-1kjtmub")},m(m,v){z(m,e,v),i(e,t),i(t,s),i(e,r),i(e,o),i(o,u),i(o,f),i(e,p)},p(m,v){v&16&&n!==(n=m[27].timestamp+"")&&D(s,n),v&16&&c!==(c=m[27].distance+"")&&D(u,c)},d(m){m&&T(e)}}}function xs(l){let e;function t(r,o){return r[4].anomalies&&r[4].anomalies.length>0?$s:Xs}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,o){s.m(r,o),z(r,e,o)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){r&&T(e),s.d(r)}}}function en(l){let e,t,n,s,r=(l[5].deviceName||"MouseTrap")+"",o,c,u,f,p,m,v,_,h,k,g,y,S;Et.title=e="Dashboard - "+(l[5].deviceName||"MouseTrap");let C=l[4].detectionState&&It();return p=new ke({props:{title:"Live Camera Feed",$$slots:{default:[Ks]},$$scope:{ctx:l}}}),_=new ke({props:{title:"Sensor Range",$$slots:{default:[Ys]},$$scope:{ctx:l}}}),k=new ke({props:{title:"System Status",$$slots:{default:[Zs]},$$scope:{ctx:l}}}),y=new ke({props:{title:"Anomalous Events",$$slots:{default:[xs]},$$scope:{ctx:l}}}),{c(){t=b(),n=d("div"),s=d("h1"),o=A(r),c=b(),C&&C.c(),u=b(),f=d("div"),ce(p.$$.fragment),m=b(),v=d("div"),ce(_.$$.fragment),h=b(),ce(k.$$.fragment),g=b(),ce(y.$$.fragment),a(s,"class","svelte-1kjtmub"),a(f,"class","camera-card-wrapper svelte-1kjtmub"),a(v,"class","grid svelte-1kjtmub"),a(n,"class","dashboard svelte-1kjtmub")},m(w,R){z(w,t,R),z(w,n,R),i(n,s),i(s,o),i(n,c),C&&C.m(n,null),i(n,u),i(n,f),ie(p,f,null),i(n,m),i(n,v),ie(_,v,null),i(v,h),ie(k,v,null),i(v,g),ie(y,v,null),S=!0},p(w,[R]){(!S||R&32)&&e!==(e="Dashboard - "+(w[5].deviceName||"MouseTrap"))&&(Et.title=e),(!S||R&32)&&r!==(r=(w[5].deviceName||"MouseTrap")+"")&&D(o,r),w[4].detectionState?C||(C=It(),C.c(),C.m(n,u)):C&&(C.d(1),C=null);const I={};R&1073741839&&(I.$$scope={dirty:R,ctx:w}),p.$set(I);const O={};R&1073741904&&(O.$$scope={dirty:R,ctx:w}),_.$set(O);const q={};R&1073741872&&(q.$$scope={dirty:R,ctx:w}),k.$set(q);const E={};R&1073741840&&(E.$$scope={dirty:R,ctx:w}),y.$set(E)},i(w){S||(Q(p.$$.fragment,w),Q(_.$$.fragment,w),Q(k.$$.fragment,w),Q(y.$$.fragment,w),S=!0)},o(w){X(p.$$.fragment,w),X(_.$$.fragment,w),X(k.$$.fragment,w),X(y.$$.fragment,w),S=!1},d(w){w&&(T(t),T(n)),C&&C.d(),oe(p),oe(_),oe(k),oe(y)}}}const Pt=20;function tn(l,e,t){let n="/auto.jpg",s=!1,r=!1,o=!1,c=null,u=null,f={threshold:0,sensorReading:0,detectionState:!1,uptime:"",heap:0,anomalies:[]},p={claimed:!1,message:"Checking...",deviceName:""},m=null,v=null,_=[];async function h(){try{t(0,n=`/auto.jpg?t=${Date.now()}`),t(1,s=!1)}catch(F){console.error("Camera refresh error:",F),t(1,s=!0)}}function k(){try{t(0,n=`/camera?t=${Date.now()}`),t(1,s=!1)}catch(F){console.error("Live frame error:",F),t(1,s=!0)}}function g(){t(2,r=!r),r?(k(),c=setInterval(()=>{k()},100)):(c&&(clearInterval(c),c=null),h())}async function y(){try{await Ss()}catch(F){console.error("Toggle LED error:",F)}}async function S(){try{await Zl(),await I()}catch(F){console.error("Reset alarm error:",F)}}async function C(){try{const F=await Fs();F&&F.newThreshold!==void 0&&t(4,f.threshold=F.newThreshold,f),await I()}catch(F){console.error("False alarm error:",F)}}async function w(){try{await Ws()}catch(F){console.error("Send heartbeat error:",F)}}async function R(){try{await Yl(),await h()}catch(F){console.error("Capture screenshot error:",F)}}async function I(){try{const F=await gt();t(4,f=F),_.push({time:new Date().toLocaleTimeString(),value:F.sensorReading}),_.length>Pt&&(_=_.slice(-Pt)),q()}catch(F){console.error("Status fetch error:",F)}}function O(){if(!v)return;const F=v.getContext("2d");m=new Chart(F,{type:"line",data:{labels:[],datasets:[{label:"Sensor Reading",data:[],borderColor:"#4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)",tension:.4},{label:"Threshold",data:[],borderColor:"#f44336",backgroundColor:"transparent",borderDash:[5,5],pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{color:"#ddd"},grid:{color:"#333"}},x:{ticks:{color:"#ddd"},grid:{color:"#333"}}},plugins:{legend:{labels:{color:"#ddd"}}}}})}function q(){m&&(m.data.labels=_.map(F=>F.time),m.data.datasets[0].data=_.map(F=>F.value),m.data.datasets[1].data=_.map(()=>f.threshold),m.update())}function E(){t(1,s=!0),setTimeout(()=>{r?k():h()},1e3)}async function P(){if(o)try{(document.fullscreenElement||document.webkitFullscreenElement)&&(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen&&await document.webkitExitFullscreen()),t(3,o=!1)}catch(F){console.error("Error exiting fullscreen:",F),t(3,o=!1)}else try{const F=document.documentElement;F.requestFullscreen?await F.requestFullscreen():F.webkitRequestFullscreen&&await F.webkitRequestFullscreen(),t(3,o=!0)}catch(F){console.error("Error entering fullscreen:",F),t(3,o=!0)}}function L(){!document.fullscreenElement&&!document.webkitFullscreenElement&&t(3,o=!1)}async function N(){try{const F=await Gs();t(5,p={claimed:F.claimed||!1,deviceName:F.deviceName||"",message:F.claimed?`Claimed to ${F.deviceName||"tenant"}`:F.message||"Device not claimed"})}catch(F){console.error("Claim status fetch error:",F),t(5,p={claimed:!1,deviceName:"",message:"Error loading claim status"})}}Pe(()=>{if(typeof Chart<"u")O();else{const F=document.createElement("script");F.src="https://cdn.jsdelivr.net/npm/chart.js",F.onload=()=>O(),document.head.appendChild(F)}I(),N(),u=setInterval(I,5e3),document.addEventListener("fullscreenchange",L),document.addEventListener("webkitfullscreenchange",L)}),Xe(()=>{c&&clearInterval(c),u&&clearInterval(u),m&&m.destroy(),document.removeEventListener("fullscreenchange",L),document.removeEventListener("webkitfullscreenchange",L)});function V(F){Ye[F?"unshift":"push"](()=>{v=F,t(6,v)})}return[n,s,r,o,f,p,v,h,g,y,S,C,w,R,E,P,V]}class Rt extends Se{constructor(e){super(),ye(this,e,tn,en,ge,{})}}function ln(l){let e,t;return{c(){e=d("div"),t=d("div"),a(t,"class","spinner svelte-1cznhkh"),Re(t,"width",l[0]+"px"),Re(t,"height",l[0]+"px"),Re(t,"border-color",l[1]+" transparent transparent transparent"),a(e,"class","spinner-container svelte-1cznhkh")},m(n,s){z(n,e,s),i(e,t)},p(n,[s]){s&1&&Re(t,"width",n[0]+"px"),s&1&&Re(t,"height",n[0]+"px"),s&2&&Re(t,"border-color",n[1]+" transparent transparent transparent")},i:Y,o:Y,d(n){n&&T(e)}}}function sn(l,e,t){let{size:n=40}=e,{color:s="#9fdcff"}=e;return l.$$set=r=>{"size"in r&&t(0,n=r.size),"color"in r&&t(1,s=r.color)},[n,s]}class Ne extends Se{constructor(e){super(),ye(this,e,sn,ln,ge,{size:0,color:1})}}function Nt(l){let e,t,n,s,r=l[0].message+"",o,c,u,f,p,m,v=l[0].details&&Mt(l);return{c(){e=d("div"),t=d("div"),n=d("strong"),n.textContent="âš ï¸ Error:",s=b(),o=A(r),c=b(),v&&v.c(),u=b(),f=d("button"),f.textContent="âœ•",a(t,"class","error-content svelte-1gxsq9q"),a(f,"class","dismiss-btn svelte-1gxsq9q"),a(e,"class","error-banner svelte-1gxsq9q")},m(_,h){z(_,e,h),i(e,t),i(t,n),i(t,s),i(t,o),i(t,c),v&&v.m(t,null),i(e,u),i(e,f),p||(m=M(f,"click",l[1]),p=!0)},p(_,h){h&1&&r!==(r=_[0].message+"")&&D(o,r),_[0].details?v?v.p(_,h):(v=Mt(_),v.c(),v.m(t,null)):v&&(v.d(1),v=null)},d(_){_&&T(e),v&&v.d(),p=!1,m()}}}function Mt(l){let e,t=JSON.stringify(l[0].details)+"",n;return{c(){e=d("div"),n=A(t),a(e,"class","error-details svelte-1gxsq9q")},m(s,r){z(s,e,r),i(e,n)},p(s,r){r&1&&t!==(t=JSON.stringify(s[0].details)+"")&&D(n,t)},d(s){s&&T(e)}}}function nn(l){let e,t=l[0]&&Nt(l);return{c(){t&&t.c(),e=ze()},m(n,s){t&&t.m(n,s),z(n,e,s)},p(n,[s]){n[0]?t?t.p(n,s):(t=Nt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Y,o:Y,d(n){n&&T(e),t&&t.d(n)}}}function rn(l,e,t){let{error:n=null}=e;function s(){t(0,n=null)}return l.$$set=r=>{"error"in r&&t(0,n=r.error)},[n,s]}class Xl extends Se{constructor(e){super(),ye(this,e,rn,nn,ge,{error:0})}}function jt(l,e,t){const n=l.slice();return n[25]=e[t],n[27]=t,n}function Dt(l){let e,t;return e=new Xl({props:{message:l[2]}}),{c(){ce(e.$$.fragment)},m(n,s){ie(e,n,s),t=!0},p(n,s){const r={};s&4&&(r.message=n[2]),e.$set(r)},i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){X(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function on(l){let e,t,n=Le(l[0]),s=[];for(let o=0;o<n.length;o+=1)s[o]=Ut(jt(l,n,o));const r=o=>X(s[o],1,1,()=>{s[o]=null});return{c(){e=d("div");for(let o=0;o<s.length;o+=1)s[o].c();a(e,"class","image-grid svelte-1chdln3")},m(o,c){z(o,e,c);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);t=!0},p(o,c){if(c&769){n=Le(o[0]);let u;for(u=0;u<n.length;u+=1){const f=jt(o,n,u);s[u]?(s[u].p(f,c),Q(s[u],1)):(s[u]=Ut(f),s[u].c(),Q(s[u],1),s[u].m(e,null))}for(we(),u=n.length;u<s.length;u+=1)r(u);Ce()}},i(o){if(!t){for(let c=0;c<n.length;c+=1)Q(s[c]);t=!0}},o(o){s=s.filter(Boolean);for(let c=0;c<s.length;c+=1)X(s[c]);t=!1},d(o){o&&T(e),Ge(s,o)}}}function an(l){let e,t;return e=new ke({props:{$$slots:{default:[vn]},$$scope:{ctx:l}}}),{c(){ce(e.$$.fragment)},m(n,s){ie(e,n,s),t=!0},p(n,s){const r={};s&268435456&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){X(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function cn(l){let e,t,n;return t=new Ne({}),{c(){e=d("div"),ce(t.$$.fragment),a(e,"class","loading-container svelte-1chdln3")},m(s,r){z(s,e,r),ie(t,e,null),n=!0},p:Y,i(s){n||(Q(t.$$.fragment,s),n=!0)},o(s){X(t.$$.fragment,s),n=!1},d(s){s&&T(e),oe(t)}}}function un(l){return{c:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function fn(l){let e;function t(r,o){return r[24]?pn:dn}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,o){s.m(r,o),z(r,e,o)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},i:Y,o:Y,d(r){r&&T(e),s.d(r)}}}function dn(l){let e;return{c(){e=d("div"),e.textContent="Failed to load",a(e,"class","thumbnail-error svelte-1chdln3")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function pn(l){let e,t,n;return{c(){e=d("img"),We(e.src,t=l[24])||a(e,"src",t),a(e,"alt",n=l[25].name),a(e,"class","thumbnail-image svelte-1chdln3")},m(s,r){z(s,e,r)},p(s,r){r&1&&!We(e.src,t=s[24])&&a(e,"src",t),r&1&&n!==(n=s[25].name)&&a(e,"alt",n)},d(s){s&&T(e)}}}function mn(l){let e,t,n;return t=new Ne({}),{c(){e=d("div"),ce(t.$$.fragment),a(e,"class","thumbnail-loading svelte-1chdln3")},m(s,r){z(s,e,r),ie(t,e,null),n=!0},p:Y,i(s){n||(Q(t.$$.fragment,s),n=!0)},o(s){X(t.$$.fragment,s),n=!1},d(s){s&&T(e),oe(t)}}}function Ut(l){let e,t,n,s,r,o=l[25].name+"",c,u,f,p=Wt(l[25].size)+"",m,v,_,h,k,g={ctx:l,current:null,token:null,hasCatch:!1,pending:mn,then:fn,catch:un,value:24,blocks:[,,,]};nt(t=l[8](l[25].name),g);function y(){return l[19](l[25],l[27])}return{c(){e=d("div"),g.block.c(),n=b(),s=d("div"),r=d("div"),c=A(o),u=b(),f=d("div"),m=A(p),v=b(),a(r,"class","thumbnail-filename svelte-1chdln3"),a(f,"class","thumbnail-meta svelte-1chdln3"),a(s,"class","thumbnail-info svelte-1chdln3"),a(e,"class","thumbnail-card svelte-1chdln3")},m(S,C){z(S,e,C),g.block.m(e,g.anchor=null),g.mount=()=>e,g.anchor=n,i(e,n),i(e,s),i(s,r),i(r,c),i(s,u),i(s,f),i(f,m),i(e,v),_=!0,h||(k=M(e,"click",y),h=!0)},p(S,C){l=S,g.ctx=l,C&1&&t!==(t=l[8](l[25].name))&&nt(t,g)||Wl(g,l,C),(!_||C&1)&&o!==(o=l[25].name+"")&&D(c,o),(!_||C&1)&&p!==(p=Wt(l[25].size)+"")&&D(m,p)},i(S){_||(Q(g.block),_=!0)},o(S){for(let C=0;C<3;C+=1){const w=g.blocks[C];X(w)}_=!1},d(S){S&&T(e),g.block.d(),g.token=null,g=null,h=!1,k()}}}function vn(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1chdln3">No captures yet</p> <p class="empty-hint svelte-1chdln3">Captured images will appear here</p>',a(e,"class","empty-state svelte-1chdln3")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function Ht(l){let e,t,n,s,r,o=l[3].name+"",c,u,f,p=Bt(l[3].timestamp)+"",m,v,_,h,k,g,y,S,C,w,R,I,O,q,E=l[4]+1+"",P,L,N=l[0].length+"",V,F,B,j,J,K,$,se,re,ne,te,fe,x,H={ctx:l,current:null,token:null,hasCatch:!1,pending:kn,then:bn,catch:_n,value:24,blocks:[,,,]};return nt(g=l[8](l[3].name),H),{c(){e=d("div"),t=d("div"),n=d("div"),s=d("div"),r=d("div"),c=A(o),u=b(),f=d("div"),m=A(p),v=b(),_=d("button"),_.textContent="Ã—",h=b(),k=d("div"),H.block.c(),y=b(),S=d("div"),C=d("div"),w=d("button"),R=A("â† Previous"),O=b(),q=d("span"),P=A(E),L=A(" / "),V=A(N),F=b(),B=d("button"),j=A("Next â†’"),K=b(),$=d("div"),se=d("button"),se.textContent="Download",re=b(),ne=d("button"),ne.textContent="Delete",a(r,"class","modal-filename svelte-1chdln3"),a(f,"class","modal-timestamp svelte-1chdln3"),a(s,"class","modal-title svelte-1chdln3"),a(_,"class","modal-close svelte-1chdln3"),a(n,"class","modal-header svelte-1chdln3"),a(k,"class","modal-body svelte-1chdln3"),a(w,"class","nav-btn svelte-1chdln3"),w.disabled=I=l[4]===0,a(q,"class","image-counter svelte-1chdln3"),a(B,"class","nav-btn svelte-1chdln3"),B.disabled=J=l[4]===l[0].length-1,a(C,"class","modal-nav svelte-1chdln3"),a(se,"class","action-btn svelte-1chdln3"),a(ne,"class","action-btn delete-btn svelte-1chdln3"),a($,"class","modal-actions svelte-1chdln3"),a(S,"class","modal-footer svelte-1chdln3"),a(t,"class","modal-content svelte-1chdln3"),a(e,"class","modal-backdrop svelte-1chdln3")},m(Z,U){z(Z,e,U),i(e,t),i(t,n),i(n,s),i(s,r),i(r,c),i(s,u),i(s,f),i(f,m),i(n,v),i(n,_),i(t,h),i(t,k),H.block.m(k,H.anchor=null),H.mount=()=>k,H.anchor=null,i(t,y),i(t,S),i(S,C),i(C,w),i(w,R),i(C,O),i(C,q),i(q,P),i(q,L),i(q,V),i(C,F),i(C,B),i(B,j),i(S,K),i(S,$),i($,se),i($,re),i($,ne),te=!0,fe||(x=[M(_,"click",l[10]),M(w,"click",l[11]),M(B,"click",l[12]),M(se,"click",l[20]),M(ne,"click",l[21]),M(t,"click",Bl(l[18])),M(e,"click",l[10])],fe=!0)},p(Z,U){l=Z,(!te||U&8)&&o!==(o=l[3].name+"")&&D(c,o),(!te||U&8)&&p!==(p=Bt(l[3].timestamp)+"")&&D(m,p),H.ctx=l,U&8&&g!==(g=l[8](l[3].name))&&nt(g,H)||Wl(H,l,U),(!te||U&16&&I!==(I=l[4]===0))&&(w.disabled=I),(!te||U&16)&&E!==(E=l[4]+1+"")&&D(P,E),(!te||U&1)&&N!==(N=l[0].length+"")&&D(V,N),(!te||U&17&&J!==(J=l[4]===l[0].length-1))&&(B.disabled=J)},i(Z){te||(Q(H.block),te=!0)},o(Z){for(let U=0;U<3;U+=1){const G=H.blocks[U];X(G)}te=!1},d(Z){Z&&T(e),H.block.d(),H.token=null,H=null,fe=!1,de(x)}}}function _n(l){return{c:Y,m:Y,p:Y,i:Y,o:Y,d:Y}}function bn(l){let e;function t(r,o){return r[24]?gn:hn}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,o){s.m(r,o),z(r,e,o)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},i:Y,o:Y,d(r){r&&T(e),s.d(r)}}}function hn(l){let e;return{c(){e=d("div"),e.textContent="Failed to load image",a(e,"class","modal-error svelte-1chdln3")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function gn(l){let e,t,n;return{c(){e=d("img"),We(e.src,t=l[24])||a(e,"src",t),a(e,"alt",n=l[3].name),a(e,"class","modal-image svelte-1chdln3")},m(s,r){z(s,e,r)},p(s,r){r&8&&!We(e.src,t=s[24])&&a(e,"src",t),r&8&&n!==(n=s[3].name)&&a(e,"alt",n)},d(s){s&&T(e)}}}function kn(l){let e,t;return e=new Ne({}),{c(){ce(e.$$.fragment)},m(n,s){ie(e,n,s),t=!0},p:Y,i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){X(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Vt(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k;return{c(){e=d("div"),t=d("div"),n=d("h3"),n.textContent="Confirm Delete",s=b(),r=d("p"),o=A("Are you sure you want to delete "),c=A(l[6]),u=A("?"),f=b(),p=d("div"),m=d("button"),m.textContent="Cancel",v=b(),_=d("button"),_.textContent="Delete",a(n,"class","svelte-1chdln3"),a(r,"class","svelte-1chdln3"),a(m,"class","confirm-btn cancel-btn svelte-1chdln3"),a(_,"class","confirm-btn delete-confirm-btn svelte-1chdln3"),a(p,"class","confirm-actions svelte-1chdln3"),a(t,"class","confirm-dialog svelte-1chdln3"),a(e,"class","confirm-backdrop svelte-1chdln3")},m(g,y){z(g,e,y),i(e,t),i(t,n),i(t,s),i(t,r),i(r,o),i(r,c),i(r,u),i(t,f),i(t,p),i(p,m),i(p,v),i(p,_),h||(k=[M(m,"click",l[16]),M(_,"click",l[15]),M(t,"click",Bl(l[17])),M(e,"click",l[16])],h=!0)},p(g,y){y&64&&D(c,g[6])},d(g){g&&T(e),h=!1,de(k)}}}function wn(l){let e,t,n,s,r,o=l[1]?"Loading...":"Refresh",c,u,f,p,m,v,_,h,k,g,y,S=l[2]&&Dt(l);const C=[cn,an,on],w=[];function R(q,E){return q[1]?0:q[0].length===0?1:2}p=R(l),m=w[p]=C[p](l);let I=l[3]&&Ht(l),O=l[5]&&Vt(l);return{c(){e=d("div"),t=d("div"),n=d("h1"),n.textContent="Image Gallery",s=b(),r=d("button"),c=A(o),u=b(),S&&S.c(),f=b(),m.c(),v=b(),I&&I.c(),_=b(),O&&O.c(),h=ze(),a(n,"class","svelte-1chdln3"),a(r,"class","refresh-btn svelte-1chdln3"),r.disabled=l[1],a(t,"class","header svelte-1chdln3"),a(e,"class","gallery-container svelte-1chdln3")},m(q,E){z(q,e,E),i(e,t),i(t,n),i(t,s),i(t,r),i(r,c),i(e,u),S&&S.m(e,null),i(e,f),w[p].m(e,null),z(q,v,E),I&&I.m(q,E),z(q,_,E),O&&O.m(q,E),z(q,h,E),k=!0,g||(y=M(r,"click",l[7]),g=!0)},p(q,[E]){(!k||E&2)&&o!==(o=q[1]?"Loading...":"Refresh")&&D(c,o),(!k||E&2)&&(r.disabled=q[1]),q[2]?S?(S.p(q,E),E&4&&Q(S,1)):(S=Dt(q),S.c(),Q(S,1),S.m(e,f)):S&&(we(),X(S,1,1,()=>{S=null}),Ce());let P=p;p=R(q),p===P?w[p].p(q,E):(we(),X(w[P],1,1,()=>{w[P]=null}),Ce(),m=w[p],m?m.p(q,E):(m=w[p]=C[p](q),m.c()),Q(m,1),m.m(e,null)),q[3]?I?(I.p(q,E),E&8&&Q(I,1)):(I=Ht(q),I.c(),Q(I,1),I.m(_.parentNode,_)):I&&(we(),X(I,1,1,()=>{I=null}),Ce()),q[5]?O?O.p(q,E):(O=Vt(q),O.c(),O.m(h.parentNode,h)):O&&(O.d(1),O=null)},i(q){k||(Q(S),Q(m),Q(I),k=!0)},o(q){X(S),X(m),X(I),k=!1},d(q){q&&(T(e),T(v),T(_),T(h)),S&&S.d(),w[p].d(),I&&I.d(q),O&&O.d(q),g=!1,y()}}}function Bt(l){return new Date(l).toLocaleString()}function Wt(l){return l<1024?l+" B":l<1024*1024?(l/1024).toFixed(1)+" KB":(l/(1024*1024)).toFixed(1)+" MB"}function Cn(l,e,t){let n=[],s=!0,r=null,o=null,c=-1,u={},f=!1,p=null;Pe(()=>{m(),document.addEventListener("keydown",k)}),Xe(()=>{document.removeEventListener("keydown",k),Object.values(u).forEach(L=>URL.revokeObjectURL(L))});async function m(){t(1,s=!0),t(2,r=null);try{const L=await Ts();t(0,n=L.files||[]),n.sort((N,V)=>V.name.localeCompare(N.name))}catch(L){t(2,r=L.message||"Failed to load gallery")}finally{t(1,s=!1)}}async function v(L){if(u[L])return u[L];try{const N=Lt(L);return u[L]=N,N}catch(N){return console.error("Failed to load image:",N),null}}async function _(L,N){t(3,o=L),t(4,c=N),await v(L.name)}function h(){t(3,o=null),t(4,c=-1),t(5,f=!1),t(6,p=null)}function k(L){o&&(L.key==="Escape"?h():L.key==="ArrowLeft"?g():L.key==="ArrowRight"&&y())}function g(){c>0&&(t(4,c--,c),t(3,o=n[c]),v(o.name))}function y(){c<n.length-1&&(t(4,c++,c),t(3,o=n[c]),v(o.name))}async function S(L){try{const N=Lt(L),F=await(await fetch(N)).blob(),B=URL.createObjectURL(F),j=document.createElement("a");j.href=B,j.download=L,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(B)}catch(N){console.error("Failed to download image:",N),alert("Failed to download image")}}function C(L){t(6,p=L),t(5,f=!0)}async function w(){if(p)try{await zs(p),u[p]&&(URL.revokeObjectURL(u[p]),delete u[p]),t(0,n=n.filter(L=>L.name!==p)),o&&o.name===p&&h(),t(5,f=!1),t(6,p=null)}catch(L){console.error("Failed to delete image:",L),alert("Failed to delete image")}}function R(){t(5,f=!1),t(6,p=null)}function I(L){wt.call(this,l,L)}function O(L){wt.call(this,l,L)}return[n,s,r,o,c,f,p,m,v,_,h,g,y,S,C,w,R,I,O,(L,N)=>_(L,N),()=>S(o.name),()=>C(o.name)]}class yn extends Se{constructor(e){super(),ye(this,e,Cn,wn,ge,{})}}function Gt(l){let e,t;return{c(){e=d("div"),t=A(l[5]),a(e,"class","message svelte-1iken05"),W(e,"success",l[6]==="success"),W(e,"error",l[6]==="error")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s&32&&D(t,n[5]),s&64&&W(e,"success",n[6]==="success"),s&64&&W(e,"error",n[6]==="error")},d(n){n&&T(e)}}}function Sn(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k,g,y,S,C,w,R,I,O,q,E,P,L,N,V,F,B,j,J,K,$,se,re,ne,te,fe,x;return{c(){e=d("div"),t=d("div"),n=d("label"),n.textContent="False-Alarm Offset:",s=b(),r=d("span"),o=A(l[0]),c=A(" mm"),u=b(),f=d("div"),p=d("label"),p.textContent="Current Threshold:",m=b(),v=d("span"),_=A(l[1]),h=A(" mm"),k=b(),g=d("div"),y=d("label"),y.textContent="Calibration Offset:",S=b(),C=d("div"),w=d("input"),R=b(),I=d("span"),O=A(l[2]),q=A(" mm"),E=b(),P=d("div"),L=d("label"),L.textContent="Override Threshold (mm):",N=b(),V=d("input"),F=b(),B=d("div"),j=d("button"),J=A("ðŸ’¾ Save"),K=b(),$=d("button"),se=A("ðŸ—‘ï¸ Clear Override"),re=b(),ne=d("button"),te=A("ðŸ”„ Recalibrate"),a(n,"class","svelte-1iken05"),a(r,"class","value svelte-1iken05"),a(t,"class","info-row svelte-1iken05"),a(p,"class","svelte-1iken05"),a(v,"class","value svelte-1iken05"),a(f,"class","info-row svelte-1iken05"),a(y,"for","calib-offset"),a(y,"class","svelte-1iken05"),a(w,"id","calib-offset"),a(w,"type","range"),a(w,"min","-100"),a(w,"max","100"),a(w,"step","1"),a(w,"class","slider svelte-1iken05"),w.disabled=l[4],a(I,"class","slider-value svelte-1iken05"),a(C,"class","slider-row svelte-1iken05"),a(g,"class","control-group svelte-1iken05"),a(L,"for","override-th"),a(L,"class","svelte-1iken05"),a(V,"id","override-th"),a(V,"type","number"),a(V,"placeholder",""),a(V,"min","0"),a(V,"class","input-field svelte-1iken05"),V.disabled=l[4],a(P,"class","control-group svelte-1iken05"),a(j,"class","btn btn-save svelte-1iken05"),j.disabled=l[4],a($,"class","btn btn-clear svelte-1iken05"),$.disabled=l[4],a(ne,"class","btn btn-recal svelte-1iken05"),ne.disabled=l[4],a(B,"class","button-group svelte-1iken05"),a(e,"class","content svelte-1iken05")},m(H,Z){z(H,e,Z),i(e,t),i(t,n),i(t,s),i(t,r),i(r,o),i(r,c),i(e,u),i(e,f),i(f,p),i(f,m),i(f,v),i(v,_),i(v,h),i(e,k),i(e,g),i(g,y),i(g,S),i(g,C),i(C,w),ee(w,l[2]),i(C,R),i(C,I),i(I,O),i(I,q),i(e,E),i(e,P),i(P,L),i(P,N),i(P,V),ee(V,l[3]),i(e,F),i(e,B),i(B,j),i(j,J),i(B,K),i(B,$),i($,se),i(B,re),i(B,ne),i(ne,te),fe||(x=[M(w,"change",l[10]),M(w,"input",l[10]),M(V,"input",l[11]),M(j,"click",l[7]),M($,"click",l[8]),M(ne,"click",l[9])],fe=!0)},p(H,Z){Z&1&&D(o,H[0]),Z&2&&D(_,H[1]),Z&16&&(w.disabled=H[4]),Z&4&&ee(w,H[2]),Z&4&&D(O,H[2]),Z&16&&(V.disabled=H[4]),Z&8&&Fe(V.value)!==H[3]&&ee(V,H[3]),Z&16&&(j.disabled=H[4]),Z&16&&($.disabled=H[4]),Z&16&&(ne.disabled=H[4])},d(H){H&&T(e),fe=!1,de(x)}}}function Tn(l){let e,t,n,s,r,o,c=l[5]&&Gt(l);return r=new ke({props:{title:"",$$slots:{default:[Sn]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Calibration Settings",n=b(),c&&c.c(),s=b(),ce(r.$$.fragment),a(t,"class","svelte-1iken05"),a(e,"class","page svelte-1iken05")},m(u,f){z(u,e,f),i(e,t),i(e,n),c&&c.m(e,null),i(e,s),ie(r,e,null),o=!0},p(u,[f]){u[5]?c?c.p(u,f):(c=Gt(u),c.c(),c.m(e,s)):c&&(c.d(1),c=null);const p={};f&16415&&(p.$$scope={dirty:f,ctx:u}),r.$set(p)},i(u){o||(Q(r.$$.fragment,u),o=!0)},o(u){X(r.$$.fragment,u),o=!1},d(u){u&&T(e),c&&c.d(),oe(r)}}}function zn(l,e,t){let n=0,s=0,r=0,o="",c=!1,u="",f="";Pe(()=>{p();const g=localStorage.getItem("calibrationOffset");g!==null&&t(2,r=parseInt(g))});async function p(){try{const g=await gt();t(1,s=g.threshold||0),t(0,n=g.falseAlarmOffset||0),g.calibrationOffset!==void 0&&(t(2,r=g.calibrationOffset),localStorage.setItem("calibrationOffset",r.toString())),g.overrideThreshold!==void 0&&g.overrideThreshold>0?t(3,o=g.overrideThreshold.toString()):t(3,o="")}catch(g){console.warn("Failed to load status:",g)}}async function m(){t(4,c=!0),t(5,u="");try{await qs(r),localStorage.setItem("calibrationOffset",r.toString()),o&&parseInt(o)>0?(await As(parseInt(o)),t(5,u="Calibration offset and override threshold saved")):t(5,u="Calibration offset saved"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(g){t(5,u=`Failed to save: ${g.message||g}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,c=!1)}}async function v(){t(4,c=!0),t(5,u="");try{await Ls(),t(3,o=""),t(5,u="Override cleared"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(g){t(5,u=`Failed to clear override: ${g.message||g}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,c=!1)}}async function _(){t(4,c=!0),t(5,u="");try{await Es(),t(5,u="Re-calibration started"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(g){t(5,u=`Failed to recalibrate: ${g.message||g}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,c=!1)}}function h(){r=Fe(this.value),t(2,r)}function k(){o=Fe(this.value),t(3,o)}return[n,s,r,o,c,u,f,m,v,_,h,k]}class qn extends Se{constructor(e){super(),ye(this,e,zn,Tn,ge,{})}}function Jt(l){let e,t;return{c(){e=d("div"),t=A(l[6]),a(e,"class","message svelte-1lrtwwl"),W(e,"success",l[7]==="success"),W(e,"error",l[7]==="error")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s&64&&D(t,n[6]),s&128&&W(e,"success",n[7]==="success"),s&128&&W(e,"error",n[7]==="error")},d(n){n&&T(e)}}}function An(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k,g,y,S,C,w,R,I,O,q,E,P,L,N,V,F,B,j,J,K,$=l[4]?"Saving...":"Save",se,re,ne,te=l[5]?"Testing...":"Test Servo",fe,x,H,Z;return{c(){e=d("div"),t=d("div"),n=d("label"),n.textContent="Start Position (Âµs):",s=b(),r=d("input"),o=b(),c=d("button"),u=A("Set"),f=b(),p=d("div"),m=d("label"),m.textContent="End Position (Âµs):",v=b(),_=d("input"),h=b(),k=d("button"),g=A("Set"),y=b(),S=d("div"),C=d("input"),w=b(),R=d("label"),R.textContent="Disable Servo",I=b(),O=d("div"),q=d("h3"),q.textContent="Live Control",E=b(),P=d("div"),L=d("input"),N=b(),V=d("div"),F=A(l[3]),B=A(" Âµs"),j=b(),J=d("div"),K=d("button"),se=A($),re=b(),ne=d("button"),fe=A(te),a(n,"for","start-pos"),a(n,"class","svelte-1lrtwwl"),a(r,"id","start-pos"),a(r,"type","number"),a(r,"min","500"),a(r,"max","2500"),a(r,"step","10"),a(r,"class","svelte-1lrtwwl"),a(c,"class","btn btn-set svelte-1lrtwwl"),c.disabled=l[2],a(t,"class","position-row svelte-1lrtwwl"),a(m,"for","end-pos"),a(m,"class","svelte-1lrtwwl"),a(_,"id","end-pos"),a(_,"type","number"),a(_,"min","500"),a(_,"max","2500"),a(_,"step","10"),a(_,"class","svelte-1lrtwwl"),a(k,"class","btn btn-set svelte-1lrtwwl"),k.disabled=l[2],a(p,"class","position-row svelte-1lrtwwl"),a(C,"id","disable-servo"),a(C,"type","checkbox"),a(C,"class","svelte-1lrtwwl"),a(R,"for","disable-servo"),a(R,"class","svelte-1lrtwwl"),a(S,"class","checkbox-row svelte-1lrtwwl"),a(q,"class","svelte-1lrtwwl"),a(L,"type","range"),a(L,"min","500"),a(L,"max","2500"),a(L,"step","10"),L.disabled=l[2],a(L,"class","position-slider svelte-1lrtwwl"),a(V,"class","slider-value svelte-1lrtwwl"),a(P,"class","slider-container svelte-1lrtwwl"),a(O,"class","live-control svelte-1lrtwwl"),a(K,"class","btn btn-save svelte-1lrtwwl"),K.disabled=l[4],a(ne,"class","btn btn-test svelte-1lrtwwl"),ne.disabled=x=l[5]||l[2],a(J,"class","button-group svelte-1lrtwwl"),a(e,"class","settings-content svelte-1lrtwwl")},m(U,G){z(U,e,G),i(e,t),i(t,n),i(t,s),i(t,r),ee(r,l[0]),i(t,o),i(t,c),i(c,u),i(e,f),i(e,p),i(p,m),i(p,v),i(p,_),ee(_,l[1]),i(p,h),i(p,k),i(k,g),i(e,y),i(e,S),i(S,C),C.checked=l[2],i(S,w),i(S,R),i(e,I),i(e,O),i(O,q),i(O,E),i(O,P),i(P,L),ee(L,l[3]),i(P,N),i(P,V),i(V,F),i(V,B),i(e,j),i(e,J),i(J,K),i(K,se),i(J,re),i(J,ne),i(ne,fe),H||(Z=[M(r,"input",l[12]),M(c,"click",l[13]),M(_,"input",l[14]),M(k,"click",l[15]),M(C,"change",l[16]),M(L,"change",l[17]),M(L,"input",l[17]),M(L,"input",l[11]),M(K,"click",l[9]),M(ne,"click",l[10])],H=!0)},p(U,G){G&1&&Fe(r.value)!==U[0]&&ee(r,U[0]),G&4&&(c.disabled=U[2]),G&2&&Fe(_.value)!==U[1]&&ee(_,U[1]),G&4&&(k.disabled=U[2]),G&4&&(C.checked=U[2]),G&4&&(L.disabled=U[2]),G&8&&ee(L,U[3]),G&8&&D(F,U[3]),G&16&&$!==($=U[4]?"Saving...":"Save")&&D(se,$),G&16&&(K.disabled=U[4]),G&32&&te!==(te=U[5]?"Testing...":"Test Servo")&&D(fe,te),G&36&&x!==(x=U[5]||U[2])&&(ne.disabled=x)},d(U){U&&T(e),H=!1,de(Z)}}}function Ln(l){let e,t,n,s,r,o,c=l[6]&&Jt(l);return r=new ke({props:{title:"",$$slots:{default:[An]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Servo Settings",n=b(),c&&c.c(),s=b(),ce(r.$$.fragment),a(t,"class","svelte-1lrtwwl"),a(e,"class","page svelte-1lrtwwl")},m(u,f){z(u,e,f),i(e,t),i(e,n),c&&c.m(e,null),i(e,s),ie(r,e,null),o=!0},p(u,[f]){u[6]?c?c.p(u,f):(c=Jt(u),c.c(),c.m(e,s)):c&&(c.d(1),c=null);const p={};f&524351&&(p.$$scope={dirty:f,ctx:u}),r.$set(p)},i(u){o||(Q(r.$$.fragment,u),o=!0)},o(u){X(r.$$.fragment,u),o=!1},d(u){u&&T(e),c&&c.d(),oe(r)}}}function En(l,e,t){let n=1500,s=1100,r=!1,o=1500,c=!1,u=!1,f="",p="";async function m(){try{const I=await Is();I.startUS!==void 0&&t(0,n=I.startUS),I.endUS!==void 0&&t(1,s=I.endUS);const O=localStorage.getItem("disableServo");O!==null?t(2,r=O==="true"):I.disabled!==void 0&&t(2,r=I.disabled),t(3,o=n)}catch(I){console.warn("Failed to load servo settings:",I)}}async function v(I,O){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}try{await fetch(`/servoSet?val=${I}`),t(6,f=`${O} set to ${I}Âµs`),t(7,p="success"),setTimeout(()=>{t(6,f="")},2e3)}catch{t(6,f=`Failed to set ${O}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}}async function _(){t(4,c=!0),t(6,f="");try{await Os({startUS:n,endUS:s,disabled:r}),localStorage.setItem("disableServo",r.toString()),t(6,f="Settings saved successfully"),t(7,p="success"),setTimeout(()=>{t(6,f="")},3e3)}catch(I){t(6,f=`Failed to save: ${I.message}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}finally{t(4,c=!1)}}async function h(){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}t(5,u=!0),t(6,f="");try{await Kl(),t(6,f="Servo triggered"),t(7,p="success"),setTimeout(()=>{t(6,f="")},2e3)}catch(I){t(6,f=`Failed to trigger servo: ${I.message}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}finally{t(5,u=!1)}}function k(){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}try{fetch(`/servoSet?val=${o}`)}catch(I){console.error("Failed to update live position:",I)}}Pe(()=>{m()});function g(){n=Fe(this.value),t(0,n)}const y=()=>v(n,"Start position");function S(){s=Fe(this.value),t(1,s)}const C=()=>v(s,"End position");function w(){r=this.checked,t(2,r)}function R(){o=Fe(this.value),t(3,o)}return[n,s,r,o,c,u,f,p,v,_,h,k,g,y,S,C,w,R]}class Fn extends Se{constructor(e){super(),ye(this,e,En,Ln,ge,{})}}function In(l){let e,t,n,s,r,o,c;return t=new ke({props:{title:"IP Filtering",$$slots:{default:[Rn]},$$scope:{ctx:l}}}),s=new ke({props:{title:"MQTT Configuration",$$slots:{default:[Nn]},$$scope:{ctx:l}}}),o=new ke({props:{title:"Video Mode",$$slots:{default:[Mn]},$$scope:{ctx:l}}}),{c(){e=d("div"),ce(t.$$.fragment),n=b(),ce(s.$$.fragment),r=b(),ce(o.$$.fragment),a(e,"class","settings-grid svelte-dlnskf")},m(u,f){z(u,e,f),ie(t,e,null),i(e,n),ie(s,e,null),i(e,r),ie(o,e,null),c=!0},p(u,f){const p={};f[0]&124|f[1]&128&&(p.$$scope={dirty:f,ctx:u}),t.$set(p);const m={};f[0]&130944|f[1]&128&&(m.$$scope={dirty:f,ctx:u}),s.$set(m);const v={};f[0]&917504|f[1]&128&&(v.$$scope={dirty:f,ctx:u}),o.$set(v)},i(u){c||(Q(t.$$.fragment,u),Q(s.$$.fragment,u),Q(o.$$.fragment,u),c=!0)},o(u){X(t.$$.fragment,u),X(s.$$.fragment,u),X(o.$$.fragment,u),c=!1},d(u){u&&T(e),oe(t),oe(s),oe(o)}}}function On(l){let e,t;return e=new Xl({props:{message:l[1],onRetry:l[20]}}),{c(){ce(e.$$.fragment)},m(n,s){ie(e,n,s),t=!0},p(n,s){const r={};s[0]&2&&(r.message=n[1]),e.$set(r)},i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){X(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Pn(l){let e,t,n;return t=new Ne({}),{c(){e=d("div"),ce(t.$$.fragment),a(e,"class","loading-container svelte-dlnskf")},m(s,r){z(s,e,r),ie(t,e,null),n=!0},p:Y,i(s){n||(Q(t.$$.fragment,s),n=!0)},o(s){X(t.$$.fragment,s),n=!1},d(s){s&&T(e),oe(t)}}}function Qt(l){let e,t,n,s;return{c(){e=d("div"),t=A("Your IP: "),n=d("span"),s=A(l[4]),a(n,"class","client-ip svelte-dlnskf"),a(e,"class","info-text svelte-dlnskf")},m(r,o){z(r,e,o),i(e,t),i(e,n),i(n,s)},p(r,o){o[0]&16&&D(s,r[4])},d(r){r&&T(e)}}}function Kt(l){let e,t;return{c(){e=d("div"),t=A(l[5]),a(e,"class","error-text svelte-dlnskf")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s[0]&32&&D(t,n[5])},d(n){n&&T(e)}}}function Rn(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k,g,y,S,C=l[6]?"Saving...":"Save IP Filters",w,R,I,O=l[4]&&Qt(l),q=l[5]&&Kt(l);return{c(){e=d("div"),O&&O.c(),t=b(),n=d("div"),s=d("label"),s.textContent="Whitelist (comma-separated CIDRs)",r=b(),o=d("input"),c=b(),u=d("div"),u.textContent="Leave empty to allow all IPs",f=b(),p=d("div"),m=d("label"),m.textContent="Blacklist (comma-separated CIDRs)",v=b(),_=d("input"),h=b(),k=d("div"),k.textContent="Blocked IPs take precedence over whitelist",g=b(),q&&q.c(),y=b(),S=d("button"),w=A(C),a(s,"for","whitelist"),a(s,"class","svelte-dlnskf"),a(o,"id","whitelist"),a(o,"type","text"),a(o,"placeholder","192.168.1.0/24, 10.0.0.1"),o.disabled=l[6],a(o,"class","svelte-dlnskf"),a(u,"class","help-text svelte-dlnskf"),a(n,"class","form-group svelte-dlnskf"),a(m,"for","blacklist"),a(m,"class","svelte-dlnskf"),a(_,"id","blacklist"),a(_,"type","text"),a(_,"placeholder","192.168.99.0/24, 172.16.0.1"),_.disabled=l[6],a(_,"class","svelte-dlnskf"),a(k,"class","help-text svelte-dlnskf"),a(p,"class","form-group svelte-dlnskf"),a(S,"class","btn-primary svelte-dlnskf"),S.disabled=l[6],a(e,"class","form-section svelte-dlnskf")},m(E,P){z(E,e,P),O&&O.m(e,null),i(e,t),i(e,n),i(n,s),i(n,r),i(n,o),ee(o,l[2]),i(n,c),i(n,u),i(e,f),i(e,p),i(p,m),i(p,v),i(p,_),ee(_,l[3]),i(p,h),i(p,k),i(e,g),q&&q.m(e,null),i(e,y),i(e,S),i(S,w),R||(I=[M(o,"input",l[25]),M(_,"input",l[26]),M(S,"click",l[21])],R=!0)},p(E,P){E[4]?O?O.p(E,P):(O=Qt(E),O.c(),O.m(e,t)):O&&(O.d(1),O=null),P[0]&64&&(o.disabled=E[6]),P[0]&4&&o.value!==E[2]&&ee(o,E[2]),P[0]&64&&(_.disabled=E[6]),P[0]&8&&_.value!==E[3]&&ee(_,E[3]),E[5]?q?q.p(E,P):(q=Kt(E),q.c(),q.m(e,y)):q&&(q.d(1),q=null),P[0]&64&&C!==(C=E[6]?"Saving...":"Save IP Filters")&&D(w,C),P[0]&64&&(S.disabled=E[6])},d(E){E&&T(e),O&&O.d(),q&&q.d(),R=!1,de(I)}}}function Yt(l){let e,t;return{c(){e=d("div"),t=A(l[14]),a(e,"class","error-text svelte-dlnskf")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s[0]&16384&&D(t,n[14])},d(n){n&&T(e)}}}function Nn(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k,g,y,S,C,w,R,I,O,q,E,P,L,N,V,F,B,j,J,K,$=l[13]?"Hide":"Show",se,re,ne,te,fe,x,H,Z,U,G,qe,Ae,Me=l[15]?"Saving...":"Save MQTT Config",je,Je,pe,ve=l[16]?"Testing...":"Test Connection",be,_e,ae,he,Te=l[14]&&Yt(l);return{c(){e=d("div"),t=d("div"),n=d("label"),s=d("input"),r=b(),o=d("span"),o.textContent="Enable MQTT",c=b(),u=d("div"),f=d("label"),f.textContent="Broker Address",p=b(),m=d("input"),_=b(),h=d("div"),k=d("label"),k.textContent="Port",g=b(),y=d("input"),C=b(),w=d("div"),R=d("label"),R.textContent="Username",I=b(),O=d("input"),E=b(),P=d("div"),L=d("label"),L.textContent="Password",N=b(),V=d("div"),F=d("input"),J=b(),K=d("button"),se=A($),ne=b(),te=d("div"),fe=d("label"),fe.textContent="Topic Prefix",x=b(),H=d("input"),U=b(),Te&&Te.c(),G=b(),qe=d("div"),Ae=d("button"),je=A(Me),Je=b(),pe=d("button"),be=A(ve),a(s,"type","checkbox"),s.disabled=l[15],a(s,"class","svelte-dlnskf"),a(o,"class","svelte-dlnskf"),a(n,"class","svelte-dlnskf"),a(t,"class","form-group checkbox-group svelte-dlnskf"),a(f,"for","mqtt-broker"),a(f,"class","svelte-dlnskf"),a(m,"id","mqtt-broker"),a(m,"type","text"),a(m,"placeholder","mqtt.example.com"),m.disabled=v=l[15]||!l[12],a(m,"class","svelte-dlnskf"),a(u,"class","form-group svelte-dlnskf"),a(k,"for","mqtt-port"),a(k,"class","svelte-dlnskf"),a(y,"id","mqtt-port"),a(y,"type","number"),a(y,"placeholder","1883"),a(y,"min","1"),a(y,"max","65535"),y.disabled=S=l[15]||!l[12],a(y,"class","svelte-dlnskf"),a(h,"class","form-group svelte-dlnskf"),a(R,"for","mqtt-user"),a(R,"class","svelte-dlnskf"),a(O,"id","mqtt-user"),a(O,"type","text"),a(O,"placeholder","Optional"),O.disabled=q=l[15]||!l[12],a(O,"class","svelte-dlnskf"),a(w,"class","form-group svelte-dlnskf"),a(L,"for","mqtt-password"),a(L,"class","svelte-dlnskf"),a(F,"id","mqtt-password"),a(F,"type",B=l[13]?"text":"password"),F.value=l[10],a(F,"placeholder","Optional"),F.disabled=j=l[15]||!l[12],a(F,"class","svelte-dlnskf"),a(K,"type","button"),a(K,"class","toggle-password svelte-dlnskf"),K.disabled=re=!l[12],a(V,"class","password-input-group svelte-dlnskf"),a(P,"class","form-group svelte-dlnskf"),a(fe,"for","mqtt-topic"),a(fe,"class","svelte-dlnskf"),a(H,"id","mqtt-topic"),a(H,"type","text"),a(H,"placeholder","mousetrap"),H.disabled=Z=l[15]||!l[12],a(H,"class","svelte-dlnskf"),a(te,"class","form-group svelte-dlnskf"),a(Ae,"class","btn-primary svelte-dlnskf"),Ae.disabled=l[15],a(pe,"class","btn-secondary svelte-dlnskf"),pe.disabled=_e=l[16]||!l[12]||!l[7],a(qe,"class","button-group svelte-dlnskf"),a(e,"class","form-section svelte-dlnskf")},m(le,me){z(le,e,me),i(e,t),i(t,n),i(n,s),s.checked=l[12],i(n,r),i(n,o),i(e,c),i(e,u),i(u,f),i(u,p),i(u,m),ee(m,l[7]),i(e,_),i(e,h),i(h,k),i(h,g),i(h,y),ee(y,l[8]),i(e,C),i(e,w),i(w,R),i(w,I),i(w,O),ee(O,l[9]),i(e,E),i(e,P),i(P,L),i(P,N),i(P,V),i(V,F),i(V,J),i(V,K),i(K,se),i(e,ne),i(e,te),i(te,fe),i(te,x),i(te,H),ee(H,l[11]),i(e,U),Te&&Te.m(e,null),i(e,G),i(e,qe),i(qe,Ae),i(Ae,je),i(qe,Je),i(qe,pe),i(pe,be),ae||(he=[M(s,"change",l[27]),M(m,"input",l[28]),M(y,"input",l[29]),M(O,"input",l[30]),M(F,"input",l[31]),M(K,"click",l[32]),M(H,"input",l[33]),M(Ae,"click",l[22]),M(pe,"click",l[23])],ae=!0)},p(le,me){me[0]&32768&&(s.disabled=le[15]),me[0]&4096&&(s.checked=le[12]),me[0]&36864&&v!==(v=le[15]||!le[12])&&(m.disabled=v),me[0]&128&&m.value!==le[7]&&ee(m,le[7]),me[0]&36864&&S!==(S=le[15]||!le[12])&&(y.disabled=S),me[0]&256&&Fe(y.value)!==le[8]&&ee(y,le[8]),me[0]&36864&&q!==(q=le[15]||!le[12])&&(O.disabled=q),me[0]&512&&O.value!==le[9]&&ee(O,le[9]),me[0]&8192&&B!==(B=le[13]?"text":"password")&&a(F,"type",B),me[0]&1024&&F.value!==le[10]&&(F.value=le[10]),me[0]&36864&&j!==(j=le[15]||!le[12])&&(F.disabled=j),me[0]&8192&&$!==($=le[13]?"Hide":"Show")&&D(se,$),me[0]&4096&&re!==(re=!le[12])&&(K.disabled=re),me[0]&36864&&Z!==(Z=le[15]||!le[12])&&(H.disabled=Z),me[0]&2048&&H.value!==le[11]&&ee(H,le[11]),le[14]?Te?Te.p(le,me):(Te=Yt(le),Te.c(),Te.m(e,G)):Te&&(Te.d(1),Te=null),me[0]&32768&&Me!==(Me=le[15]?"Saving...":"Save MQTT Config")&&D(je,Me),me[0]&32768&&(Ae.disabled=le[15]),me[0]&65536&&ve!==(ve=le[16]?"Testing...":"Test Connection")&&D(be,ve),me[0]&69760&&_e!==(_e=le[16]||!le[12]||!le[7])&&(pe.disabled=_e)},d(le){le&&T(e),Te&&Te.d(),ae=!1,de(he)}}}function Zt(l){let e,t;return{c(){e=d("div"),t=A(l[19]),a(e,"class","error-text svelte-dlnskf")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s[0]&524288&&D(t,n[19])},d(n){n&&T(e)}}}function Mn(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k,g,y,S,C,w,R,I,O,q,E=l[18]?"Applying...":"Apply Video Mode",P,L,N,V,F=l[19]&&Zt(l);return L=ns(l[35][0]),{c(){e=d("div"),t=d("div"),t.textContent="Changing video mode will restart the camera",n=b(),s=d("div"),r=d("label"),r.textContent="Resolution",o=b(),c=d("div"),u=d("label"),f=d("input"),p=b(),m=d("span"),m.textContent="SVGA (800x600)",v=b(),_=d("label"),h=d("input"),k=b(),g=d("span"),g.textContent="VGA (640x480)",y=b(),S=d("label"),C=d("input"),w=b(),R=d("span"),R.textContent="CIF (352x288)",I=b(),F&&F.c(),O=b(),q=d("button"),P=A(E),a(t,"class","warning-text svelte-dlnskf"),a(r,"class","svelte-dlnskf"),a(f,"type","radio"),f.__value="SVGA",ee(f,f.__value),f.disabled=l[18],a(f,"class","svelte-dlnskf"),a(m,"class","svelte-dlnskf"),a(u,"class","radio-label svelte-dlnskf"),a(h,"type","radio"),h.__value="VGA",ee(h,h.__value),h.disabled=l[18],a(h,"class","svelte-dlnskf"),a(g,"class","svelte-dlnskf"),a(_,"class","radio-label svelte-dlnskf"),a(C,"type","radio"),C.__value="CIF",ee(C,C.__value),C.disabled=l[18],a(C,"class","svelte-dlnskf"),a(R,"class","svelte-dlnskf"),a(S,"class","radio-label svelte-dlnskf"),a(c,"class","radio-group svelte-dlnskf"),a(s,"class","form-group svelte-dlnskf"),a(q,"class","btn-primary svelte-dlnskf"),q.disabled=l[18],a(e,"class","form-section svelte-dlnskf"),L.p(f,h,C)},m(B,j){z(B,e,j),i(e,t),i(e,n),i(e,s),i(s,r),i(s,o),i(s,c),i(c,u),i(u,f),f.checked=f.__value===l[17],i(u,p),i(u,m),i(c,v),i(c,_),i(_,h),h.checked=h.__value===l[17],i(_,k),i(_,g),i(c,y),i(c,S),i(S,C),C.checked=C.__value===l[17],i(S,w),i(S,R),i(e,I),F&&F.m(e,null),i(e,O),i(e,q),i(q,P),N||(V=[M(f,"change",l[34]),M(h,"change",l[36]),M(C,"change",l[37]),M(q,"click",l[24])],N=!0)},p(B,j){j[0]&262144&&(f.disabled=B[18]),j[0]&131072&&(f.checked=f.__value===B[17]),j[0]&262144&&(h.disabled=B[18]),j[0]&131072&&(h.checked=h.__value===B[17]),j[0]&262144&&(C.disabled=B[18]),j[0]&131072&&(C.checked=C.__value===B[17]),B[19]?F?F.p(B,j):(F=Zt(B),F.c(),F.m(e,O)):F&&(F.d(1),F=null),j[0]&262144&&E!==(E=B[18]?"Applying...":"Apply Video Mode")&&D(P,E),j[0]&262144&&(q.disabled=B[18])},d(B){B&&T(e),F&&F.d(),L.r(),N=!1,de(V)}}}function jn(l){let e,t,n,s,r,o;const c=[Pn,On,In],u=[];function f(p,m){return p[0]?0:p[1]?1:2}return s=f(l),r=u[s]=c[s](l),{c(){e=d("div"),t=d("div"),t.innerHTML='<h1 class="svelte-dlnskf">Settings</h1>',n=b(),r.c(),a(t,"class","header svelte-dlnskf"),a(e,"class","settings-container svelte-dlnskf")},m(p,m){z(p,e,m),i(e,t),i(e,n),u[s].m(e,null),o=!0},p(p,m){let v=s;s=f(p),s===v?u[s].p(p,m):(we(),X(u[v],1,1,()=>{u[v]=null}),Ce(),r=u[s],r?r.p(p,m):(r=u[s]=c[s](p),r.c()),Q(r,1),r.m(e,null))},i(p){o||(Q(r),o=!0)},o(p){X(r),o=!1},d(p){p&&T(e),u[s].d()}}}function Xt(l){if(l=l.trim(),!l)return!0;if(!/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$/.test(l))return!1;const t=l.split("/"),n=t[0].split(".");for(let s of n){const r=parseInt(s);if(r<0||r>255)return!1}if(t[1]){const s=parseInt(t[1]);if(s<0||s>32)return!1}return!0}function Dn(l,e,t){let n=!0,s=null,r="",o="",c="",u="",f=!1,p="",m=1883,v="",_="",h="",k=!1,g=!1,y="",S=!1,C=!1,w="SVGA",R=!1,I="";Pe(async()=>{await O()});async function O(){t(0,n=!0),t(1,s=null);try{const[x,H,Z]=await Promise.all([Ps(),Ns(),js()]);t(2,r=x.whitelist.join(", ")),t(3,o=x.blacklist.join(", ")),t(4,c=x.clientIP||""),t(7,p=H.broker||""),t(8,m=H.port||1883),t(9,v=H.user||""),t(10,_=H.password||""),t(11,h=H.topic||""),t(12,k=H.enabled||!1),t(17,w=Z.mode||"SVGA"),t(0,n=!1)}catch(x){t(1,s=x.message||"Failed to load settings"),t(0,n=!1)}}async function q(){t(5,u="");const x=r.split(",").map(Z=>Z.trim()).filter(Z=>Z),H=o.split(",").map(Z=>Z.trim()).filter(Z=>Z);for(let Z of x)if(!Xt(Z)){t(5,u=`Invalid CIDR format in whitelist: ${Z}`);return}for(let Z of H)if(!Xt(Z)){t(5,u=`Invalid CIDR format in blacklist: ${Z}`);return}t(6,f=!0);try{await Rs({whitelist:x,blacklist:H}),t(6,f=!1)}catch(Z){t(5,u=Z.message||"Failed to save IP filters"),t(6,f=!1)}}async function E(){if(t(14,y=""),k&&!p){t(14,y="Broker address is required when MQTT is enabled");return}if(m<1||m>65535){t(14,y="Port must be between 1 and 65535");return}t(15,S=!0);try{await Ms({broker:p,port:m,user:v,password:_,topic:h,enabled:k}),t(15,S=!1)}catch(x){t(14,y=x.message||"Failed to save MQTT configuration"),t(15,S=!1)}}async function P(){if(t(14,y=""),!p){t(14,y="Broker address is required");return}t(16,C=!0);try{await new Promise(x=>setTimeout(x,1e3)),t(16,C=!1),alert("MQTT connection test successful")}catch(x){t(14,y=x.message||"Connection test failed"),t(16,C=!1)}}async function L(){if(t(19,I=""),!!confirm("Changing video mode will restart the camera. Continue?")){t(18,R=!0);try{await Ds({mode:w}),t(18,R=!1)}catch(H){t(19,I=H.message||"Failed to apply video mode"),t(18,R=!1)}}}const N=[[]];function V(){r=this.value,t(2,r)}function F(){o=this.value,t(3,o)}function B(){k=this.checked,t(12,k)}function j(){p=this.value,t(7,p)}function J(){m=Fe(this.value),t(8,m)}function K(){v=this.value,t(9,v)}const $=x=>t(10,_=x.target.value),se=()=>t(13,g=!g);function re(){h=this.value,t(11,h)}function ne(){w=this.__value,t(17,w)}function te(){w=this.__value,t(17,w)}function fe(){w=this.__value,t(17,w)}return[n,s,r,o,c,u,f,p,m,v,_,h,k,g,y,S,C,w,R,I,O,q,E,P,L,V,F,B,j,J,K,$,se,re,ne,N,te,fe]}class Un extends Se{constructor(e){super(),ye(this,e,Dn,jn,ge,{},null,[-1,-1])}}const{document:Hn}=Vl;function $t(l,e,t){const n=l.slice();return n[32]=e[t],n}function xt(l,e,t){const n=l.slice();return n[32]=e[t],n}function el(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",a(e,"class","btn-small svelte-16e85dp")},m(s,r){z(s,e,r),t||(n=M(e,"click",l[18]),t=!0)},p:Y,d(s){s&&T(e),t=!1,n()}}}function tl(l){let e;function t(r,o){return r[4]?Jn:r[6]?Gn:r[14].length===0&&r[2]?Wn:r[0].length===0?Bn:Vn}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),a(e,"class","log-content svelte-16e85dp"),W(e,"expanded",l[9])},m(r,o){z(r,e,o),s.m(e,null),l[25](e)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),o[0]&512&&W(e,"expanded",r[9])},d(r){r&&T(e),s.d(),l[25](null)}}}function Vn(l){let e,t,n,s=Le(l[14]),r=[];for(let c=0;c<s.length;c+=1)r[c]=ll(xt(l,s,c));let o=l[2]&&l[14].length>0&&sl(l);return{c(){e=d("div");for(let c=0;c<r.length;c+=1)r[c].c();t=b(),o&&o.c(),n=ze(),a(e,"class","log-list svelte-16e85dp")},m(c,u){z(c,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);z(c,t,u),o&&o.m(c,u),z(c,n,u)},p(c,u){if(u[0]&16384){s=Le(c[14]);let f;for(f=0;f<s.length;f+=1){const p=xt(c,s,f);r[f]?r[f].p(p,u):(r[f]=ll(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}c[2]&&c[14].length>0?o?o.p(c,u):(o=sl(c),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(c){c&&(T(e),T(t),T(n)),Ge(r,c),o&&o.d(c)}}}function Bn(l){let e;return{c(){e=d("div"),e.textContent="No system logs available",a(e,"class","no-data svelte-16e85dp")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function Wn(l){let e,t,n,s;return{c(){e=d("div"),t=A('No logs match filter "'),n=A(l[2]),s=A('"'),a(e,"class","no-results svelte-16e85dp")},m(r,o){z(r,e,o),i(e,t),i(e,n),i(e,s)},p(r,o){o[0]&4&&D(n,r[2])},d(r){r&&T(e)}}}function Gn(l){let e,t,n;return{c(){e=d("div"),t=A("Error: "),n=A(l[6]),a(e,"class","error svelte-16e85dp")},m(s,r){z(s,e,r),i(e,t),i(e,n)},p(s,r){r[0]&64&&D(n,s[6])},d(s){s&&T(e)}}}function Jn(l){let e;return{c(){e=d("div"),e.textContent="Loading system logs...",a(e,"class","loading svelte-16e85dp")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function ll(l){let e,t=l[32]+"",n;return{c(){e=d("div"),n=A(t),a(e,"class","log-line svelte-16e85dp")},m(s,r){z(s,e,r),i(e,n)},p(s,r){r[0]&16384&&t!==(t=s[32]+"")&&D(n,t)},d(s){s&&T(e)}}}function sl(l){let e,t,n=l[14].length+"",s,r,o=l[0].length+"",c,u;return{c(){e=d("div"),t=A("Showing "),s=A(n),r=A(" of "),c=A(o),u=A(" logs"),a(e,"class","filter-info svelte-16e85dp")},m(f,p){z(f,e,p),i(e,t),i(e,s),i(e,r),i(e,c),i(e,u)},p(f,p){p[0]&16384&&n!==(n=f[14].length+"")&&D(s,n),p[0]&1&&o!==(o=f[0].length+"")&&D(c,o)},d(f){f&&T(e)}}}function nl(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",a(e,"class","btn-small svelte-16e85dp")},m(s,r){z(s,e,r),t||(n=M(e,"click",l[19]),t=!0)},p:Y,d(s){s&&T(e),t=!1,n()}}}function rl(l){let e;function t(r,o){return r[5]?Xn:r[7]?Zn:r[13].length===0&&r[3]?Yn:r[1].length===0?Kn:Qn}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),a(e,"class","log-content svelte-16e85dp"),W(e,"expanded",l[10])},m(r,o){z(r,e,o),s.m(e,null),l[28](e)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),o[0]&1024&&W(e,"expanded",r[10])},d(r){r&&T(e),s.d(),l[28](null)}}}function Qn(l){let e,t,n,s=Le(l[13]),r=[];for(let c=0;c<s.length;c+=1)r[c]=il($t(l,s,c));let o=l[3]&&l[13].length>0&&ol(l);return{c(){e=d("div");for(let c=0;c<r.length;c+=1)r[c].c();t=b(),o&&o.c(),n=ze(),a(e,"class","log-list svelte-16e85dp")},m(c,u){z(c,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);z(c,t,u),o&&o.m(c,u),z(c,n,u)},p(c,u){if(u[0]&8192){s=Le(c[13]);let f;for(f=0;f<s.length;f+=1){const p=$t(c,s,f);r[f]?r[f].p(p,u):(r[f]=il(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}c[3]&&c[13].length>0?o?o.p(c,u):(o=ol(c),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(c){c&&(T(e),T(t),T(n)),Ge(r,c),o&&o.d(c)}}}function Kn(l){let e;return{c(){e=d("div"),e.textContent="No previous logs available",a(e,"class","no-data svelte-16e85dp")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function Yn(l){let e,t,n,s;return{c(){e=d("div"),t=A('No logs match filter "'),n=A(l[3]),s=A('"'),a(e,"class","no-results svelte-16e85dp")},m(r,o){z(r,e,o),i(e,t),i(e,n),i(e,s)},p(r,o){o[0]&8&&D(n,r[3])},d(r){r&&T(e)}}}function Zn(l){let e,t,n;return{c(){e=d("div"),t=A("Error: "),n=A(l[7]),a(e,"class","error svelte-16e85dp")},m(s,r){z(s,e,r),i(e,t),i(e,n)},p(s,r){r[0]&128&&D(n,s[7])},d(s){s&&T(e)}}}function Xn(l){let e;return{c(){e=d("div"),e.textContent="Loading previous logs...",a(e,"class","loading svelte-16e85dp")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function il(l){let e,t=l[32]+"",n;return{c(){e=d("div"),n=A(t),a(e,"class","log-line svelte-16e85dp")},m(s,r){z(s,e,r),i(e,n)},p(s,r){r[0]&8192&&t!==(t=s[32]+"")&&D(n,t)},d(s){s&&T(e)}}}function ol(l){let e,t,n=l[13].length+"",s,r,o=l[1].length+"",c,u;return{c(){e=d("div"),t=A("Showing "),s=A(n),r=A(" of "),c=A(o),u=A(" logs"),a(e,"class","filter-info svelte-16e85dp")},m(f,p){z(f,e,p),i(e,t),i(e,s),i(e,r),i(e,c),i(e,u)},p(f,p){p[0]&8192&&n!==(n=f[13].length+"")&&D(s,n),p[0]&2&&o!==(o=f[1].length+"")&&D(c,o)},d(f){f&&T(e)}}}function $n(l){let e,t,n,s,r,o,c,u=l[8]?"Auto-refresh On":"Auto-refresh Off",f,p,m,v,_,h,k,g,y,S,C=l[9]?"â–¼":"â–¶",w,R,I,O,q,E,P,L,N,V,F,B,j,J,K,$,se=l[10]?"â–¼":"â–¶",re,ne,te,fe,x,H,Z,U,G,qe,Ae,Me,je,Je,pe=l[2]&&el(l),ve=l[9]&&tl(l),be=l[3]&&nl(l),_e=l[10]&&rl(l);return{c(){e=b(),t=d("div"),n=d("div"),s=d("h1"),s.textContent="Logs & Diagnostics",r=b(),o=d("div"),c=d("button"),f=A(u),p=A(" ("),m=A($l),v=A("s)"),_=b(),h=d("button"),h.textContent="Refresh Now",k=b(),g=d("div"),y=d("div"),S=d("button"),w=A(C),R=b(),I=d("h2"),I.textContent="System Logs",O=b(),q=d("div"),E=d("input"),P=b(),pe&&pe.c(),L=b(),N=d("button"),V=A("Export"),B=b(),ve&&ve.c(),j=b(),J=d("div"),K=d("div"),$=d("button"),re=A(se),ne=b(),te=d("h2"),te.textContent="Previous System Logs",fe=b(),x=d("div"),H=d("input"),Z=b(),be&&be.c(),U=b(),G=d("button"),qe=A("Export"),Me=b(),_e&&_e.c(),Hn.title="Logs & Diagnostics - MouseTrap",a(s,"class","svelte-16e85dp"),a(c,"class","btn svelte-16e85dp"),W(c,"active",l[8]),a(h,"class","btn svelte-16e85dp"),a(o,"class","header-controls svelte-16e85dp"),a(n,"class","header svelte-16e85dp"),a(S,"class","expand-btn svelte-16e85dp"),a(I,"class","svelte-16e85dp"),a(E,"type","text"),a(E,"class","filter-input svelte-16e85dp"),a(E,"placeholder","Filter logs..."),a(N,"class","btn-small svelte-16e85dp"),N.disabled=F=l[0].length===0,a(q,"class","log-controls svelte-16e85dp"),a(y,"class","log-header svelte-16e85dp"),a(g,"class","log-section svelte-16e85dp"),a($,"class","expand-btn svelte-16e85dp"),a(te,"class","svelte-16e85dp"),a(H,"type","text"),a(H,"class","filter-input svelte-16e85dp"),a(H,"placeholder","Filter logs..."),a(G,"class","btn-small svelte-16e85dp"),G.disabled=Ae=l[1].length===0,a(x,"class","log-controls svelte-16e85dp"),a(K,"class","log-header svelte-16e85dp"),a(J,"class","log-section svelte-16e85dp"),a(t,"class","logs-container svelte-16e85dp")},m(ae,he){z(ae,e,he),z(ae,t,he),i(t,n),i(n,s),i(n,r),i(n,o),i(o,c),i(c,f),i(c,p),i(c,m),i(c,v),i(o,_),i(o,h),i(t,k),i(t,g),i(g,y),i(y,S),i(S,w),i(y,R),i(y,I),i(y,O),i(y,q),i(q,E),ee(E,l[2]),i(q,P),pe&&pe.m(q,null),i(q,L),i(q,N),i(N,V),i(g,B),ve&&ve.m(g,null),i(t,j),i(t,J),i(J,K),i(K,$),i($,re),i(K,ne),i(K,te),i(K,fe),i(K,x),i(x,H),ee(H,l[3]),i(x,Z),be&&be.m(x,null),i(x,U),i(x,G),i(G,qe),i(J,Me),_e&&_e.m(J,null),je||(Je=[M(c,"click",l[17]),M(h,"click",l[22]),M(S,"click",l[20]),M(E,"input",l[23]),M(N,"click",l[24]),M($,"click",l[21]),M(H,"input",l[26]),M(G,"click",l[27])],je=!0)},p(ae,he){he[0]&256&&u!==(u=ae[8]?"Auto-refresh On":"Auto-refresh Off")&&D(f,u),he[0]&256&&W(c,"active",ae[8]),he[0]&512&&C!==(C=ae[9]?"â–¼":"â–¶")&&D(w,C),he[0]&4&&E.value!==ae[2]&&ee(E,ae[2]),ae[2]?pe?pe.p(ae,he):(pe=el(ae),pe.c(),pe.m(q,L)):pe&&(pe.d(1),pe=null),he[0]&1&&F!==(F=ae[0].length===0)&&(N.disabled=F),ae[9]?ve?ve.p(ae,he):(ve=tl(ae),ve.c(),ve.m(g,null)):ve&&(ve.d(1),ve=null),he[0]&1024&&se!==(se=ae[10]?"â–¼":"â–¶")&&D(re,se),he[0]&8&&H.value!==ae[3]&&ee(H,ae[3]),ae[3]?be?be.p(ae,he):(be=nl(ae),be.c(),be.m(x,U)):be&&(be.d(1),be=null),he[0]&2&&Ae!==(Ae=ae[1].length===0)&&(G.disabled=Ae),ae[10]?_e?_e.p(ae,he):(_e=rl(ae),_e.c(),_e.m(J,null)):_e&&(_e.d(1),_e=null)},i:Y,o:Y,d(ae){ae&&(T(e),T(t)),pe&&pe.d(),ve&&ve.d(),be&&be.d(),_e&&_e.d(),je=!1,de(Je)}}}let $l=5;function al(l,e){const t=l.join(`
`),n=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=e,r.click(),URL.revokeObjectURL(s)}function xn(l,e,t){let n,s,r=[],o=[],c=!0,u=!0,f=null,p=null,m=!1,v=null,_="",h="",k=!0,g=!0,y,S;async function C($=!0){const se=(y==null?void 0:y.scrollTop)||0;$&&t(4,c=!0),t(6,f=null);try{t(0,r=await Us())}catch(re){console.error("Failed to fetch system logs:",re),t(6,f=re.message),t(0,r=[])}finally{$&&t(4,c=!1),y&&se>0&&requestAnimationFrame(()=>{t(11,y.scrollTop=se,y)})}}async function w($=!0){const se=(S==null?void 0:S.scrollTop)||0;$&&t(5,u=!0),t(7,p=null);try{t(1,o=await Hs())}catch(re){console.error("Failed to fetch previous logs:",re),t(7,p=re.message),t(1,o=[])}finally{$&&t(5,u=!1),S&&se>0&&requestAnimationFrame(()=>{t(12,S.scrollTop=se,S)})}}function R(){t(8,m=!m),m?I():O()}function I(){O(),v=setInterval(()=>{C(!1),w(!1)},$l*1e3)}function O(){v&&(clearInterval(v),v=null)}function q(){t(2,_="")}function E(){t(3,h="")}function P(){t(9,k=!k)}function L(){t(10,g=!g)}Pe(()=>{C(),w()}),Xe(()=>{O()});const N=()=>{C(!0),w(!0)};function V(){_=this.value,t(2,_)}const F=()=>al(r,"system-logs.txt");function B($){Ye[$?"unshift":"push"](()=>{y=$,t(11,y)})}function j(){h=this.value,t(3,h)}const J=()=>al(o,"previous-logs.txt");function K($){Ye[$?"unshift":"push"](()=>{S=$,t(12,S)})}return l.$$.update=()=>{l.$$.dirty[0]&5&&t(14,n=r.filter($=>$.toLowerCase().includes(_.toLowerCase()))),l.$$.dirty[0]&10&&t(13,s=o.filter($=>$.toLowerCase().includes(h.toLowerCase())))},[r,o,_,h,c,u,f,p,m,k,g,y,S,s,n,C,w,R,q,E,P,L,N,V,F,B,j,J,K]}class cl extends Se{constructor(e){super(),ye(this,e,xn,$n,ge,{},null,[-1,-1])}}function er(l){let e,t,n,s,r,o,c,u,f,p,m=l[6]&&ul();return n=new ke({props:{$$slots:{default:[lr]},$$scope:{ctx:l}}}),r=new ke({props:{$$slots:{default:[sr]},$$scope:{ctx:l}}}),c=new ke({props:{$$slots:{default:[cr]},$$scope:{ctx:l}}}),f=new ke({props:{$$slots:{default:[dr]},$$scope:{ctx:l}}}),{c(){m&&m.c(),e=b(),t=d("div"),ce(n.$$.fragment),s=b(),ce(r.$$.fragment),o=b(),ce(c.$$.fragment),u=b(),ce(f.$$.fragment),a(t,"class","cards-grid svelte-qwtv9g")},m(v,_){m&&m.m(v,_),z(v,e,_),z(v,t,_),ie(n,t,null),i(t,s),ie(r,t,null),i(t,o),ie(c,t,null),i(t,u),ie(f,t,null),p=!0},p(v,_){v[6]?m||(m=ul(),m.c(),m.m(e.parentNode,e)):m&&(m.d(1),m=null);const h={};_&65537&&(h.$$scope={dirty:_,ctx:v}),n.$set(h);const k={};_&65552&&(k.$$scope={dirty:_,ctx:v}),r.$set(k);const g={};_&65596&&(g.$$scope={dirty:_,ctx:v}),c.$set(g);const y={};_&65537&&(y.$$scope={dirty:_,ctx:v}),f.$set(y)},i(v){p||(Q(n.$$.fragment,v),Q(r.$$.fragment,v),Q(c.$$.fragment,v),Q(f.$$.fragment,v),p=!0)},o(v){X(n.$$.fragment,v),X(r.$$.fragment,v),X(c.$$.fragment,v),X(f.$$.fragment,v),p=!1},d(v){v&&(T(e),T(t)),m&&m.d(v),oe(n),oe(r),oe(c),oe(f)}}}function tr(l){let e,t,n;return t=new Ne({}),{c(){e=d("div"),ce(t.$$.fragment),a(e,"class","loading-container svelte-qwtv9g")},m(s,r){z(s,e,r),ie(t,e,null),n=!0},p:Y,i(s){n||(Q(t.$$.fragment,s),n=!0)},o(s){X(t.$$.fragment,s),n=!1},d(s){s&&T(e),oe(t)}}}function ul(l){let e;return{c(){e=d("div"),e.textContent="Device is back online!",a(e,"class","online-banner svelte-qwtv9g")},m(t,n){z(t,e,n)},d(t){t&&T(e)}}}function fl(l){let e,t,n=l[0].buildDate+"",s;return{c(){e=d("div"),t=A("Built: "),s=A(n),a(e,"class","build-date svelte-qwtv9g")},m(r,o){z(r,e,o),i(e,t),i(e,s)},p(r,o){o&1&&n!==(n=r[0].buildDate+"")&&D(s,n)},d(r){r&&T(e)}}}function dl(l){let e,t,n,s,r=l[0].chipModel+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="Chip Model",n=b(),s=d("td"),o=A(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(c,u){u&1&&r!==(r=c[0].chipModel+"")&&D(o,r)},d(c){c&&T(e)}}}function pl(l){let e,t,n,s,r=gl(l[0].cpuFreq)+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="CPU Frequency",n=b(),s=d("td"),o=A(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(c,u){u&1&&r!==(r=gl(c[0].cpuFreq)+"")&&D(o,r)},d(c){c&&T(e)}}}function ml(l){let e,t,n,s,r=rt(l[0].flashSize)+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="Flash Size",n=b(),s=d("td"),o=A(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(c,u){u&1&&r!==(r=rt(c[0].flashSize)+"")&&D(o,r)},d(c){c&&T(e)}}}function vl(l){let e,t,n,s,r=rt(l[0].psramSize)+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="PSRAM Size",n=b(),s=d("td"),o=A(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(c,u){u&1&&r!==(r=rt(c[0].psramSize)+"")&&D(o,r)},d(c){c&&T(e)}}}function _l(l){let e,t,n,s,r=l[0].macAddress+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="MAC Address",n=b(),s=d("td"),o=A(r),a(t,"class","label svelte-qwtv9g"),a(s,"class","value svelte-qwtv9g"),a(e,"class","svelte-qwtv9g")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(c,u){u&1&&r!==(r=c[0].macAddress+"")&&D(o,r)},d(c){c&&T(e)}}}function lr(l){var R,I,O,q,E,P,L;let e,t,n,s=(((R=l[0])==null?void 0:R.firmwareVersion)||"Unknown")+"",r,o,c,u,f,p,m,v,_,h,k=((I=l[0])==null?void 0:I.buildDate)&&fl(l),g=((O=l[0])==null?void 0:O.chipModel)&&dl(l),y=((q=l[0])==null?void 0:q.cpuFreq)&&pl(l),S=((E=l[0])==null?void 0:E.flashSize)&&ml(l),C=((P=l[0])==null?void 0:P.psramSize)&&vl(l),w=((L=l[0])==null?void 0:L.macAddress)&&_l(l);return{c(){e=d("h2"),e.textContent="ESP32 Sketch",t=b(),n=d("div"),r=A(s),o=b(),k&&k.c(),c=b(),u=d("div"),f=d("table"),p=d("tbody"),g&&g.c(),m=b(),y&&y.c(),v=b(),S&&S.c(),_=b(),C&&C.c(),h=b(),w&&w.c(),a(e,"class","svelte-qwtv9g"),a(n,"class","firmware-version svelte-qwtv9g"),a(f,"class","svelte-qwtv9g"),a(u,"class","device-info svelte-qwtv9g")},m(N,V){z(N,e,V),z(N,t,V),z(N,n,V),i(n,r),z(N,o,V),k&&k.m(N,V),z(N,c,V),z(N,u,V),i(u,f),i(f,p),g&&g.m(p,null),i(p,m),y&&y.m(p,null),i(p,v),S&&S.m(p,null),i(p,_),C&&C.m(p,null),i(p,h),w&&w.m(p,null)},p(N,V){var F,B,j,J,K,$,se;V&1&&s!==(s=(((F=N[0])==null?void 0:F.firmwareVersion)||"Unknown")+"")&&D(r,s),(B=N[0])!=null&&B.buildDate?k?k.p(N,V):(k=fl(N),k.c(),k.m(c.parentNode,c)):k&&(k.d(1),k=null),(j=N[0])!=null&&j.chipModel?g?g.p(N,V):(g=dl(N),g.c(),g.m(p,m)):g&&(g.d(1),g=null),(J=N[0])!=null&&J.cpuFreq?y?y.p(N,V):(y=pl(N),y.c(),y.m(p,v)):y&&(y.d(1),y=null),(K=N[0])!=null&&K.flashSize?S?S.p(N,V):(S=ml(N),S.c(),S.m(p,_)):S&&(S.d(1),S=null),($=N[0])!=null&&$.psramSize?C?C.p(N,V):(C=vl(N),C.c(),C.m(p,h)):C&&(C.d(1),C=null),(se=N[0])!=null&&se.macAddress?w?w.p(N,V):(w=_l(N),w.c(),w.m(p,null)):w&&(w.d(1),w=null)},d(N){N&&(T(e),T(t),T(n),T(o),T(c),T(u)),k&&k.d(N),g&&g.d(),y&&y.d(),S&&S.d(),C&&C.d(),w&&w.d()}}}function sr(l){let e,t,n,s,r,o,c,u,f,p;return{c(){e=d("h2"),e.textContent="OTA Update",t=b(),n=d("p"),n.textContent="Upload new firmware via the web-based OTA interface.",s=b(),r=d("button"),o=A("Open OTA Update Interface"),c=b(),u=d("div"),u.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 12H7V7h2v5zm0-6H7V4h2v2z"></path></svg>
          Device will reboot after update`,a(e,"class","svelte-qwtv9g"),a(n,"class","description svelte-qwtv9g"),a(r,"class","ota-button svelte-qwtv9g"),r.disabled=l[4],a(u,"class","warning-text svelte-qwtv9g")},m(m,v){z(m,e,v),z(m,t,v),z(m,n,v),z(m,s,v),z(m,r,v),i(r,o),z(m,c,v),z(m,u,v),f||(p=M(r,"click",mr),f=!0)},p(m,v){v&16&&(r.disabled=m[4])},d(m){m&&(T(e),T(t),T(n),T(s),T(r),T(c),T(u)),f=!1,p()}}}function nr(l){let e,t,n,s,r,o,c;return{c(){e=d("p"),e.textContent="Restart the device to apply configuration changes or recover from errors.",t=b(),n=d("button"),n.textContent="Reboot Device",s=b(),r=d("div"),r.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 12H7V7h2v5zm0-6H7V4h2v2z"></path></svg>
            Device will be unavailable for approximately 30 seconds`,a(e,"class","description svelte-qwtv9g"),a(n,"class","reboot-button svelte-qwtv9g"),a(r,"class","warning-text svelte-qwtv9g")},m(u,f){z(u,e,f),z(u,t,f),z(u,n,f),z(u,s,f),z(u,r,f),o||(c=M(n,"click",l[7]),o=!0)},p:Y,i:Y,o:Y,d(u){u&&(T(e),T(t),T(n),T(s),T(r)),o=!1,c()}}}function rr(l){let e,t,n,s,r,o,c,u=l[3]!==1?"s":"",f,p,m,v,_,h;return{c(){e=d("div"),t=d("p"),t.textContent="Are you sure you want to reboot the device?",n=b(),s=d("div"),r=A("Rebooting in "),o=A(l[3]),c=A(" second"),f=A(u),p=A("..."),m=b(),v=d("button"),v.textContent="Cancel",a(t,"class","confirm-text svelte-qwtv9g"),a(s,"class","countdown svelte-qwtv9g"),a(v,"class","cancel-button svelte-qwtv9g"),a(e,"class","confirm-container svelte-qwtv9g")},m(k,g){z(k,e,g),i(e,t),i(e,n),i(e,s),i(s,r),i(s,o),i(s,c),i(s,f),i(s,p),i(e,m),i(e,v),_||(h=M(v,"click",l[8]),_=!0)},p(k,g){g&8&&D(o,k[3]),g&8&&u!==(u=k[3]!==1?"s":"")&&D(f,u)},i:Y,o:Y,d(k){k&&T(e),_=!1,h()}}}function ir(l){let e,t,n,s,r;t=new Ne({});function o(f,p){return f[5]?ar:or}let c=o(l),u=c(l);return{c(){e=d("div"),ce(t.$$.fragment),n=b(),s=d("div"),u.c(),a(s,"class","rebooting-text svelte-qwtv9g"),a(e,"class","rebooting-container svelte-qwtv9g")},m(f,p){z(f,e,p),ie(t,e,null),i(e,n),i(e,s),u.m(s,null),r=!0},p(f,p){c!==(c=o(f))&&(u.d(1),u=c(f),u&&(u.c(),u.m(s,null)))},i(f){r||(Q(t.$$.fragment,f),r=!0)},o(f){X(t.$$.fragment,f),r=!1},d(f){f&&T(e),oe(t),u.d()}}}function or(l){let e;return{c(){e=A("Rebooting device...")},m(t,n){z(t,e,n)},d(t){t&&T(e)}}}function ar(l){let e;return{c(){e=A("Waiting for device to come back online...")},m(t,n){z(t,e,n)},d(t){t&&T(e)}}}function cr(l){let e,t,n,s,r,o;const c=[ir,rr,nr],u=[];function f(p,m){return p[4]?0:p[2]?1:2}return n=f(l),s=u[n]=c[n](l),{c(){e=d("h2"),e.textContent="Device Reboot",t=b(),s.c(),r=ze(),a(e,"class","svelte-qwtv9g")},m(p,m){z(p,e,m),z(p,t,m),u[n].m(p,m),z(p,r,m),o=!0},p(p,m){let v=n;n=f(p),n===v?u[n].p(p,m):(we(),X(u[v],1,1,()=>{u[v]=null}),Ce(),s=u[n],s?s.p(p,m):(s=u[n]=c[n](p),s.c()),Q(s,1),s.m(r.parentNode,r))},i(p){o||(Q(s),o=!0)},o(p){X(s),o=!1},d(p){p&&(T(e),T(t),T(r)),u[n].d(p)}}}function ur(l){let e;return{c(){e=d("p"),e.textContent="No version information available",a(e,"class","placeholder-text svelte-qwtv9g")},m(t,n){z(t,e,n)},p:Y,d(t){t&&T(e)}}}function fr(l){let e,t,n,s,r,o=(l[0].firmwareVersion||"Unknown")+"",c,u,f,p,m,v,_=et(l[0].firmwareUpdateTime)+"",h,k,g,y,S,C,w,R=et(l[0].filesystemUpdateTime)+"",I,O,q=l[0].filesystemVersion&&bl(l),E=l[0].sdkVersion&&hl(l);return{c(){e=d("div"),t=d("div"),n=d("div"),n.textContent="Sketch Version:",s=b(),r=d("div"),c=A(o),u=b(),f=d("div"),p=d("div"),p.textContent="Last Firmware Update:",m=b(),v=d("div"),h=A(_),k=b(),q&&q.c(),g=b(),y=d("div"),S=d("div"),S.textContent="Last Filesystem Update:",C=b(),w=d("div"),I=A(R),O=b(),E&&E.c(),a(n,"class","history-label svelte-qwtv9g"),a(r,"class","history-value svelte-qwtv9g"),a(t,"class","history-item svelte-qwtv9g"),a(p,"class","timestamp-label svelte-qwtv9g"),a(v,"class","timestamp-value svelte-qwtv9g"),a(f,"class","timestamp-item svelte-qwtv9g"),a(S,"class","timestamp-label svelte-qwtv9g"),a(w,"class","timestamp-value svelte-qwtv9g"),a(y,"class","timestamp-item svelte-qwtv9g"),a(e,"class","update-history svelte-qwtv9g")},m(P,L){z(P,e,L),i(e,t),i(t,n),i(t,s),i(t,r),i(r,c),i(e,u),i(e,f),i(f,p),i(f,m),i(f,v),i(v,h),i(e,k),q&&q.m(e,null),i(e,g),i(e,y),i(y,S),i(y,C),i(y,w),i(w,I),i(e,O),E&&E.m(e,null)},p(P,L){L&1&&o!==(o=(P[0].firmwareVersion||"Unknown")+"")&&D(c,o),L&1&&_!==(_=et(P[0].firmwareUpdateTime)+"")&&D(h,_),P[0].filesystemVersion?q?q.p(P,L):(q=bl(P),q.c(),q.m(e,g)):q&&(q.d(1),q=null),L&1&&R!==(R=et(P[0].filesystemUpdateTime)+"")&&D(I,R),P[0].sdkVersion?E?E.p(P,L):(E=hl(P),E.c(),E.m(e,null)):E&&(E.d(1),E=null)},d(P){P&&T(e),q&&q.d(),E&&E.d()}}}function bl(l){let e,t,n,s,r=l[0].filesystemVersion+"",o;return{c(){e=d("div"),t=d("div"),t.textContent="Svelte App Version:",n=b(),s=d("div"),o=A(r),a(t,"class","history-label svelte-qwtv9g"),a(s,"class","history-value svelte-qwtv9g"),a(e,"class","history-item svelte-qwtv9g")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(c,u){u&1&&r!==(r=c[0].filesystemVersion+"")&&D(o,r)},d(c){c&&T(e)}}}function hl(l){let e,t,n,s,r=l[0].sdkVersion+"",o;return{c(){e=d("div"),t=d("div"),t.textContent="ESP32 SDK:",n=b(),s=d("div"),o=A(r),a(t,"class","history-label svelte-qwtv9g"),a(s,"class","history-value svelte-qwtv9g"),a(e,"class","history-item svelte-qwtv9g")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(c,u){u&1&&r!==(r=c[0].sdkVersion+"")&&D(o,r)},d(c){c&&T(e)}}}function dr(l){let e,t,n;function s(c,u){return c[0]?fr:ur}let r=s(l),o=r(l);return{c(){e=d("h2"),e.textContent="Version Information",t=b(),o.c(),n=ze(),a(e,"class","svelte-qwtv9g")},m(c,u){z(c,e,u),z(c,t,u),o.m(c,u),z(c,n,u)},p(c,u){r===(r=s(c))&&o?o.p(c,u):(o.d(1),o=r(c),o&&(o.c(),o.m(n.parentNode,n)))},d(c){c&&(T(e),T(t),T(n)),o.d(c)}}}function pr(l){let e,t,n,s,r,o;const c=[tr,er],u=[];function f(p,m){return p[1]?0:1}return s=f(l),r=u[s]=c[s](l),{c(){e=d("div"),t=d("h1"),t.textContent="Firmware & Updates",n=b(),r.c(),a(t,"class","svelte-qwtv9g"),a(e,"class","firmware-container svelte-qwtv9g")},m(p,m){z(p,e,m),i(e,t),i(e,n),u[s].m(e,null),o=!0},p(p,[m]){let v=s;s=f(p),s===v?u[s].p(p,m):(we(),X(u[v],1,1,()=>{u[v]=null}),Ce(),r=u[s],r?r.p(p,m):(r=u[s]=c[s](p),r.c()),Q(r,1),r.m(e,null))},i(p){o||(Q(r),o=!0)},o(p){X(r),o=!1},d(p){p&&T(e),u[s].d()}}}function mr(){window.open("/update","_blank")}function rt(l){return l?`${(l/(1024*1024)).toFixed(2)} MB`:"N/A"}function gl(l){return l?`${l} MHz`:"N/A"}function et(l){return!l||l===0?"Never":new Date(l*1e3).toLocaleString()}function vr(l,e,t){let n=null,s=!0,r=!1,o=0,c=!1,u=!1,f=!1,p=null,m=null,v=null;Pe(async()=>{await _(),v=setInterval(async()=>{!c&&!r&&await _()},3e4)}),Xe(()=>{p&&clearInterval(p),m&&clearInterval(m),v&&clearInterval(v)});async function _(){t(1,s=!0);try{t(0,n=await Vs())}catch(S){console.warn("Failed to load system info:",S),t(0,n=null)}finally{t(1,s=!1)}}function h(){t(2,r=!0),t(3,o=3),p=setInterval(()=>{t(3,o--,o),o<=0&&(clearInterval(p),p=null,g())},1e3)}function k(){t(2,r=!1),p&&(clearInterval(p),p=null),t(3,o=0)}async function g(){t(2,r=!1),t(4,c=!0);try{await Bs()}catch{}setTimeout(()=>{t(5,u=!0),y()},5e3)}function y(){m=setInterval(async()=>{try{(await fetch("/status",{method:"GET",cache:"no-cache"})).ok&&(clearInterval(m),m=null,t(5,u=!1),t(4,c=!1),t(6,f=!0),await _(),setTimeout(()=>{t(6,f=!1)},5e3))}catch{}},2e3)}return[n,s,r,o,c,u,f,h,k]}class kl extends Se{constructor(e){super(),ye(this,e,vr,pr,ge,{})}}function wl(l){let e,t;return{c(){e=d("div"),t=A(l[2]),a(e,"class","message svelte-1gg1mca"),W(e,"success",l[3]==="success"),W(e,"error",l[3]==="error")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s&4&&D(t,n[2]),s&8&&W(e,"success",n[3]==="success"),s&8&&W(e,"error",n[3]==="error")},d(n){n&&T(e)}}}function _r(l){let e,t,n,s,r,o=l[0]?"â³":l[4]?"ðŸ”„":"ðŸ””",c,u,f=l[4]?"Reset Alert":"Test Alert",p,m,v,_=l[1]?"â³":"âš™ï¸",h,k,g,y,S,C=l[2]&&wl(l);return{c(){e=d("div"),t=d("p"),t.textContent="Press a button to simulate an event or just fire the servo.",n=b(),s=d("div"),r=d("button"),c=A(o),u=b(),p=A(f),m=b(),v=d("button"),h=A(_),k=A(" Test Servo"),g=b(),C&&C.c(),a(t,"class","description svelte-1gg1mca"),a(r,"class","btn test-alert-btn svelte-1gg1mca"),r.disabled=l[0],W(r,"alert-active",l[4]),a(v,"class","btn test-servo-btn svelte-1gg1mca"),v.disabled=l[1],a(s,"class","button-group svelte-1gg1mca"),a(e,"class","content svelte-1gg1mca")},m(w,R){z(w,e,R),i(e,t),i(e,n),i(e,s),i(s,r),i(r,c),i(r,u),i(r,p),i(s,m),i(s,v),i(v,h),i(v,k),i(e,g),C&&C.m(e,null),y||(S=[M(r,"click",l[5]),M(v,"click",l[6])],y=!0)},p(w,R){R&17&&o!==(o=w[0]?"â³":w[4]?"ðŸ”„":"ðŸ””")&&D(c,o),R&16&&f!==(f=w[4]?"Reset Alert":"Test Alert")&&D(p,f),R&1&&(r.disabled=w[0]),R&16&&W(r,"alert-active",w[4]),R&2&&_!==(_=w[1]?"â³":"âš™ï¸")&&D(h,_),R&2&&(v.disabled=w[1]),w[2]?C?C.p(w,R):(C=wl(w),C.c(),C.m(e,null)):C&&(C.d(1),C=null)},d(w){w&&T(e),C&&C.d(),y=!1,de(S)}}}function br(l){let e,t,n,s,r;return s=new ke({props:{title:"",$$slots:{default:[_r]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Test Alert",n=b(),ce(s.$$.fragment),a(t,"class","svelte-1gg1mca"),a(e,"class","page svelte-1gg1mca")},m(o,c){z(o,e,c),i(e,t),i(e,n),ie(s,e,null),r=!0},p(o,[c]){const u={};c&543&&(u.$$scope={dirty:c,ctx:o}),s.$set(u)},i(o){r||(Q(s.$$.fragment,o),r=!0)},o(o){X(s.$$.fragment,o),r=!1},d(o){o&&T(e),oe(s)}}}function hr(l,e,t){let n=!1,s=!1,r="",o="",c=!1,u=null;async function f(){try{const v=await gt();t(4,c=v.detectionState||!1)}catch(v){console.error("Failed to check alert status:",v)}}async function p(){t(0,n=!0),t(2,r=""),t(3,o="");try{if(c)await Zl(),t(2,r="âœ… Alert reset successfully"),t(3,o="success"),t(4,c=!1);else{const v=await Yl();t(2,r=v||"âœ… Test alert started â€“ check /gallery or /captures"),t(3,o="success"),t(4,c=!0)}}catch(v){t(2,r=`Error: ${v.message||(c?"Failed to reset alert":"Failed to trigger test alert")}`),t(3,o="error")}finally{t(0,n=!1),f()}}async function m(){t(1,s=!0),t(2,r=""),t(3,o="");try{await Kl(),t(2,r="Servo triggered"),t(3,o="success")}catch(v){t(2,r=`Error: ${v.message||"Failed to trigger servo"}`),t(3,o="error")}finally{t(1,s=!1)}}return Pe(()=>{f(),u=setInterval(f,2e3)}),Xe(()=>{u&&clearInterval(u)}),[n,s,r,o,c,p,m]}class gr extends Se{constructor(e){super(),ye(this,e,hr,br,ge,{})}}function Cl(l,e,t){const n=l.slice();return n[41]=e[t],n}function yl(l,e,t){const n=l.slice();return n[44]=e[t],n}function Sl(l){let e,t;return{c(){e=d("div"),t=d("div"),a(t,"class","progress-fill svelte-dd6z23"),Re(t,"width",l[7]/(Pl-1)*100+"%"),a(e,"class","progress-bar svelte-dd6z23")},m(n,s){z(n,e,s),i(e,t)},p(n,s){s[0]&128&&Re(t,"width",n[7]/(Pl-1)*100+"%")},d(n){n&&T(e)}}}function Tl(l){let e,t,n,s,r,o,c,u,f,p,m,v,_;const h=[wr,kr],k=[];function g(y,S){return y[8]?0:1}return f=g(l),p=k[f]=h[f](l),{c(){e=d("div"),t=d("div"),t.innerHTML='<span class="mouse-emoji svelte-dd6z23" role="img" aria-label="mouse">ðŸ</span>',n=b(),s=d("h1"),s.textContent="MouseTrap Setup",r=b(),o=d("p"),o.textContent="Let's get your device connected and ready to protect your home.",c=b(),u=d("button"),p.c(),a(t,"class","welcome-icon svelte-dd6z23"),a(s,"class","svelte-dd6z23"),a(o,"class","welcome-text svelte-dd6z23"),a(u,"class","btn-primary btn-large svelte-dd6z23"),u.disabled=l[8],a(e,"class","step welcome-step svelte-dd6z23")},m(y,S){z(y,e,S),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(e,c),i(e,u),k[f].m(u,null),m=!0,v||(_=M(u,"click",l[24]),v=!0)},p(y,S){let C=f;f=g(y),f!==C&&(we(),X(k[C],1,1,()=>{k[C]=null}),Ce(),p=k[f],p||(p=k[f]=h[f](y),p.c()),Q(p,1),p.m(u,null)),(!m||S[0]&256)&&(u.disabled=y[8])},i(y){m||(Q(p),m=!0)},o(y){X(p),m=!1},d(y){y&&T(e),k[f].d(),v=!1,_()}}}function kr(l){let e,t;return{c(){e=A("Get Started "),t=d("span"),t.textContent="â†’",a(t,"class","arrow svelte-dd6z23")},m(n,s){z(n,e,s),z(n,t,s)},i:Y,o:Y,d(n){n&&(T(e),T(t))}}}function wr(l){let e,t,n;return e=new Ne({props:{size:"small"}}),{c(){ce(e.$$.fragment),t=A(" Loading...")},m(s,r){ie(e,s,r),z(s,t,r),n=!0},i(s){n||(Q(e.$$.fragment,s),n=!0)},o(s){X(e.$$.fragment,s),n=!1},d(s){s&&T(t),oe(e,s)}}}function zl(l){let e,t,n,s,r,o,c,u,f,p,m,v,_,h,k,g;const y=[Sr,yr,Cr],S=[];function C(w,R){return w[11]?0:w[10]?1:2}return s=C(l),r=S[s]=y[s](l),{c(){e=d("div"),t=d("h2"),t.textContent="Select your WiFi network",n=b(),r.c(),o=b(),c=d("div"),u=d("button"),u.innerHTML='<span class="arrow svelte-dd6z23">â†</span> Back',f=b(),p=d("button"),m=A("Next "),v=d("span"),v.textContent="â†’",a(t,"class","svelte-dd6z23"),a(u,"class","btn-secondary svelte-dd6z23"),a(v,"class","arrow svelte-dd6z23"),a(p,"class","btn-primary svelte-dd6z23"),p.disabled=_=!l[18],a(c,"class","button-row svelte-dd6z23"),a(e,"class","step wifi-step svelte-dd6z23")},m(w,R){z(w,e,R),i(e,t),i(e,n),S[s].m(e,null),i(e,o),i(e,c),i(c,u),i(c,f),i(c,p),i(p,m),i(p,v),h=!0,k||(g=[M(u,"click",l[31]),M(p,"click",l[32])],k=!0)},p(w,R){let I=s;s=C(w),s===I?S[s].p(w,R):(we(),X(S[I],1,1,()=>{S[I]=null}),Ce(),r=S[s],r?r.p(w,R):(r=S[s]=y[s](w),r.c()),Q(r,1),r.m(e,o)),(!h||R[0]&262144&&_!==(_=!w[18]))&&(p.disabled=_)},i(w){h||(Q(r),h=!0)},o(w){X(r),h=!1},d(w){w&&T(e),S[s].d(),k=!1,de(g)}}}function Cr(l){let e,t,n,s,r=l[0]==="manual"?"â—‰":"â—‹",o,c,u,f,p,m,v,_,h,k,g,y=l[12]?"Hide":"Show",S,C,w,R=l[2].length+"",I,O,q,E,P=Le(l[9]),L=[];for(let j=0;j<P.length;j+=1)L[j]=ql(yl(l,P,j));let N=l[0]==="manual"&&Al(l);function V(j,J){return j[12]?zr:Tr}let F=V(l),B=F(l);return{c(){e=d("div");for(let j=0;j<L.length;j+=1)L[j].c();t=b(),n=d("button"),s=d("span"),o=A(r),c=b(),u=d("span"),u.textContent="Enter manually...",f=b(),N&&N.c(),p=b(),m=d("div"),v=d("label"),v.textContent="Password",_=b(),h=d("div"),B.c(),k=b(),g=d("button"),S=A(y),C=b(),w=d("p"),I=A(R),O=A("/8 characters minimum"),a(s,"class","network-radio svelte-dd6z23"),a(u,"class","network-name svelte-dd6z23"),a(n,"class","network-item manual-entry svelte-dd6z23"),W(n,"selected",l[0]==="manual"),a(e,"class","network-list svelte-dd6z23"),a(v,"for","wifi-password"),a(v,"class","svelte-dd6z23"),a(g,"type","button"),a(g,"class","toggle-password svelte-dd6z23"),a(h,"class","password-input-group svelte-dd6z23"),a(w,"class","field-hint svelte-dd6z23"),W(w,"valid",l[2].length>=8),a(m,"class","form-group svelte-dd6z23")},m(j,J){z(j,e,J);for(let K=0;K<L.length;K+=1)L[K]&&L[K].m(e,null);i(e,t),i(e,n),i(n,s),i(s,o),i(n,c),i(n,u),z(j,f,J),N&&N.m(j,J),z(j,p,J),z(j,m,J),i(m,v),i(m,_),i(m,h),B.m(h,null),i(h,k),i(h,g),i(g,S),i(m,C),i(m,w),i(w,I),i(w,O),q||(E=[M(n,"click",l[26]),M(g,"click",l[30])],q=!0)},p(j,J){if(J[0]&1049089){P=Le(j[9]);let K;for(K=0;K<P.length;K+=1){const $=yl(j,P,K);L[K]?L[K].p($,J):(L[K]=ql($),L[K].c(),L[K].m(e,t))}for(;K<L.length;K+=1)L[K].d(1);L.length=P.length}J[0]&1&&r!==(r=j[0]==="manual"?"â—‰":"â—‹")&&D(o,r),J[0]&1&&W(n,"selected",j[0]==="manual"),j[0]==="manual"?N?N.p(j,J):(N=Al(j),N.c(),N.m(p.parentNode,p)):N&&(N.d(1),N=null),F===(F=V(j))&&B?B.p(j,J):(B.d(1),B=F(j),B&&(B.c(),B.m(h,k))),J[0]&4096&&y!==(y=j[12]?"Hide":"Show")&&D(S,y),J[0]&4&&R!==(R=j[2].length+"")&&D(I,R),J[0]&4&&W(w,"valid",j[2].length>=8)},i:Y,o:Y,d(j){j&&(T(e),T(f),T(p),T(m)),Ge(L,j),N&&N.d(j),B.d(),q=!1,de(E)}}}function yr(l){let e,t,n,s,r,o,c;return{c(){e=d("div"),t=d("p"),n=A(l[10]),s=b(),r=d("button"),r.textContent="Retry Scan",a(t,"class","svelte-dd6z23"),a(r,"class","btn-secondary svelte-dd6z23"),a(e,"class","error-box svelte-dd6z23")},m(u,f){z(u,e,f),i(e,t),i(t,n),i(e,s),i(e,r),o||(c=M(r,"click",l[19]),o=!0)},p(u,f){f[0]&1024&&D(n,u[10])},i:Y,o:Y,d(u){u&&T(e),o=!1,c()}}}function Sr(l){let e,t,n,s,r;return t=new Ne({}),{c(){e=d("div"),ce(t.$$.fragment),n=b(),s=d("p"),s.textContent="Scanning for networks...",a(e,"class","loading-container svelte-dd6z23")},m(o,c){z(o,e,c),ie(t,e,null),i(e,n),i(e,s),r=!0},p:Y,i(o){r||(Q(t.$$.fragment,o),r=!0)},o(o){X(t.$$.fragment,o),r=!1},d(o){o&&T(e),oe(t)}}}function ql(l){let e,t,n=l[0]===l[44].ssid?"â—‰":"â—‹",s,r,o,c=l[44].ssid+"",u,f,p,m,v,_,h=Nl(Rl(l[44].rssi))+"",k,g,y;function S(){return l[25](l[44])}return{c(){e=d("button"),t=d("span"),s=A(n),r=b(),o=d("span"),u=A(c),f=b(),p=d("span"),m=d("span"),m.textContent="ðŸ“¶",v=b(),_=d("span"),k=A(h),a(t,"class","network-radio svelte-dd6z23"),a(o,"class","network-name svelte-dd6z23"),a(m,"class","signal-label svelte-dd6z23"),a(_,"class","signal-bars svelte-dd6z23"),a(p,"class","signal-icon svelte-dd6z23"),a(p,"title","Signal strength"),a(e,"class","network-item svelte-dd6z23"),W(e,"selected",l[0]===l[44].ssid)},m(C,w){z(C,e,w),i(e,t),i(t,s),i(e,r),i(e,o),i(o,u),i(e,f),i(e,p),i(p,m),i(p,v),i(p,_),i(_,k),g||(y=M(e,"click",S),g=!0)},p(C,w){l=C,w[0]&513&&n!==(n=l[0]===l[44].ssid?"â—‰":"â—‹")&&D(s,n),w[0]&512&&c!==(c=l[44].ssid+"")&&D(u,c),w[0]&512&&h!==(h=Nl(Rl(l[44].rssi))+"")&&D(k,h),w[0]&513&&W(e,"selected",l[0]===l[44].ssid)},d(C){C&&T(e),g=!1,y()}}}function Al(l){let e,t,n,s,r,o;return{c(){e=d("div"),t=d("label"),t.textContent="Network Name (SSID)",n=b(),s=d("input"),a(t,"for","manual-ssid"),a(t,"class","svelte-dd6z23"),a(s,"id","manual-ssid"),a(s,"type","text"),a(s,"placeholder","Enter network name"),a(s,"autocomplete","off"),a(s,"class","svelte-dd6z23"),a(e,"class","form-group svelte-dd6z23")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s),ee(s,l[1]),r||(o=M(s,"input",l[27]),r=!0)},p(c,u){u[0]&2&&s.value!==c[1]&&ee(s,c[1])},d(c){c&&T(e),r=!1,o()}}}function Tr(l){let e,t,n;return{c(){e=d("input"),a(e,"id","wifi-password"),a(e,"type","password"),a(e,"placeholder","Enter WiFi password"),a(e,"autocomplete","off"),a(e,"class","svelte-dd6z23")},m(s,r){z(s,e,r),ee(e,l[2]),t||(n=M(e,"input",l[29]),t=!0)},p(s,r){r[0]&4&&e.value!==s[2]&&ee(e,s[2])},d(s){s&&T(e),t=!1,n()}}}function zr(l){let e,t,n;return{c(){e=d("input"),a(e,"id","wifi-password"),a(e,"type","text"),a(e,"placeholder","Enter WiFi password"),a(e,"autocomplete","off"),a(e,"class","svelte-dd6z23")},m(s,r){z(s,e,r),ee(e,l[2]),t||(n=M(e,"input",l[28]),t=!0)},p(s,r){r[0]&4&&e.value!==s[2]&&ee(e,s[2])},d(s){s&&T(e),t=!1,n()}}}function Ll(l){let e,t,n,s,r,o,c,u=l[3]?"Create your account":"Sign in",f,p,m,v,_,h,k,g,y,S,C,w,R,I=l[13]?"Hide":"Show",O,q,E,P,L,N,V,F,B,j,J,K=l[3]?"Create & Activate":"Sign In & Activate",$,se,re,ne,te,fe;function x(U,G){return U[13]?Ar:qr}let H=x(l),Z=H(l);return{c(){e=d("div"),t=d("div"),n=d("button"),n.textContent="Sign In",s=b(),r=d("button"),r.textContent="Create Account",o=b(),c=d("h2"),f=A(u),p=b(),m=d("div"),v=d("label"),v.textContent="Email",_=b(),h=d("input"),k=b(),g=d("div"),y=d("label"),y.textContent="Password",S=b(),C=d("div"),Z.c(),w=b(),R=d("button"),O=A(I),q=b(),E=d("div"),P=d("label"),P.textContent="Name this device",L=b(),N=d("input"),V=b(),F=d("div"),B=d("button"),B.innerHTML='<span class="arrow svelte-dd6z23">â†</span> Back',j=b(),J=d("button"),$=A(K),se=b(),re=d("span"),re.textContent="â†’",a(n,"class","tab-btn svelte-dd6z23"),W(n,"active",!l[3]),a(r,"class","tab-btn svelte-dd6z23"),W(r,"active",l[3]),a(t,"class","account-tabs svelte-dd6z23"),a(c,"class","svelte-dd6z23"),a(v,"for","email"),a(v,"class","svelte-dd6z23"),a(h,"id","email"),a(h,"type","email"),a(h,"placeholder","you@example.com"),a(h,"autocomplete","email"),a(h,"class","svelte-dd6z23"),a(m,"class","form-group svelte-dd6z23"),a(y,"for","account-password"),a(y,"class","svelte-dd6z23"),a(R,"type","button"),a(R,"class","toggle-password svelte-dd6z23"),a(C,"class","password-input-group svelte-dd6z23"),a(g,"class","form-group svelte-dd6z23"),a(P,"for","device-name"),a(P,"class","svelte-dd6z23"),a(N,"id","device-name"),a(N,"type","text"),a(N,"placeholder","Kitchen"),a(N,"autocomplete","off"),a(N,"class","svelte-dd6z23"),a(E,"class","form-group svelte-dd6z23"),a(B,"class","btn-secondary svelte-dd6z23"),a(re,"class","arrow svelte-dd6z23"),a(J,"class","btn-primary svelte-dd6z23"),J.disabled=ne=!l[17],a(F,"class","button-row svelte-dd6z23"),a(e,"class","step account-step svelte-dd6z23")},m(U,G){z(U,e,G),i(e,t),i(t,n),i(t,s),i(t,r),i(e,o),i(e,c),i(c,f),i(e,p),i(e,m),i(m,v),i(m,_),i(m,h),ee(h,l[4]),i(e,k),i(e,g),i(g,y),i(g,S),i(g,C),Z.m(C,null),i(C,w),i(C,R),i(R,O),i(e,q),i(e,E),i(E,P),i(E,L),i(E,N),ee(N,l[6]),i(e,V),i(e,F),i(F,B),i(F,j),i(F,J),i(J,$),i(J,se),i(J,re),te||(fe=[M(n,"click",l[33]),M(r,"click",l[34]),M(h,"input",l[35]),M(R,"click",l[38]),M(N,"input",l[39]),M(B,"click",l[40]),M(J,"click",l[22])],te=!0)},p(U,G){G[0]&8&&W(n,"active",!U[3]),G[0]&8&&W(r,"active",U[3]),G[0]&8&&u!==(u=U[3]?"Create your account":"Sign in")&&D(f,u),G[0]&16&&h.value!==U[4]&&ee(h,U[4]),H===(H=x(U))&&Z?Z.p(U,G):(Z.d(1),Z=H(U),Z&&(Z.c(),Z.m(C,w))),G[0]&8192&&I!==(I=U[13]?"Hide":"Show")&&D(O,I),G[0]&64&&N.value!==U[6]&&ee(N,U[6]),G[0]&8&&K!==(K=U[3]?"Create & Activate":"Sign In & Activate")&&D($,K),G[0]&131072&&ne!==(ne=!U[17])&&(J.disabled=ne)},d(U){U&&T(e),Z.d(),te=!1,de(fe)}}}function qr(l){let e,t,n,s,r;return{c(){e=d("input"),a(e,"id","account-password"),a(e,"type","password"),a(e,"placeholder",t=l[3]?"Create a password":"Enter your password"),a(e,"autocomplete",n=l[3]?"new-password":"current-password"),a(e,"class","svelte-dd6z23")},m(o,c){z(o,e,c),ee(e,l[5]),s||(r=M(e,"input",l[37]),s=!0)},p(o,c){c[0]&8&&t!==(t=o[3]?"Create a password":"Enter your password")&&a(e,"placeholder",t),c[0]&8&&n!==(n=o[3]?"new-password":"current-password")&&a(e,"autocomplete",n),c[0]&32&&e.value!==o[5]&&ee(e,o[5])},d(o){o&&T(e),s=!1,r()}}}function Ar(l){let e,t,n,s,r;return{c(){e=d("input"),a(e,"id","account-password"),a(e,"type","text"),a(e,"placeholder",t=l[3]?"Create a password":"Enter your password"),a(e,"autocomplete",n=l[3]?"new-password":"current-password"),a(e,"class","svelte-dd6z23")},m(o,c){z(o,e,c),ee(e,l[5]),s||(r=M(e,"input",l[36]),s=!0)},p(o,c){c[0]&8&&t!==(t=o[3]?"Create a password":"Enter your password")&&a(e,"placeholder",t),c[0]&8&&n!==(n=o[3]?"new-password":"current-password")&&a(e,"autocomplete",n),c[0]&32&&e.value!==o[5]&&ee(e,o[5])},d(o){o&&T(e),s=!1,r()}}}function El(l){let e,t,n,s,r=Le(l[16]),o=[];for(let c=0;c<r.length;c+=1)o[c]=Il(Cl(l,r,c));return{c(){e=d("div"),t=d("h2"),t.textContent="Setting up your device...",n=b(),s=d("div");for(let c=0;c<o.length;c+=1)o[c].c();a(t,"class","svelte-dd6z23"),a(s,"class","progress-list svelte-dd6z23"),a(e,"class","step progress-step svelte-dd6z23")},m(c,u){z(c,e,u),i(e,t),i(e,n),i(e,s);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(s,null)},p(c,u){if(u[0]&65536){r=Le(c[16]);let f;for(f=0;f<r.length;f+=1){const p=Cl(c,r,f);o[f]?o[f].p(p,u):(o[f]=Il(p),o[f].c(),o[f].m(s,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=r.length}},d(c){c&&T(e),Ge(o,c)}}}function Fl(l){let e;return{c(){e=d("span"),a(e,"class","progress-spinner svelte-dd6z23")},m(t,n){z(t,e,n)},d(t){t&&T(e)}}}function Il(l){let e,t,n=Ml(l[41].status)+"",s,r,o,c=l[41].label+"",u,f,p,m=l[41].status==="in_progress"&&Fl();return{c(){e=d("div"),t=d("span"),s=A(n),r=b(),o=d("span"),u=A(c),f=b(),m&&m.c(),p=b(),a(t,"class","progress-icon svelte-dd6z23"),a(o,"class","progress-label svelte-dd6z23"),a(e,"class","progress-item svelte-dd6z23"),W(e,"completed",l[41].status==="completed"),W(e,"in-progress",l[41].status==="in_progress"),W(e,"failed",l[41].status==="failed")},m(v,_){z(v,e,_),i(e,t),i(t,s),i(e,r),i(e,o),i(o,u),i(e,f),m&&m.m(e,null),i(e,p)},p(v,_){_[0]&65536&&n!==(n=Ml(v[41].status)+"")&&D(s,n),_[0]&65536&&c!==(c=v[41].label+"")&&D(u,c),v[41].status==="in_progress"?m||(m=Fl(),m.c(),m.m(e,p)):m&&(m.d(1),m=null),_[0]&65536&&W(e,"completed",v[41].status==="completed"),_[0]&65536&&W(e,"in-progress",v[41].status==="in_progress"),_[0]&65536&&W(e,"failed",v[41].status==="failed")},d(v){v&&T(e),m&&m.d()}}}function Ol(l){let e;function t(r,o){return r[14]?Er:Lr}let n=t(l),s=n(l);return{c(){s.c(),e=ze()},m(r,o){s.m(r,o),z(r,e,o)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){r&&T(e),s.d(r)}}}function Lr(l){let e,t,n,s,r,o,c,u,f,p,m;return{c(){e=d("div"),t=d("div"),t.innerHTML='<span role="img" aria-label="error">âŒ</span>',n=b(),s=d("h2"),s.textContent="Setup Failed",r=b(),o=d("p"),c=A(l[15]),u=b(),f=d("button"),f.textContent="Try Again",a(t,"class","result-icon error svelte-dd6z23"),a(s,"class","svelte-dd6z23"),a(o,"class","error-message svelte-dd6z23"),a(f,"class","btn-primary btn-large svelte-dd6z23"),a(e,"class","step error-step svelte-dd6z23")},m(v,_){z(v,e,_),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(o,c),i(e,u),i(e,f),p||(m=M(f,"click",l[23]),p=!0)},p(v,_){_[0]&32768&&D(c,v[15])},d(v){v&&T(e),p=!1,m()}}}function Er(l){let e,t,n,s,r,o,c,u,f,p,m,v,_;return{c(){e=d("div"),t=d("div"),t.innerHTML='<span role="img" aria-label="success">âœ…</span>',n=b(),s=d("h2"),s.textContent="You're all set!",r=b(),o=d("p"),c=A('Your device "'),u=A(l[6]),f=A('" is now connected and monitoring.'),p=b(),m=d("div"),m.innerHTML='<p class="svelte-dd6z23">Access your dashboard at:</p> <a href="https://dashboard.mousetrap.com" class="dashboard-link svelte-dd6z23" target="_blank" rel="noopener noreferrer">https://dashboard.mousetrap.com</a>',v=b(),_=d("p"),_.innerHTML=`This page will close automatically.<br/>
            Your device is now connected to your home WiFi.`,a(t,"class","result-icon success svelte-dd6z23"),a(s,"class","svelte-dd6z23"),a(o,"class","result-text svelte-dd6z23"),a(m,"class","dashboard-link-box svelte-dd6z23"),a(_,"class","auto-close-text svelte-dd6z23"),a(e,"class","step success-step svelte-dd6z23")},m(h,k){z(h,e,k),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(o,c),i(o,u),i(o,f),i(e,p),i(e,m),i(e,v),i(e,_)},p(h,k){k[0]&64&&D(u,h[6])},d(h){h&&T(e)}}}function Fr(l){let e,t,n,s,r,o,c,u,f=l[7]<5&&Sl(l),p=l[7]===1&&Tl(l),m=l[7]===2&&zl(l),v=l[7]===3&&Ll(l),_=l[7]===4&&El(l),h=l[7]===5&&Ol(l);return{c(){e=d("div"),t=d("div"),f&&f.c(),n=b(),p&&p.c(),s=b(),m&&m.c(),r=b(),v&&v.c(),o=b(),_&&_.c(),c=b(),h&&h.c(),a(t,"class","setup-card svelte-dd6z23"),a(e,"class","setup-container svelte-dd6z23")},m(k,g){z(k,e,g),i(e,t),f&&f.m(t,null),i(t,n),p&&p.m(t,null),i(t,s),m&&m.m(t,null),i(t,r),v&&v.m(t,null),i(t,o),_&&_.m(t,null),i(t,c),h&&h.m(t,null),u=!0},p(k,g){k[7]<5?f?f.p(k,g):(f=Sl(k),f.c(),f.m(t,n)):f&&(f.d(1),f=null),k[7]===1?p?(p.p(k,g),g[0]&128&&Q(p,1)):(p=Tl(k),p.c(),Q(p,1),p.m(t,s)):p&&(we(),X(p,1,1,()=>{p=null}),Ce()),k[7]===2?m?(m.p(k,g),g[0]&128&&Q(m,1)):(m=zl(k),m.c(),Q(m,1),m.m(t,r)):m&&(we(),X(m,1,1,()=>{m=null}),Ce()),k[7]===3?v?v.p(k,g):(v=Ll(k),v.c(),v.m(t,o)):v&&(v.d(1),v=null),k[7]===4?_?_.p(k,g):(_=El(k),_.c(),_.m(t,c)):_&&(_.d(1),_=null),k[7]===5?h?h.p(k,g):(h=Ol(k),h.c(),h.m(t,null)):h&&(h.d(1),h=null)},i(k){u||(Q(p),Q(m),u=!0)},o(k){X(p),X(m),u=!1},d(k){k&&T(e),f&&f.d(),p&&p.d(),m&&m.d(),v&&v.d(),_&&_.d(),h&&h.d()}}}const Pl=5;function Rl(l){return l>=-50?4:l>=-60?3:l>=-70?2:1}function Nl(l){const e="â–ˆ",t="â–‘";let n="";for(let s=0;s<4;s++)n+=s<l?e:t;return n}function Ml(l){switch(l){case"completed":return"âœ“";case"in_progress":return"â³";case"failed":return"âœ—";default:return"â—‹"}}function Ir(l,e,t){let n,s,r,o=1,c=!1,u=[],f=null,p=!1,m=null,v="",_="",h=!1,k=!1,g="",y="",S=!1,C="",w=!1,R=null;Pe(()=>{});async function I(){t(11,p=!0),t(10,f=null);try{console.log("[SETUP] Loading networks...");const U=await Js();console.log("[SETUP] Scan result:",JSON.stringify(U)),t(9,u=U.networks||[]),console.log("[SETUP] Networks set to:",u.length,"items")}catch(U){console.error("[SETUP] Scan error:",U),t(10,f=U.message||"Failed to scan WiFi networks"),t(9,u=[])}finally{t(11,p=!1)}}function O(U){t(0,m=U),U!=="manual"&&t(1,v="")}async function q(U){t(8,c=!0);try{U===2&&await I(),t(7,o=U)}finally{t(8,c=!1)}}async function E(){t(7,o=4),t(14,w=!1),t(15,R=null);const U=m==="manual"?v:m;t(16,n=n.map(G=>G.id==="wifi"?{...G,status:"in_progress"}:G));try{await Qs({ssid:U,password:_,email:g,accountPassword:y,deviceName:C,isNewAccount:k}),t(16,n=n.map(G=>G.id==="wifi"?{...G,status:"completed"}:G)),t(16,n=n.map(G=>G.id==="account"?{...G,status:"in_progress"}:G)),await new Promise(G=>setTimeout(G,1500)),t(16,n=n.map(G=>G.id==="account"?{...G,status:"completed"}:G)),t(16,n=n.map(G=>G.id==="activate"?{...G,status:"in_progress"}:G)),await new Promise(G=>setTimeout(G,2e3)),t(16,n=n.map(G=>G.id==="activate"?{...G,status:"completed"}:G)),t(14,w=!0),t(7,o=5)}catch(G){t(15,R=G.message||"Setup failed. Please try again."),t(16,n=n.map(qe=>qe.status==="in_progress"?{...qe,status:"failed"}:qe)),t(7,o=5)}}function P(){t(7,o=1),t(0,m=null),t(1,v=""),t(2,_=""),t(4,g=""),t(5,y=""),t(6,C=""),t(14,w=!1),t(15,R=null),t(16,n=[{id:"wifi",label:"Connecting to WiFi",status:"pending"},{id:"account",label:"Creating your account",status:"pending"},{id:"activate",label:"Activating device",status:"pending"}])}const L=()=>q(2),N=U=>O(U.ssid),V=()=>O("manual");function F(){v=this.value,t(1,v)}function B(){_=this.value,t(2,_)}function j(){_=this.value,t(2,_)}const J=()=>t(12,h=!h),K=()=>t(7,o=1),$=()=>t(7,o=3),se=()=>t(3,k=!1),re=()=>t(3,k=!0);function ne(){g=this.value,t(4,g)}function te(){y=this.value,t(5,y)}function fe(){y=this.value,t(5,y)}const x=()=>t(13,S=!S);function H(){C=this.value,t(6,C)}const Z=()=>t(7,o=2);return l.$$.update=()=>{l.$$.dirty[0]&8&&t(16,n=[{id:"wifi",label:"Connecting to WiFi",status:"pending"},{id:"account",label:k?"Creating account":"Signing in",status:"pending"},{id:"activate",label:"Activating device",status:"pending"}]),l.$$.dirty[0]&7&&t(18,s=(m||v.trim())&&(m!=="manual"||v.trim())&&_.length>=8),l.$$.dirty[0]&112&&t(17,r=g.trim()&&y.trim()&&C.trim())},[m,v,_,k,g,y,C,o,c,u,f,p,h,S,w,R,n,r,s,I,O,q,E,P,L,N,V,F,B,j,J,K,$,se,re,ne,te,fe,x,H,Z]}class Or extends Se{constructor(e){super(),ye(this,e,Ir,Fr,ge,{},null,[-1,-1])}}function Pr(l){let e,t;return e=new ks({props:{$$slots:{default:[Nr]},$$scope:{ctx:l}}}),{c(){ce(e.$$.fragment)},m(n,s){ie(e,n,s),t=!0},p(n,s){const r={};s&18&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(Q(e.$$.fragment,n),t=!0)},o(n){X(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Rr(l){let e,t,n;var s=l[1];function r(o,c){return{}}return s&&(e=st(s,r())),{c(){e&&ce(e.$$.fragment),t=ze()},m(o,c){e&&ie(e,o,c),z(o,t,c),n=!0},p(o,c){if(c&2&&s!==(s=o[1])){if(e){we();const u=e;X(u.$$.fragment,1,0,()=>{oe(u,1)}),Ce()}s?(e=st(s,r()),ce(e.$$.fragment),Q(e.$$.fragment,1),ie(e,t.parentNode,t)):e=null}},i(o){n||(e&&Q(e.$$.fragment,o),n=!0)},o(o){e&&X(e.$$.fragment,o),n=!1},d(o){o&&T(t),e&&oe(e,o)}}}function Nr(l){let e,t,n;var s=l[1];function r(o,c){return{}}return s&&(e=st(s,r())),{c(){e&&ce(e.$$.fragment),t=ze()},m(o,c){e&&ie(e,o,c),z(o,t,c),n=!0},p(o,c){if(c&2&&s!==(s=o[1])){if(e){we();const u=e;X(u.$$.fragment,1,0,()=>{oe(u,1)}),Ce()}s?(e=st(s,r()),ce(e.$$.fragment),Q(e.$$.fragment,1),ie(e,t.parentNode,t)):e=null}},i(o){n||(e&&Q(e.$$.fragment,o),n=!0)},o(o){e&&X(e.$$.fragment,o),n=!1},d(o){o&&T(t),e&&oe(e,o)}}}function Mr(l){let e,t,n,s;const r=[Rr,Pr],o=[];function c(u,f){return u[0]?0:1}return e=c(l),t=o[e]=r[e](l),{c(){t.c(),n=ze()},m(u,f){o[e].m(u,f),z(u,n,f),s=!0},p(u,[f]){let p=e;e=c(u),e===p?o[e].p(u,f):(we(),X(o[p],1,1,()=>{o[p]=null}),Ce(),t=o[e],t?t.p(u,f):(t=o[e]=r[e](u),t.c()),Q(t,1),t.m(n.parentNode,n))},i(u){s||(Q(t),s=!0)},o(u){X(t),s=!1},d(u){u&&T(n),o[e].d(u)}}}function jr(l,e,t){let n,s,r;lt(l,ht,c=>t(2,r=c));function o(c){const u=c.startsWith("/")?c:"/"+c;return u==="/"||u===""?Rt:u==="/gallery"?yn:u==="/calibration"?qn:u==="/servo"?Fn:u==="/settings"?Un:u==="/logs"||u==="/status"?cl:u==="/firmware"||u.startsWith("/reboot")?kl:u==="/test"?gr:u==="/setup"?Or:Rt}return l.$$.update=()=>{l.$$.dirty&4&&t(1,n=o(r)),l.$$.dirty&4&&t(0,s=r==="/setup"||r==="setup")},[s,n,r]}class Dr extends Se{constructor(e){super(),ye(this,e,jr,Mr,ge,{})}}const Ze=(...l)=>console.log("[JS]",...l);function jl(l){Ze("app-main: FATAL",l);const e=document.getElementById("app");e&&e.childElementCount===0&&(e.innerHTML=`
      <div style="font: 14px system-ui, sans-serif; color:#ddd; background:#111; padding:16px; line-height:1.35">
        <div style="font-weight:600; margin-bottom:8px; color:#ff6b6b">âš ï¸ App failed to load</div>
        <div style="opacity:.85; margin-bottom:8px">Check console for full stack. Error:</div>
        <pre style="white-space:pre-wrap; background:#181818; border:1px solid #ff6b6b; padding:12px; border-radius:6px; overflow:auto; color:#ffcccc">
${String(l&&(l.stack||l.message)||l)}
        </pre>
      </div>`)}window.addEventListener("error",l=>Ze("global-error:",l.message||l.error));window.addEventListener("unhandledrejection",l=>Ze("unhandled-rejection:",l.reason));(function(){Ze("app-main: start");const e=document.getElementById("app");if(!e){jl("Missing #app container in HTML");return}try{const t=new Dr({target:e});window.__MOUSETRAP_APP={ok:!0,mountedAt:Date.now(),app:t},Ze("app-main: mounted OK")}catch(t){window.__MOUSETRAP_APP={ok:!1,error:t,when:Date.now()},jl(t)}})();
