var Nn=Object.defineProperty;var Pn=(l,e,t)=>e in l?Nn(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var Xt=(l,e,t)=>Pn(l,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function V(){}function On(l,e){for(const t in e)l[t]=e[t];return l}function Mn(l){return!!l&&(typeof l=="object"||typeof l=="function")&&typeof l.then=="function"}function vn(l){return l()}function ul(){return Object.create(null)}function Ae(l){l.forEach(vn)}function Zt(l){return typeof l=="function"}function Xe(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let Wt;function Lt(l,e){return l===e?!0:(Wt||(Wt=document.createElement("a")),Wt.href=e,l===Wt.href)}function Rn(l){return Object.keys(l).length===0}function _n(l,...e){if(l==null){for(const n of e)n(void 0);return V}const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Gt(l,e,t){l.$$.on_destroy.push(_n(e,t))}function el(l,e,t,n){if(l){const s=bn(l,e,t,n);return l[0](s)}}function bn(l,e,t,n){return l[1]&&n?On(t.ctx.slice(),l[1](n(e))):t.ctx}function tl(l,e,t,n){if(l[2]&&n){const s=l[2](n(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],o=Math.max(e.dirty.length,s.length);for(let a=0;a<o;a+=1)r[a]=e.dirty[a]|s[a];return r}return e.dirty|s}return e.dirty}function ll(l,e,t,n,s,r){if(s){const o=bn(e,t,n,r);l.p(o,s)}}function sl(l){if(l.ctx.length>32){const e=[],t=l.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function kt(l){return l&&Zt(l.destroy)?l.destroy:V}const gn=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function i(l,e){l.appendChild(e)}function w(l,e,t){l.insertBefore(e,t||null)}function k(l){l.parentNode&&l.parentNode.removeChild(l)}function qt(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function d(l){return document.createElement(l)}function C(l){return document.createTextNode(l)}function b(){return C(" ")}function $e(){return C("")}function A(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function jt(l){return function(e){return e.preventDefault(),l.call(this,e)}}function hn(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function c(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function gt(l){return l===""?null:+l}function Dn(l){return Array.from(l.childNodes)}function O(l,e){e=""+e,l.data!==e&&(l.data=e)}function ce(l,e){l.value=e??""}function ut(l,e,t,n){t==null?l.style.removeProperty(e):l.style.setProperty(e,t,"")}function fl(l,e,t){for(let n=0;n<l.options.length;n+=1){const s=l.options[n];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(l.selectedIndex=-1)}function Un(l){const e=l.querySelector(":checked");return e&&e.__value}function j(l,e,t){l.classList.toggle(e,!!t)}function Jt(l,e){return new l(e)}let Dt;function St(l){Dt=l}function rl(){if(!Dt)throw new Error("Function called outside component initialization");return Dt}function ht(l){rl().$$.on_mount.push(l)}function It(l){rl().$$.on_destroy.push(l)}function dl(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const Ot=[],Et=[];let Mt=[];const pl=[],Hn=Promise.resolve();let nl=!1;function Wn(){nl||(nl=!0,Hn.then(il))}function Kt(l){Mt.push(l)}const $t=new Set;let Nt=0;function il(){if(Nt!==0)return;const l=Dt;do{try{for(;Nt<Ot.length;){const e=Ot[Nt];Nt++,St(e),jn(e.$$)}}catch(e){throw Ot.length=0,Nt=0,e}for(St(null),Ot.length=0,Nt=0;Et.length;)Et.pop()();for(let e=0;e<Mt.length;e+=1){const t=Mt[e];$t.has(t)||($t.add(t),t())}Mt.length=0}while(Ot.length);for(;pl.length;)pl.pop()();nl=!1,$t.clear(),St(l)}function jn(l){if(l.fragment!==null){l.update(),Ae(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Kt)}}function zn(l){const e=[],t=[];Mt.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Mt=e}const Vt=new Set;let At;function Le(){At={r:0,c:[],p:At}}function Ee(){At.r||Ae(At.c),At=At.p}function z(l,e){l&&l.i&&(Vt.delete(l),l.i(e))}function J(l,e,t,n){if(l&&l.o){if(Vt.has(l))return;Vt.add(l),At.c.push(()=>{Vt.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function Yt(l,e){const t=e.token={};function n(s,r,o,a){if(e.token!==t)return;e.resolved=a;let u=e.ctx;o!==void 0&&(u=u.slice(),u[o]=a);const f=s&&(e.current=s)(u);let p=!1;e.block&&(e.blocks?e.blocks.forEach((m,v)=>{v!==r&&m&&(Le(),J(m,1,1,()=>{e.blocks[v]===m&&(e.blocks[v]=null)}),Ee())}):e.block.d(1),f.c(),z(f,1),f.m(e.mount(),e.anchor),p=!0),e.block=f,e.blocks&&(e.blocks[r]=f),p&&il()}if(Mn(l)){const s=rl();if(l.then(r=>{St(s),n(e.then,1,e.value,r),St(null)},r=>{if(St(s),n(e.catch,2,e.error,r),St(null),!e.hasCatch)throw r}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,l),!0;e.resolved=l}}function kn(l,e,t){const n=e.slice(),{resolved:s}=l;l.current===l.then&&(n[l.value]=s),l.current===l.catch&&(n[l.error]=s),l.block.p(n,t)}function Ue(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function _e(l){l&&l.c()}function pe(l,e,t){const{fragment:n,after_update:s}=l.$$;n&&n.m(e,t),Kt(()=>{const r=l.$$.on_mount.map(vn).filter(Zt);l.$$.on_destroy?l.$$.on_destroy.push(...r):Ae(r),l.$$.on_mount=[]}),s.forEach(Kt)}function me(l,e){const t=l.$$;t.fragment!==null&&(zn(t.after_update),Ae(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Bn(l,e){l.$$.dirty[0]===-1&&(Ot.push(l),Wn(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function et(l,e,t,n,s,r,o=null,a=[-1]){const u=Dt;St(l);const f=l.$$={fragment:null,ctx:[],props:r,update:V,not_equal:s,bound:ul(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:ul(),dirty:a,skip_bound:!1,root:e.target||u.$$.root};o&&o(f.root);let p=!1;if(f.ctx=t?t(l,e.props||{},(m,v,..._)=>{const h=_.length?_[0]:v;return f.ctx&&s(f.ctx[m],f.ctx[m]=h)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](h),p&&Bn(l,m)),v}):[],f.update(),p=!0,Ae(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const m=Dn(e.target);f.fragment&&f.fragment.l(m),m.forEach(k)}else f.fragment&&f.fragment.c();e.intro&&z(l.$$.fragment),pe(l,e.target,e.anchor),il()}St(u)}class tt{constructor(){Xt(this,"$$");Xt(this,"$$set")}$destroy(){me(this,1),this.$destroy=V}$on(e,t){if(!Zt(t))return V;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!Rn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Vn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Vn);const Pt=[];function Gn(l,e){return{subscribe:Ht(l,e).subscribe}}function Ht(l,e=V){let t;const n=new Set;function s(a){if(Xe(l,a)&&(l=a,t)){const u=!Pt.length;for(const f of n)f[1](),Pt.push(f,l);if(u){for(let f=0;f<Pt.length;f+=2)Pt[f][0](Pt[f+1]);Pt.length=0}}}function r(a){s(a(l))}function o(a,u=V){const f=[a,u];return n.add(f),n.size===1&&(t=e(s,r)||V),a(l),()=>{n.delete(f),n.size===0&&t&&(t(),t=null)}}return{set:s,update:r,subscribe:o}}function wn(l,e,t){const n=!Array.isArray(l),s=n?[l]:l;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return Gn(t,(o,a)=>{let u=!1;const f=[];let p=0,m=V;const v=()=>{if(p)return;m();const h=e(n?f[0]:f,o,a);r?o(h):m=Zt(h)?h:V},_=s.map((h,g)=>_n(h,q=>{f[g]=q,p&=~(1<<g),u&&v()},()=>{p|=1<<g}));return u=!0,v(),function(){Ae(_),m(),u=!1}})}const qn=Ht({threshold:0,sensorReading:0,detectionState:!1,uptime:"",wifiRSSI:0,heap:0,psram:0,lastUpdate:null}),Rt=Ht(!1);function Jn(l,e){const t=localStorage.getItem(l),n=t?JSON.parse(t):e,{subscribe:s,set:r,update:o}=Ht(n);return{subscribe:s,set:a=>{localStorage.setItem(l,JSON.stringify(a)),r(a)},update:a=>{o(u=>{const f=a(u);return localStorage.setItem(l,JSON.stringify(f)),f})}}}Jn("mousetrap-prefs",{theme:"dark",refreshInterval:5e3});wn(qn,l=>l.detectionState);wn(qn,l=>l.lastUpdate?l.detectionState?"red":"green":"gray");const ol=Ht(window.location.hash.slice(1)||"/");window.addEventListener("hashchange",()=>{const l=window.location.hash.slice(1)||"/";ol.set(l)});function Kn(l){window.location.hash=l}function wt(l){function e(t){const n=l.getAttribute("href");n&&n.startsWith("#/")&&(t.preventDefault(),Kn(n.slice(1)))}return l.addEventListener("click",e),{destroy(){l.removeEventListener("click",e)}}}function ml(l){let e,t,n,s,r,o;return{c(){e=d("div"),t=d("a"),t.textContent="Gallery",n=b(),s=d("a"),s.textContent="Settings",c(t,"href","#/gallery"),c(t,"class","svelte-1n65rh9"),j(t,"active",l[0]==="/gallery"),c(s,"href","#/camera-settings"),c(s,"class","svelte-1n65rh9"),j(s,"active",l[0]==="/camera-settings"),c(e,"class","submenu svelte-1n65rh9")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),r||(o=[kt(wt.call(null,t)),A(t,"click",l[6]),kt(wt.call(null,s)),A(s,"click",l[6])],r=!0)},p(a,u){u&1&&j(t,"active",a[0]==="/gallery"),u&1&&j(s,"active",a[0]==="/camera-settings")},d(a){a&&k(e),r=!1,Ae(o)}}}function vl(l){let e,t,n,s,r,o;return{c(){e=d("div"),t=d("a"),t.textContent="WiFi",n=b(),s=d("a"),s.textContent="Registration",c(t,"href","#/wifi"),c(t,"class","svelte-1n65rh9"),j(t,"active",l[0]==="/wifi"),c(s,"href","#/claim"),c(s,"class","svelte-1n65rh9"),j(s,"active",l[0]==="/claim"),c(e,"class","submenu svelte-1n65rh9")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),r||(o=[kt(wt.call(null,t)),A(t,"click",l[6]),kt(wt.call(null,s)),A(s,"click",l[6])],r=!0)},p(a,u){u&1&&j(t,"active",a[0]==="/wifi"),u&1&&j(s,"active",a[0]==="/claim")},d(a){a&&k(e),r=!1,Ae(o)}}}function _l(l){let e,t,n,s,r,o;return{c(){e=d("div"),t=d("a"),t.textContent="Servo",n=b(),s=d("a"),s.textContent="Sensor Calibration",c(t,"href","#/servo"),c(t,"class","svelte-1n65rh9"),j(t,"active",l[0]==="/servo"),c(s,"href","#/calibration"),c(s,"class","svelte-1n65rh9"),j(s,"active",l[0]==="/calibration"),c(e,"class","submenu svelte-1n65rh9")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),r||(o=[kt(wt.call(null,t)),A(t,"click",l[6]),kt(wt.call(null,s)),A(s,"click",l[6])],r=!0)},p(a,u){u&1&&j(t,"active",a[0]==="/servo"),u&1&&j(s,"active",a[0]==="/calibration")},d(a){a&&k(e),r=!1,Ae(o)}}}function bl(l){let e,t,n,s,r,o,a,u,f,p;return{c(){e=d("div"),t=d("a"),t.textContent="Status",n=b(),s=d("a"),s.textContent="Logs",r=b(),o=d("a"),o.textContent="Firmware & OTA",a=b(),u=d("a"),u.textContent="Test Alert",c(t,"href","#/system-status"),c(t,"class","svelte-1n65rh9"),j(t,"active",l[0]==="/system-status"),c(s,"href","#/logs"),c(s,"class","svelte-1n65rh9"),j(s,"active",l[0]==="/logs"),c(o,"href","#/firmware"),c(o,"class","svelte-1n65rh9"),j(o,"active",l[0]==="/firmware"),c(u,"href","#/test"),c(u,"class","svelte-1n65rh9"),j(u,"active",l[0]==="/test"),c(e,"class","submenu svelte-1n65rh9")},m(m,v){w(m,e,v),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(e,a),i(e,u),f||(p=[kt(wt.call(null,t)),A(t,"click",l[6]),kt(wt.call(null,s)),A(s,"click",l[6]),kt(wt.call(null,o)),A(o,"click",l[6]),kt(wt.call(null,u)),A(u,"click",l[6])],f=!0)},p(m,v){v&1&&j(t,"active",m[0]==="/system-status"),v&1&&j(s,"active",m[0]==="/logs"),v&1&&j(o,"active",m[0]==="/firmware"),v&1&&j(u,"active",m[0]==="/test")},d(m){m&&k(e),f=!1,Ae(p)}}}function gl(l){let e,t,n;return{c(){e=d("div"),c(e,"class","backdrop svelte-1n65rh9")},m(s,r){w(s,e,r),t||(n=A(e,"click",l[6]),t=!0)},p:V,d(s){s&&k(e),t=!1,n()}}}function Yn(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S,y,F,N,M,L,E,P,K,I=l[1]&&ml(l),U=l[2]&&vl(l),H=l[3]&&_l(l),R=l[4]&&bl(l),Y=l[5]&&gl(l);return{c(){e=d("div"),t=d("a"),t.textContent="Home",n=b(),s=d("a"),r=C(`Camera
    `),o=d("span"),o.textContent="â–¸",a=b(),I&&I.c(),u=b(),f=d("a"),p=C(`Network
    `),m=d("span"),m.textContent="â–¸",v=b(),U&&U.c(),_=b(),h=d("a"),g=C(`Device
    `),q=d("span"),q.textContent="â–¸",T=b(),H&&H.c(),S=b(),y=d("a"),F=C(`System
    `),N=d("span"),N.textContent="â–¸",M=b(),R&&R.c(),L=b(),Y&&Y.c(),E=$e(),c(t,"href","#/"),c(t,"class","svelte-1n65rh9"),j(t,"active",l[0]==="/"),c(o,"class","arrow svelte-1n65rh9"),j(o,"expanded",l[1]),c(s,"href","#"),c(s,"class","parent svelte-1n65rh9"),c(m,"class","arrow svelte-1n65rh9"),j(m,"expanded",l[2]),c(f,"href","#"),c(f,"class","parent svelte-1n65rh9"),c(q,"class","arrow svelte-1n65rh9"),j(q,"expanded",l[3]),c(h,"href","#"),c(h,"class","parent svelte-1n65rh9"),c(N,"class","arrow svelte-1n65rh9"),j(N,"expanded",l[4]),c(y,"href","#"),c(y,"class","parent svelte-1n65rh9"),c(e,"class","menu svelte-1n65rh9"),j(e,"open",l[5])},m(W,B){w(W,e,B),i(e,t),i(e,n),i(e,s),i(s,r),i(s,o),i(e,a),I&&I.m(e,null),i(e,u),i(e,f),i(f,p),i(f,m),i(e,v),U&&U.m(e,null),i(e,_),i(e,h),i(h,g),i(h,q),i(e,T),H&&H.m(e,null),i(e,S),i(e,y),i(y,F),i(y,N),i(e,M),R&&R.m(e,null),w(W,L,B),Y&&Y.m(W,B),w(W,E,B),P||(K=[kt(wt.call(null,t)),A(t,"click",l[6]),A(s,"click",jt(l[8])),A(f,"click",jt(l[9])),A(h,"click",jt(l[10])),A(y,"click",jt(l[11]))],P=!0)},p(W,[B]){B&1&&j(t,"active",W[0]==="/"),B&2&&j(o,"expanded",W[1]),W[1]?I?I.p(W,B):(I=ml(W),I.c(),I.m(e,u)):I&&(I.d(1),I=null),B&4&&j(m,"expanded",W[2]),W[2]?U?U.p(W,B):(U=vl(W),U.c(),U.m(e,_)):U&&(U.d(1),U=null),B&8&&j(q,"expanded",W[3]),W[3]?H?H.p(W,B):(H=_l(W),H.c(),H.m(e,S)):H&&(H.d(1),H=null),B&16&&j(N,"expanded",W[4]),W[4]?R?R.p(W,B):(R=bl(W),R.c(),R.m(e,null)):R&&(R.d(1),R=null),B&32&&j(e,"open",W[5]),W[5]?Y?Y.p(W,B):(Y=gl(W),Y.c(),Y.m(E.parentNode,E)):Y&&(Y.d(1),Y=null)},i:V,o:V,d(W){W&&(k(e),k(L),k(E)),I&&I.d(),U&&U.d(),H&&H.d(),R&&R.d(),Y&&Y.d(W),P=!1,Ae(K)}}}function Qn(l,e,t){let n,s;Gt(l,ol,g=>t(0,n=g)),Gt(l,Rt,g=>t(5,s=g));let r=!1,o=!1,a=!1,u=!1;function f(){Rt.set(!1)}function p(g){g==="camera"&&t(1,r=!r),g==="network"&&t(2,o=!o),g==="device"&&t(3,a=!a),g==="system"&&t(4,u=!u)}const m=()=>p("camera"),v=()=>p("network"),_=()=>p("device"),h=()=>p("system");return l.$$.update=()=>{if(l.$$.dirty&1){const g=n;t(1,r=g.startsWith("/gallery")||g.startsWith("/camera-settings")),t(2,o=g.startsWith("/wifi")||g.startsWith("/claim")),t(3,a=g.startsWith("/servo")||g.startsWith("/calibration")),t(4,u=g.startsWith("/logs")||g.startsWith("/firmware")||g.startsWith("/reboot")||g.startsWith("/test")||g.startsWith("/system-status"))}},[n,r,o,a,u,s,f,p,m,v,_,h]}class Zn extends tt{constructor(e){super(),et(this,e,Qn,Yn,Xe,{})}}function Xn(l){let e,t,n,s,r,o,a,u,f;s=new Zn({});const p=l[3].default,m=el(p,l,l[2],null);return{c(){e=d("div"),t=d("div"),t.innerHTML='<div class="bar svelte-1stvkey"></div> <div class="bar svelte-1stvkey"></div> <div class="bar svelte-1stvkey"></div>',n=b(),_e(s.$$.fragment),r=b(),o=d("main"),m&&m.c(),c(t,"class","hamburger svelte-1stvkey"),c(t,"role","button"),c(t,"tabindex","0"),c(t,"aria-label","Toggle navigation menu"),c(o,"class","content svelte-1stvkey"),c(e,"class","layout svelte-1stvkey")},m(v,_){w(v,e,_),i(e,t),i(e,n),pe(s,e,null),i(e,r),i(e,o),m&&m.m(o,null),a=!0,u||(f=[A(window,"keydown",l[1]),A(t,"click",l[0]),A(t,"keydown",l[4])],u=!0)},p(v,[_]){m&&m.p&&(!a||_&4)&&ll(m,p,v,v[2],a?tl(p,v[2],_,null):sl(v[2]),null)},i(v){a||(z(s.$$.fragment,v),z(m,v),a=!0)},o(v){J(s.$$.fragment,v),J(m,v),a=!1},d(v){v&&k(e),me(s),m&&m.d(v),u=!1,Ae(f)}}}function $n(l,e,t){let n;Gt(l,Rt,f=>t(5,n=f));let{$$slots:s={},$$scope:r}=e;function o(){Rt.update(f=>!f)}function a(f){f.key==="Escape"&&n&&Rt.set(!1)}const u=f=>f.key==="Enter"&&o();return l.$$set=f=>{"$$scope"in f&&t(2,r=f.$$scope)},[o,a,r,s,u]}class xn extends tt{constructor(e){super(),et(this,e,$n,Xn,Xe,{})}}const er=l=>({}),hl=l=>({});function kl(l){let e,t;return{c(){e=d("h3"),t=C(l[0]),c(e,"class","card-title svelte-q6oxq0")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s&1&&O(t,n[0])},d(n){n&&k(e)}}}function tr(l){let e,t,n,s,r,o,a,u=l[0]&&kl(l);const f=l[2].actions,p=el(f,l,l[1],hl),m=l[2].default,v=el(m,l,l[1],null);return{c(){e=d("div"),t=d("div"),u&&u.c(),n=b(),s=d("div"),p&&p.c(),r=b(),o=d("div"),v&&v.c(),c(s,"class","card-actions svelte-q6oxq0"),c(t,"class","card-header svelte-q6oxq0"),c(o,"class","card-content svelte-q6oxq0"),c(e,"class","card svelte-q6oxq0")},m(_,h){w(_,e,h),i(e,t),u&&u.m(t,null),i(t,n),i(t,s),p&&p.m(s,null),i(e,r),i(e,o),v&&v.m(o,null),a=!0},p(_,[h]){_[0]?u?u.p(_,h):(u=kl(_),u.c(),u.m(t,n)):u&&(u.d(1),u=null),p&&p.p&&(!a||h&2)&&ll(p,f,_,_[1],a?tl(f,_[1],h,er):sl(_[1]),hl),v&&v.p&&(!a||h&2)&&ll(v,m,_,_[1],a?tl(m,_[1],h,null):sl(_[1]),null)},i(_){a||(z(p,_),z(v,_),a=!0)},o(_){J(p,_),J(v,_),a=!1},d(_){_&&k(e),u&&u.d(),p&&p.d(_),v&&v.d(_)}}}function lr(l,e,t){let{$$slots:n={},$$scope:s}=e,{title:r=""}=e;return l.$$set=o=>{"title"in o&&t(0,r=o.title),"$$scope"in o&&t(1,s=o.$$scope)},[r,s,n]}class Ze extends tt{constructor(e){super(),et(this,e,lr,tr,Xe,{title:0})}}function sr(){const l=window.location.origin;return l.includes("192.168.")||l.includes("localhost")||l.includes("mousetrap.local")?l:(console.log("[API] Captive portal detected, using 192.168.4.1 instead of:",l),"http://192.168.4.1")}const Cn=sr();async function ge(l,e={}){try{const t=`${Cn}${l}`;console.log(`[API] Fetching: ${t}`);const n={Accept:"application/json",...e.headers};e.body&&["POST","PUT","PATCH"].includes((e.method||"GET").toUpperCase())&&(n["Content-Type"]="application/json");const s=await fetch(t,{...e,headers:n});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const r=s.headers.get("content-type");return r&&r.includes("application/json")?await s.json():r&&r.includes("image/")?await s.blob():await s.text()}catch(t){throw console.error(`API Error [${l}]:`,t),t}}async function al(){try{const[l,e]=await Promise.all([ge("/data"),ge("/systemStatus").catch(()=>null)]);return{threshold:l.threshold||0,sensorReading:l.currentHourAverage||0,detectionState:l.triggered||!1,uptime:(e==null?void 0:e.uptime)||"",heap:(e==null?void 0:e.heapFree)||0,anomalies:l.anomalies||[],calibrationOffset:l.calibrationOffset||0,falseAlarmOffset:l.falseAlarmOffset||0,overrideThreshold:l.overrideThreshold||0}}catch{const e=await ge("/data");return{threshold:e.threshold||0,sensorReading:e.currentHourAverage||0,detectionState:e.triggered||!1,uptime:"",heap:0,anomalies:e.anomalies||[],calibrationOffset:e.calibrationOffset||0,falseAlarmOffset:e.falseAlarmOffset||0,overrideThreshold:e.overrideThreshold||0}}}async function yn(){return ge("/toggleLED")}async function nr(){return ge("/ledStatus")}async function rr(){return ge("/api/captures")}function wl(l){return`${Cn}/captures/${l}`}async function ir(l){return ge(`/captures/${l}`,{method:"DELETE"})}async function or(l){return ge(`/setCalib?calib=${l}`)}async function ar(l){return ge(`/setCalib?overrideTh=${l}`)}async function cr(){return ge("/setCalib?overrideTh=0")}async function ur(){return ge("/recalib")}async function fr(){return ge("/falseAlarm")}async function dr(){return Promise.resolve({startUS:1500,endUS:1100,disabled:!1})}async function pr(l){const e=new FormData;return e.append("start",l.startUS),e.append("end",l.endUS),l.disabled&&e.append("disableServo","on"),fetch("/setServoSettings",{method:"POST",body:e,headers:{Authorization:"Basic "+btoa("ops:changeme")}}).then(async t=>{if(!t.ok){const n=await t.text();throw new Error(n||`HTTP ${t.status}`)}return t.text()})}async function Sn(){return ge("/servo")}async function Tn(){return await ge("/testAlert")}async function mr(){return ge("/api/camera-settings")}async function xt(l){return ge("/api/camera-settings",{method:"POST",body:JSON.stringify(l)})}async function vr(){return ge("/api/system-logs")}async function _r(){return ge("/api/previous-logs")}async function br(){return ge("/api/older-logs")}async function gr(){return ge("/api/access-logs")}async function hr(){return ge("/api/system-status")}async function Fn(){return ge("/api/system-info")}async function kr(){return ge("/reboot",{headers:{Authorization:"Basic "+btoa("ops:changeme")}})}async function wr(){return ge("/sendHeartbeat")}async function Ln(){return ge("/reset")}async function En(){return ge("/api/device/claim-status")}async function qr(l){return ge("/api/device/claim",{method:"POST",body:JSON.stringify({claimCode:l})})}async function Cr(){return ge("/api/device/unclaim",{method:"POST"})}async function yr(){return ge("/api/setup/status")}async function Sr(){return ge("/api/setup/status/clear",{method:"POST"})}async function ql(){return ge("/api/setup/progress")}async function Tr(){return ge("/api/setup/reset",{method:"POST"})}async function Fr(){return ge("/api/setup/reboot",{method:"POST"})}async function An(l=!1){const e=l?"/api/wifi/scan?rescan=1":"/api/wifi/scan";console.log(`[WIFI-SCAN] Calling ${e}...`);try{const t=await ge(e);return console.log("[WIFI-SCAN] Got result:",JSON.stringify(t)),t}catch(t){throw console.error("[WIFI-SCAN] Error:",t),t}}async function Lr(l){return ge("/api/setup/test-wifi",{method:"POST",body:JSON.stringify(l)})}async function Er(l){return ge("/api/setup/register",{method:"POST",body:JSON.stringify(l)})}async function Ar(l){return ge("/api/setup/standalone",{method:"POST",body:JSON.stringify(l)})}async function Ir(l){return ge("/api/wifi/update",{method:"POST",body:JSON.stringify(l)})}const{document:Cl}=gn;function yl(l,e,t){const n=l.slice();return n[27]=e[t],n}function Sl(l){let e;return{c(){e=d("div"),e.textContent="TRAP TRIGGERED!",c(e,"class","trap-alert svelte-1kjtmub")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Nr(l){let e,t,n,s,r,o,a,u,f,p=l[2]?"On":"Off",m,v,_,h,g,q,T;return{c(){e=d("div"),t=d("img"),s=b(),r=d("div"),o=d("button"),o.textContent="Refresh",a=b(),u=d("button"),f=C("Live "),m=C(p),v=b(),_=d("button"),_.textContent="Toggle LED",h=b(),g=d("button"),g.textContent="Capture",Lt(t.src,n=l[0])||c(t,"src",n),c(t,"alt","Camera Feed"),c(t,"class","svelte-1kjtmub"),j(t,"error",l[1]),j(t,"zoomed",l[3]),c(o,"class","btn svelte-1kjtmub"),c(u,"class","btn svelte-1kjtmub"),j(u,"active",l[2]),c(_,"class","btn svelte-1kjtmub"),c(g,"class","btn svelte-1kjtmub"),c(r,"class","camera-controls svelte-1kjtmub"),c(e,"class","camera-container svelte-1kjtmub"),j(e,"zoomed",l[3])},m(S,y){w(S,e,y),i(e,t),i(e,s),i(e,r),i(r,o),i(r,a),i(r,u),i(u,f),i(u,m),i(r,v),i(r,_),i(r,h),i(r,g),q||(T=[A(t,"error",l[14]),A(t,"click",l[15]),A(o,"click",l[7]),A(u,"click",l[8]),A(_,"click",l[9]),A(g,"click",l[13])],q=!0)},p(S,y){y&1&&!Lt(t.src,n=S[0])&&c(t,"src",n),y&2&&j(t,"error",S[1]),y&8&&j(t,"zoomed",S[3]),y&4&&p!==(p=S[2]?"On":"Off")&&O(m,p),y&4&&j(u,"active",S[2]),y&8&&j(e,"zoomed",S[3])},d(S){S&&k(e),q=!1,Ae(T)}}}function Pr(l){let e,t,n,s,r,o,a,u=l[4].sensorReading+"",f,p,m,v,_,h=l[4].threshold+"",g;return{c(){e=d("div"),t=d("canvas"),n=b(),s=d("div"),r=d("div"),o=C("Current: "),a=d("strong"),f=C(u),p=b(),m=d("div"),v=C("Threshold: "),_=d("strong"),g=C(h),c(e,"class","chart-container svelte-1kjtmub"),c(a,"class","svelte-1kjtmub"),c(_,"class","svelte-1kjtmub"),c(s,"class","sensor-info svelte-1kjtmub")},m(q,T){w(q,e,T),i(e,t),l[16](t),w(q,n,T),w(q,s,T),i(s,r),i(r,o),i(r,a),i(a,f),i(s,p),i(s,m),i(m,v),i(m,_),i(_,g)},p(q,T){T&16&&u!==(u=q[4].sensorReading+"")&&O(f,u),T&16&&h!==(h=q[4].threshold+"")&&O(g,h)},d(q){q&&(k(e),k(n),k(s)),l[16](null)}}}function Or(l){let e,t,n,s,r,o=l[4].uptime+"",a,u,f,p,m,v,_=l[4].heap+"",h,g,q,T,S,y,F,N=l[5].message+"",M,L,E,P,K,I,U,H,R,Y;return{c(){e=d("div"),t=d("div"),n=d("span"),n.textContent="Uptime:",s=b(),r=d("span"),a=C(o),u=b(),f=d("div"),p=d("span"),p.textContent="Free Heap:",m=b(),v=d("span"),h=C(_),g=C(" bytes"),q=b(),T=d("div"),S=d("span"),S.textContent="Claim Status:",y=b(),F=d("span"),M=C(N),L=b(),E=d("div"),P=d("button"),P.textContent="Reset Alarm",K=b(),I=d("button"),I.textContent="False Alarm",U=b(),H=d("button"),H.textContent="Send Heartbeat",c(t,"class","status-row svelte-1kjtmub"),c(f,"class","status-row svelte-1kjtmub"),c(F,"class","claimed-status"),j(F,"unclaimed",!l[5].claimed),c(T,"class","status-row svelte-1kjtmub"),c(e,"class","status-info svelte-1kjtmub"),c(P,"class","btn svelte-1kjtmub"),c(I,"class","btn svelte-1kjtmub"),c(H,"class","btn svelte-1kjtmub"),c(E,"class","action-buttons svelte-1kjtmub")},m(W,B){w(W,e,B),i(e,t),i(t,n),i(t,s),i(t,r),i(r,a),i(e,u),i(e,f),i(f,p),i(f,m),i(f,v),i(v,h),i(v,g),i(e,q),i(e,T),i(T,S),i(T,y),i(T,F),i(F,M),w(W,L,B),w(W,E,B),i(E,P),i(E,K),i(E,I),i(E,U),i(E,H),R||(Y=[A(P,"click",l[10]),A(I,"click",l[11]),A(H,"click",l[12])],R=!0)},p(W,B){B&16&&o!==(o=W[4].uptime+"")&&O(a,o),B&16&&_!==(_=W[4].heap+"")&&O(h,_),B&32&&N!==(N=W[5].message+"")&&O(M,N),B&32&&j(F,"unclaimed",!W[5].claimed)},d(W){W&&(k(e),k(L),k(E)),R=!1,Ae(Y)}}}function Mr(l){let e;return{c(){e=d("p"),e.textContent="No anomalies detected",c(e,"class","no-data svelte-1kjtmub")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Rr(l){let e,t=Ue(l[4].anomalies),n=[];for(let s=0;s<t.length;s+=1)n[s]=Tl(yl(l,t,s));return{c(){e=d("div");for(let s=0;s<n.length;s+=1)n[s].c();c(e,"class","anomalies-list svelte-1kjtmub")},m(s,r){w(s,e,r);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(s,r){if(r&16){t=Ue(s[4].anomalies);let o;for(o=0;o<t.length;o+=1){const a=yl(s,t,o);n[o]?n[o].p(a,r):(n[o]=Tl(a),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(s){s&&k(e),qt(n,s)}}}function Tl(l){let e,t,n=l[27].timestamp+"",s,r,o,a=l[27].distance+"",u,f,p;return{c(){e=d("div"),t=d("span"),s=C(n),r=b(),o=d("span"),u=C(a),f=C(" cm"),p=b(),c(t,"class","timestamp svelte-1kjtmub"),c(o,"class","distance svelte-1kjtmub"),c(e,"class","anomaly-item svelte-1kjtmub")},m(m,v){w(m,e,v),i(e,t),i(t,s),i(e,r),i(e,o),i(o,u),i(o,f),i(e,p)},p(m,v){v&16&&n!==(n=m[27].timestamp+"")&&O(s,n),v&16&&a!==(a=m[27].distance+"")&&O(u,a)},d(m){m&&k(e)}}}function Dr(l){let e;function t(r,o){return r[4].anomalies&&r[4].anomalies.length>0?Rr:Mr}let n=t(l),s=n(l);return{c(){s.c(),e=$e()},m(r,o){s.m(r,o),w(r,e,o)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){r&&k(e),s.d(r)}}}function Ur(l){let e,t,n,s,r=(l[5].deviceName||"MouseTrap")+"",o,a,u,f,p,m,v,_,h,g,q,T,S;Cl.title=e="Dashboard - "+(l[5].deviceName||"MouseTrap");let y=l[4].detectionState&&Sl();return p=new Ze({props:{title:"Live Camera Feed",$$slots:{default:[Nr]},$$scope:{ctx:l}}}),_=new Ze({props:{title:"Sensor Range",$$slots:{default:[Pr]},$$scope:{ctx:l}}}),g=new Ze({props:{title:"System Status",$$slots:{default:[Or]},$$scope:{ctx:l}}}),T=new Ze({props:{title:"Anomalous Events",$$slots:{default:[Dr]},$$scope:{ctx:l}}}),{c(){t=b(),n=d("div"),s=d("h1"),o=C(r),a=b(),y&&y.c(),u=b(),f=d("div"),_e(p.$$.fragment),m=b(),v=d("div"),_e(_.$$.fragment),h=b(),_e(g.$$.fragment),q=b(),_e(T.$$.fragment),c(s,"class","svelte-1kjtmub"),c(f,"class","camera-card-wrapper svelte-1kjtmub"),c(v,"class","grid svelte-1kjtmub"),c(n,"class","dashboard svelte-1kjtmub")},m(F,N){w(F,t,N),w(F,n,N),i(n,s),i(s,o),i(n,a),y&&y.m(n,null),i(n,u),i(n,f),pe(p,f,null),i(n,m),i(n,v),pe(_,v,null),i(v,h),pe(g,v,null),i(v,q),pe(T,v,null),S=!0},p(F,[N]){(!S||N&32)&&e!==(e="Dashboard - "+(F[5].deviceName||"MouseTrap"))&&(Cl.title=e),(!S||N&32)&&r!==(r=(F[5].deviceName||"MouseTrap")+"")&&O(o,r),F[4].detectionState?y||(y=Sl(),y.c(),y.m(n,u)):y&&(y.d(1),y=null);const M={};N&1073741839&&(M.$$scope={dirty:N,ctx:F}),p.$set(M);const L={};N&1073741904&&(L.$$scope={dirty:N,ctx:F}),_.$set(L);const E={};N&1073741872&&(E.$$scope={dirty:N,ctx:F}),g.$set(E);const P={};N&1073741840&&(P.$$scope={dirty:N,ctx:F}),T.$set(P)},i(F){S||(z(p.$$.fragment,F),z(_.$$.fragment,F),z(g.$$.fragment,F),z(T.$$.fragment,F),S=!0)},o(F){J(p.$$.fragment,F),J(_.$$.fragment,F),J(g.$$.fragment,F),J(T.$$.fragment,F),S=!1},d(F){F&&(k(t),k(n)),y&&y.d(),me(p),me(_),me(g),me(T)}}}const Fl=20;function Hr(l,e,t){let n="/auto.jpg",s=!1,r=!1,o=!1,a=null,u=null,f={threshold:0,sensorReading:0,detectionState:!1,uptime:"",heap:0,anomalies:[]},p={claimed:!1,message:"Checking...",deviceName:""},m=null,v=null,_=[];async function h(){try{t(0,n=`/auto.jpg?t=${Date.now()}`),t(1,s=!1)}catch(R){console.error("Camera refresh error:",R),t(1,s=!0)}}function g(){try{t(0,n=`/camera?t=${Date.now()}`),t(1,s=!1)}catch(R){console.error("Live frame error:",R),t(1,s=!0)}}function q(){t(2,r=!r),r?(g(),a=setInterval(()=>{g()},100)):(a&&(clearInterval(a),a=null),h())}async function T(){try{await yn()}catch(R){console.error("Toggle LED error:",R)}}async function S(){try{await Ln(),await M()}catch(R){console.error("Reset alarm error:",R)}}async function y(){try{const R=await fr();R&&R.newThreshold!==void 0&&t(4,f.threshold=R.newThreshold,f),await M()}catch(R){console.error("False alarm error:",R)}}async function F(){try{await wr()}catch(R){console.error("Send heartbeat error:",R)}}async function N(){try{await Tn(),await h()}catch(R){console.error("Capture screenshot error:",R)}}async function M(){try{const R=await al();t(4,f=R),_.push({time:new Date().toLocaleTimeString(),value:R.sensorReading}),_.length>Fl&&(_=_.slice(-Fl)),E()}catch(R){console.error("Status fetch error:",R)}}function L(){if(!v)return;const R=v.getContext("2d");m=new Chart(R,{type:"line",data:{labels:[],datasets:[{label:"Sensor Reading",data:[],borderColor:"#4CAF50",backgroundColor:"rgba(76, 175, 80, 0.1)",tension:.4},{label:"Threshold",data:[],borderColor:"#f44336",backgroundColor:"transparent",borderDash:[5,5],pointRadius:0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{color:"#ddd"},grid:{color:"#333"}},x:{ticks:{color:"#ddd"},grid:{color:"#333"}}},plugins:{legend:{labels:{color:"#ddd"}}}}})}function E(){m&&(m.data.labels=_.map(R=>R.time),m.data.datasets[0].data=_.map(R=>R.value),m.data.datasets[1].data=_.map(()=>f.threshold),m.update())}function P(){t(1,s=!0),setTimeout(()=>{r?g():h()},1e3)}async function K(){if(o)try{(document.fullscreenElement||document.webkitFullscreenElement)&&(document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen&&await document.webkitExitFullscreen()),t(3,o=!1)}catch(R){console.error("Error exiting fullscreen:",R),t(3,o=!1)}else try{const R=document.documentElement;R.requestFullscreen?await R.requestFullscreen():R.webkitRequestFullscreen&&await R.webkitRequestFullscreen(),t(3,o=!0)}catch(R){console.error("Error entering fullscreen:",R),t(3,o=!0)}}function I(){!document.fullscreenElement&&!document.webkitFullscreenElement&&t(3,o=!1)}async function U(){try{const R=await En();t(5,p={claimed:R.claimed||!1,deviceName:R.deviceName||"",message:R.claimed?`Claimed to ${R.deviceName||"tenant"}`:R.message||"Device not claimed"})}catch(R){console.error("Claim status fetch error:",R),t(5,p={claimed:!1,deviceName:"",message:"Error loading claim status"})}}ht(()=>{if(typeof Chart<"u")L();else{const R=document.createElement("script");R.src="https://cdn.jsdelivr.net/npm/chart.js",R.onload=()=>L(),document.head.appendChild(R)}M(),U(),u=setInterval(M,5e3),document.addEventListener("fullscreenchange",I),document.addEventListener("webkitfullscreenchange",I)}),It(()=>{a&&clearInterval(a),u&&clearInterval(u),m&&m.destroy(),document.removeEventListener("fullscreenchange",I),document.removeEventListener("webkitfullscreenchange",I)});function H(R){Et[R?"unshift":"push"](()=>{v=R,t(6,v)})}return[n,s,r,o,f,p,v,h,q,T,S,y,F,N,P,K,H]}class Ll extends tt{constructor(e){super(),et(this,e,Hr,Ur,Xe,{})}}function Wr(l){let e,t;return{c(){e=d("div"),t=d("div"),c(t,"class","spinner svelte-1cznhkh"),ut(t,"width",l[0]+"px"),ut(t,"height",l[0]+"px"),ut(t,"border-color",l[1]+" transparent transparent transparent"),c(e,"class","spinner-container svelte-1cznhkh")},m(n,s){w(n,e,s),i(e,t)},p(n,[s]){s&1&&ut(t,"width",n[0]+"px"),s&1&&ut(t,"height",n[0]+"px"),s&2&&ut(t,"border-color",n[1]+" transparent transparent transparent")},i:V,o:V,d(n){n&&k(e)}}}function jr(l,e,t){let{size:n=40}=e,{color:s="#9fdcff"}=e;return l.$$set=r=>{"size"in r&&t(0,n=r.size),"color"in r&&t(1,s=r.color)},[n,s]}class ot extends tt{constructor(e){super(),et(this,e,jr,Wr,Xe,{size:0,color:1})}}function El(l){let e,t,n,s,r=l[0].message+"",o,a,u,f,p,m,v=l[0].details&&Al(l);return{c(){e=d("div"),t=d("div"),n=d("strong"),n.textContent="âš ï¸ Error:",s=b(),o=C(r),a=b(),v&&v.c(),u=b(),f=d("button"),f.textContent="âœ•",c(t,"class","error-content svelte-1gxsq9q"),c(f,"class","dismiss-btn svelte-1gxsq9q"),c(e,"class","error-banner svelte-1gxsq9q")},m(_,h){w(_,e,h),i(e,t),i(t,n),i(t,s),i(t,o),i(t,a),v&&v.m(t,null),i(e,u),i(e,f),p||(m=A(f,"click",l[1]),p=!0)},p(_,h){h&1&&r!==(r=_[0].message+"")&&O(o,r),_[0].details?v?v.p(_,h):(v=Al(_),v.c(),v.m(t,null)):v&&(v.d(1),v=null)},d(_){_&&k(e),v&&v.d(),p=!1,m()}}}function Al(l){let e,t=JSON.stringify(l[0].details)+"",n;return{c(){e=d("div"),n=C(t),c(e,"class","error-details svelte-1gxsq9q")},m(s,r){w(s,e,r),i(e,n)},p(s,r){r&1&&t!==(t=JSON.stringify(s[0].details)+"")&&O(n,t)},d(s){s&&k(e)}}}function zr(l){let e,t=l[0]&&El(l);return{c(){t&&t.c(),e=$e()},m(n,s){t&&t.m(n,s),w(n,e,s)},p(n,[s]){n[0]?t?t.p(n,s):(t=El(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:V,o:V,d(n){n&&k(e),t&&t.d(n)}}}function Br(l,e,t){let{error:n=null}=e;function s(){t(0,n=null)}return l.$$set=r=>{"error"in r&&t(0,n=r.error)},[n,s]}class Vr extends tt{constructor(e){super(),et(this,e,Br,zr,Xe,{error:0})}}function Il(l,e,t){const n=l.slice();return n[25]=e[t],n[27]=t,n}function Nl(l){let e,t;return e=new Vr({props:{message:l[2]}}),{c(){_e(e.$$.fragment)},m(n,s){pe(e,n,s),t=!0},p(n,s){const r={};s&4&&(r.message=n[2]),e.$set(r)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){me(e,n)}}}function Gr(l){let e,t,n=Ue(l[0]),s=[];for(let o=0;o<n.length;o+=1)s[o]=Pl(Il(l,n,o));const r=o=>J(s[o],1,1,()=>{s[o]=null});return{c(){e=d("div");for(let o=0;o<s.length;o+=1)s[o].c();c(e,"class","image-grid svelte-1chdln3")},m(o,a){w(o,e,a);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null);t=!0},p(o,a){if(a&769){n=Ue(o[0]);let u;for(u=0;u<n.length;u+=1){const f=Il(o,n,u);s[u]?(s[u].p(f,a),z(s[u],1)):(s[u]=Pl(f),s[u].c(),z(s[u],1),s[u].m(e,null))}for(Le(),u=n.length;u<s.length;u+=1)r(u);Ee()}},i(o){if(!t){for(let a=0;a<n.length;a+=1)z(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)J(s[a]);t=!1},d(o){o&&k(e),qt(s,o)}}}function Jr(l){let e,t;return e=new Ze({props:{$$slots:{default:[xr]},$$scope:{ctx:l}}}),{c(){_e(e.$$.fragment)},m(n,s){pe(e,n,s),t=!0},p(n,s){const r={};s&268435456&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){me(e,n)}}}function Kr(l){let e,t,n;return t=new ot({}),{c(){e=d("div"),_e(t.$$.fragment),c(e,"class","loading-container svelte-1chdln3")},m(s,r){w(s,e,r),pe(t,e,null),n=!0},p:V,i(s){n||(z(t.$$.fragment,s),n=!0)},o(s){J(t.$$.fragment,s),n=!1},d(s){s&&k(e),me(t)}}}function Yr(l){return{c:V,m:V,p:V,i:V,o:V,d:V}}function Qr(l){let e;function t(r,o){return r[24]?Xr:Zr}let n=t(l),s=n(l);return{c(){s.c(),e=$e()},m(r,o){s.m(r,o),w(r,e,o)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},i:V,o:V,d(r){r&&k(e),s.d(r)}}}function Zr(l){let e;return{c(){e=d("div"),e.textContent="Failed to load",c(e,"class","thumbnail-error svelte-1chdln3")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Xr(l){let e,t,n;return{c(){e=d("img"),Lt(e.src,t=l[24])||c(e,"src",t),c(e,"alt",n=l[25].name),c(e,"class","thumbnail-image svelte-1chdln3")},m(s,r){w(s,e,r)},p(s,r){r&1&&!Lt(e.src,t=s[24])&&c(e,"src",t),r&1&&n!==(n=s[25].name)&&c(e,"alt",n)},d(s){s&&k(e)}}}function $r(l){let e,t,n;return t=new ot({}),{c(){e=d("div"),_e(t.$$.fragment),c(e,"class","thumbnail-loading svelte-1chdln3")},m(s,r){w(s,e,r),pe(t,e,null),n=!0},p:V,i(s){n||(z(t.$$.fragment,s),n=!0)},o(s){J(t.$$.fragment,s),n=!1},d(s){s&&k(e),me(t)}}}function Pl(l){let e,t,n,s,r,o=l[25].name+"",a,u,f,p=Dl(l[25].size)+"",m,v,_,h,g,q={ctx:l,current:null,token:null,hasCatch:!1,pending:$r,then:Qr,catch:Yr,value:24,blocks:[,,,]};Yt(t=l[8](l[25].name),q);function T(){return l[19](l[25],l[27])}return{c(){e=d("div"),q.block.c(),n=b(),s=d("div"),r=d("div"),a=C(o),u=b(),f=d("div"),m=C(p),v=b(),c(r,"class","thumbnail-filename svelte-1chdln3"),c(f,"class","thumbnail-meta svelte-1chdln3"),c(s,"class","thumbnail-info svelte-1chdln3"),c(e,"class","thumbnail-card svelte-1chdln3")},m(S,y){w(S,e,y),q.block.m(e,q.anchor=null),q.mount=()=>e,q.anchor=n,i(e,n),i(e,s),i(s,r),i(r,a),i(s,u),i(s,f),i(f,m),i(e,v),_=!0,h||(g=A(e,"click",T),h=!0)},p(S,y){l=S,q.ctx=l,y&1&&t!==(t=l[8](l[25].name))&&Yt(t,q)||kn(q,l,y),(!_||y&1)&&o!==(o=l[25].name+"")&&O(a,o),(!_||y&1)&&p!==(p=Dl(l[25].size)+"")&&O(m,p)},i(S){_||(z(q.block),_=!0)},o(S){for(let y=0;y<3;y+=1){const F=q.blocks[y];J(F)}_=!1},d(S){S&&k(e),q.block.d(),q.token=null,q=null,h=!1,g()}}}function xr(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1chdln3">No captures yet</p> <p class="empty-hint svelte-1chdln3">Captured images will appear here</p>',c(e,"class","empty-state svelte-1chdln3")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Ol(l){let e,t,n,s,r,o=l[3].name+"",a,u,f,p=Rl(l[3].name)+"",m,v,_,h,g,q,T,S,y,F,N,M,L,E,P=l[4]+1+"",K,I,U=l[0].length+"",H,R,Y,W,B,X,Z,ne,ae,se,G,le,Q,D={ctx:l,current:null,token:null,hasCatch:!1,pending:ni,then:ti,catch:ei,value:24,blocks:[,,,]};return Yt(q=l[8](l[3].name),D),{c(){e=d("div"),t=d("div"),n=d("div"),s=d("div"),r=d("div"),a=C(o),u=b(),f=d("div"),m=C(p),v=b(),_=d("button"),_.textContent="Ã—",h=b(),g=d("div"),D.block.c(),T=b(),S=d("div"),y=d("div"),F=d("button"),N=C("â† Previous"),L=b(),E=d("span"),K=C(P),I=C(" / "),H=C(U),R=b(),Y=d("button"),W=C("Next â†’"),X=b(),Z=d("div"),ne=d("button"),ne.textContent="Download",ae=b(),se=d("button"),se.textContent="Delete",c(r,"class","modal-filename svelte-1chdln3"),c(f,"class","modal-timestamp svelte-1chdln3"),c(s,"class","modal-title svelte-1chdln3"),c(_,"class","modal-close svelte-1chdln3"),c(n,"class","modal-header svelte-1chdln3"),c(g,"class","modal-body svelte-1chdln3"),c(F,"class","nav-btn svelte-1chdln3"),F.disabled=M=l[4]===0,c(E,"class","image-counter svelte-1chdln3"),c(Y,"class","nav-btn svelte-1chdln3"),Y.disabled=B=l[4]===l[0].length-1,c(y,"class","modal-nav svelte-1chdln3"),c(ne,"class","action-btn svelte-1chdln3"),c(se,"class","action-btn delete-btn svelte-1chdln3"),c(Z,"class","modal-actions svelte-1chdln3"),c(S,"class","modal-footer svelte-1chdln3"),c(t,"class","modal-content svelte-1chdln3"),c(e,"class","modal-backdrop svelte-1chdln3")},m($,te){w($,e,te),i(e,t),i(t,n),i(n,s),i(s,r),i(r,a),i(s,u),i(s,f),i(f,m),i(n,v),i(n,_),i(t,h),i(t,g),D.block.m(g,D.anchor=null),D.mount=()=>g,D.anchor=null,i(t,T),i(t,S),i(S,y),i(y,F),i(F,N),i(y,L),i(y,E),i(E,K),i(E,I),i(E,H),i(y,R),i(y,Y),i(Y,W),i(S,X),i(S,Z),i(Z,ne),i(Z,ae),i(Z,se),G=!0,le||(Q=[A(_,"click",l[10]),A(F,"click",l[11]),A(Y,"click",l[12]),A(ne,"click",l[20]),A(se,"click",l[21]),A(t,"click",hn(l[18])),A(e,"click",l[10])],le=!0)},p($,te){l=$,(!G||te&8)&&o!==(o=l[3].name+"")&&O(a,o),(!G||te&8)&&p!==(p=Rl(l[3].name)+"")&&O(m,p),D.ctx=l,te&8&&q!==(q=l[8](l[3].name))&&Yt(q,D)||kn(D,l,te),(!G||te&16&&M!==(M=l[4]===0))&&(F.disabled=M),(!G||te&16)&&P!==(P=l[4]+1+"")&&O(K,P),(!G||te&1)&&U!==(U=l[0].length+"")&&O(H,U),(!G||te&17&&B!==(B=l[4]===l[0].length-1))&&(Y.disabled=B)},i($){G||(z(D.block),G=!0)},o($){for(let te=0;te<3;te+=1){const re=D.blocks[te];J(re)}G=!1},d($){$&&k(e),D.block.d(),D.token=null,D=null,le=!1,Ae(Q)}}}function ei(l){return{c:V,m:V,p:V,i:V,o:V,d:V}}function ti(l){let e;function t(r,o){return r[24]?si:li}let n=t(l),s=n(l);return{c(){s.c(),e=$e()},m(r,o){s.m(r,o),w(r,e,o)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},i:V,o:V,d(r){r&&k(e),s.d(r)}}}function li(l){let e;return{c(){e=d("div"),e.textContent="Failed to load image",c(e,"class","modal-error svelte-1chdln3")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function si(l){let e,t,n;return{c(){e=d("img"),Lt(e.src,t=l[24])||c(e,"src",t),c(e,"alt",n=l[3].name),c(e,"class","modal-image svelte-1chdln3")},m(s,r){w(s,e,r)},p(s,r){r&8&&!Lt(e.src,t=s[24])&&c(e,"src",t),r&8&&n!==(n=s[3].name)&&c(e,"alt",n)},d(s){s&&k(e)}}}function ni(l){let e,t;return e=new ot({}),{c(){_e(e.$$.fragment)},m(n,s){pe(e,n,s),t=!0},p:V,i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){me(e,n)}}}function Ml(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g;return{c(){e=d("div"),t=d("div"),n=d("h3"),n.textContent="Confirm Delete",s=b(),r=d("p"),o=C("Are you sure you want to delete "),a=C(l[6]),u=C("?"),f=b(),p=d("div"),m=d("button"),m.textContent="Cancel",v=b(),_=d("button"),_.textContent="Delete",c(n,"class","svelte-1chdln3"),c(r,"class","svelte-1chdln3"),c(m,"class","confirm-btn cancel-btn svelte-1chdln3"),c(_,"class","confirm-btn delete-confirm-btn svelte-1chdln3"),c(p,"class","confirm-actions svelte-1chdln3"),c(t,"class","confirm-dialog svelte-1chdln3"),c(e,"class","confirm-backdrop svelte-1chdln3")},m(q,T){w(q,e,T),i(e,t),i(t,n),i(t,s),i(t,r),i(r,o),i(r,a),i(r,u),i(t,f),i(t,p),i(p,m),i(p,v),i(p,_),h||(g=[A(m,"click",l[16]),A(_,"click",l[15]),A(t,"click",hn(l[17])),A(e,"click",l[16])],h=!0)},p(q,T){T&64&&O(a,q[6])},d(q){q&&k(e),h=!1,Ae(g)}}}function ri(l){let e,t,n,s,r,o=l[1]?"Loading...":"Refresh",a,u,f,p,m,v,_,h,g,q,T,S=l[2]&&Nl(l);const y=[Kr,Jr,Gr],F=[];function N(E,P){return E[1]?0:E[0].length===0?1:2}p=N(l),m=F[p]=y[p](l);let M=l[3]&&Ol(l),L=l[5]&&Ml(l);return{c(){e=d("div"),t=d("div"),n=d("h1"),n.textContent="Image Gallery",s=b(),r=d("button"),a=C(o),u=b(),S&&S.c(),f=b(),m.c(),v=b(),M&&M.c(),_=b(),L&&L.c(),h=$e(),c(n,"class","svelte-1chdln3"),c(r,"class","refresh-btn svelte-1chdln3"),r.disabled=l[1],c(t,"class","header svelte-1chdln3"),c(e,"class","gallery-container svelte-1chdln3")},m(E,P){w(E,e,P),i(e,t),i(t,n),i(t,s),i(t,r),i(r,a),i(e,u),S&&S.m(e,null),i(e,f),F[p].m(e,null),w(E,v,P),M&&M.m(E,P),w(E,_,P),L&&L.m(E,P),w(E,h,P),g=!0,q||(T=A(r,"click",l[7]),q=!0)},p(E,[P]){(!g||P&2)&&o!==(o=E[1]?"Loading...":"Refresh")&&O(a,o),(!g||P&2)&&(r.disabled=E[1]),E[2]?S?(S.p(E,P),P&4&&z(S,1)):(S=Nl(E),S.c(),z(S,1),S.m(e,f)):S&&(Le(),J(S,1,1,()=>{S=null}),Ee());let K=p;p=N(E),p===K?F[p].p(E,P):(Le(),J(F[K],1,1,()=>{F[K]=null}),Ee(),m=F[p],m?m.p(E,P):(m=F[p]=y[p](E),m.c()),z(m,1),m.m(e,null)),E[3]?M?(M.p(E,P),P&8&&z(M,1)):(M=Ol(E),M.c(),z(M,1),M.m(_.parentNode,_)):M&&(Le(),J(M,1,1,()=>{M=null}),Ee()),E[5]?L?L.p(E,P):(L=Ml(E),L.c(),L.m(h.parentNode,h)):L&&(L.d(1),L=null)},i(E){g||(z(S),z(m),z(M),g=!0)},o(E){J(S),J(m),J(M),g=!1},d(E){E&&(k(e),k(v),k(_),k(h)),S&&S.d(),F[p].d(),M&&M.d(E),L&&L.d(E),q=!1,T()}}}function Rl(l){if(!l)return"Unknown Date";const e=l.match(/(\d{4})(\d{2})(\d{2})/);if(e){const n=parseInt(e[1]),s=parseInt(e[2])-1,r=parseInt(e[3]);if(n>=2020&&n<=2100&&s>=0&&s<=11&&r>=1&&r<=31)return new Date(n,s,r).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}const t=l.match(/(\d{10})/);if(t){const n=parseInt(t[1])*1e3,s=new Date(n);if(!isNaN(s.getTime()))return s.toLocaleString()}return"Unknown Date"}function Dl(l){return l<1024?l+" B":l<1024*1024?(l/1024).toFixed(1)+" KB":(l/(1024*1024)).toFixed(1)+" MB"}function ii(l,e,t){let n=[],s=!0,r=null,o=null,a=-1,u={},f=!1,p=null;ht(()=>{m(),document.addEventListener("keydown",g)}),It(()=>{document.removeEventListener("keydown",g),Object.values(u).forEach(I=>URL.revokeObjectURL(I))});async function m(){t(1,s=!0),t(2,r=null);try{const I=await rr();t(0,n=I.files||[]),n.sort((U,H)=>H.name.localeCompare(U.name))}catch(I){t(2,r=I.message||"Failed to load gallery")}finally{t(1,s=!1)}}async function v(I){if(u[I])return u[I];try{const U=wl(I);return u[I]=U,U}catch(U){return console.error("Failed to load image:",U),null}}async function _(I,U){t(3,o=I),t(4,a=U),await v(I.name)}function h(){t(3,o=null),t(4,a=-1),t(5,f=!1),t(6,p=null)}function g(I){o&&(I.key==="Escape"?h():I.key==="ArrowLeft"?q():I.key==="ArrowRight"&&T())}function q(){a>0&&(t(4,a--,a),t(3,o=n[a]),v(o.name))}function T(){a<n.length-1&&(t(4,a++,a),t(3,o=n[a]),v(o.name))}async function S(I){try{const U=wl(I),R=await(await fetch(U)).blob(),Y=URL.createObjectURL(R),W=document.createElement("a");W.href=Y,W.download=I,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(Y)}catch(U){console.error("Failed to download image:",U),alert("Failed to download image")}}function y(I){t(6,p=I),t(5,f=!0)}async function F(){if(p)try{await ir(p),u[p]&&(URL.revokeObjectURL(u[p]),delete u[p]),t(0,n=n.filter(I=>I.name!==p)),o&&o.name===p&&h(),t(5,f=!1),t(6,p=null)}catch(I){console.error("Failed to delete image:",I),alert("Failed to delete image")}}function N(){t(5,f=!1),t(6,p=null)}function M(I){dl.call(this,l,I)}function L(I){dl.call(this,l,I)}return[n,s,r,o,a,f,p,m,v,_,h,q,T,S,y,F,N,M,L,(I,U)=>_(I,U),()=>S(o.name),()=>y(o.name)]}class oi extends tt{constructor(e){super(),et(this,e,ii,ri,Xe,{})}}function Ul(l){let e,t;return{c(){e=d("div"),t=C(l[5]),c(e,"class","message svelte-1iken05"),j(e,"success",l[6]==="success"),j(e,"error",l[6]==="error")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s&32&&O(t,n[5]),s&64&&j(e,"success",n[6]==="success"),s&64&&j(e,"error",n[6]==="error")},d(n){n&&k(e)}}}function ai(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S,y,F,N,M,L,E,P,K,I,U,H,R,Y,W,B,X,Z,ne,ae,se,G,le,Q;return{c(){e=d("div"),t=d("div"),n=d("label"),n.textContent="False-Alarm Offset:",s=b(),r=d("span"),o=C(l[0]),a=C(" mm"),u=b(),f=d("div"),p=d("label"),p.textContent="Current Threshold:",m=b(),v=d("span"),_=C(l[1]),h=C(" mm"),g=b(),q=d("div"),T=d("label"),T.textContent="Calibration Offset:",S=b(),y=d("div"),F=d("input"),N=b(),M=d("span"),L=C(l[2]),E=C(" mm"),P=b(),K=d("div"),I=d("label"),I.textContent="Override Threshold (mm):",U=b(),H=d("input"),R=b(),Y=d("div"),W=d("button"),B=C("ðŸ’¾ Save"),X=b(),Z=d("button"),ne=C("ðŸ—‘ï¸ Clear Override"),ae=b(),se=d("button"),G=C("ðŸ”„ Recalibrate"),c(n,"class","svelte-1iken05"),c(r,"class","value svelte-1iken05"),c(t,"class","info-row svelte-1iken05"),c(p,"class","svelte-1iken05"),c(v,"class","value svelte-1iken05"),c(f,"class","info-row svelte-1iken05"),c(T,"for","calib-offset"),c(T,"class","svelte-1iken05"),c(F,"id","calib-offset"),c(F,"type","range"),c(F,"min","-100"),c(F,"max","100"),c(F,"step","1"),c(F,"class","slider svelte-1iken05"),F.disabled=l[4],c(M,"class","slider-value svelte-1iken05"),c(y,"class","slider-row svelte-1iken05"),c(q,"class","control-group svelte-1iken05"),c(I,"for","override-th"),c(I,"class","svelte-1iken05"),c(H,"id","override-th"),c(H,"type","number"),c(H,"placeholder",""),c(H,"min","0"),c(H,"class","input-field svelte-1iken05"),H.disabled=l[4],c(K,"class","control-group svelte-1iken05"),c(W,"class","btn btn-save svelte-1iken05"),W.disabled=l[4],c(Z,"class","btn btn-clear svelte-1iken05"),Z.disabled=l[4],c(se,"class","btn btn-recal svelte-1iken05"),se.disabled=l[4],c(Y,"class","button-group svelte-1iken05"),c(e,"class","content svelte-1iken05")},m(D,$){w(D,e,$),i(e,t),i(t,n),i(t,s),i(t,r),i(r,o),i(r,a),i(e,u),i(e,f),i(f,p),i(f,m),i(f,v),i(v,_),i(v,h),i(e,g),i(e,q),i(q,T),i(q,S),i(q,y),i(y,F),ce(F,l[2]),i(y,N),i(y,M),i(M,L),i(M,E),i(e,P),i(e,K),i(K,I),i(K,U),i(K,H),ce(H,l[3]),i(e,R),i(e,Y),i(Y,W),i(W,B),i(Y,X),i(Y,Z),i(Z,ne),i(Y,ae),i(Y,se),i(se,G),le||(Q=[A(F,"change",l[10]),A(F,"input",l[10]),A(H,"input",l[11]),A(W,"click",l[7]),A(Z,"click",l[8]),A(se,"click",l[9])],le=!0)},p(D,$){$&1&&O(o,D[0]),$&2&&O(_,D[1]),$&16&&(F.disabled=D[4]),$&4&&ce(F,D[2]),$&4&&O(L,D[2]),$&16&&(H.disabled=D[4]),$&8&&gt(H.value)!==D[3]&&ce(H,D[3]),$&16&&(W.disabled=D[4]),$&16&&(Z.disabled=D[4]),$&16&&(se.disabled=D[4])},d(D){D&&k(e),le=!1,Ae(Q)}}}function ci(l){let e,t,n,s,r,o,a=l[5]&&Ul(l);return r=new Ze({props:{title:"",$$slots:{default:[ai]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Calibration Settings",n=b(),a&&a.c(),s=b(),_e(r.$$.fragment),c(t,"class","svelte-1iken05"),c(e,"class","page svelte-1iken05")},m(u,f){w(u,e,f),i(e,t),i(e,n),a&&a.m(e,null),i(e,s),pe(r,e,null),o=!0},p(u,[f]){u[5]?a?a.p(u,f):(a=Ul(u),a.c(),a.m(e,s)):a&&(a.d(1),a=null);const p={};f&16415&&(p.$$scope={dirty:f,ctx:u}),r.$set(p)},i(u){o||(z(r.$$.fragment,u),o=!0)},o(u){J(r.$$.fragment,u),o=!1},d(u){u&&k(e),a&&a.d(),me(r)}}}function ui(l,e,t){let n=0,s=0,r=0,o="",a=!1,u="",f="";ht(()=>{p();const q=localStorage.getItem("calibrationOffset");q!==null&&t(2,r=parseInt(q))});async function p(){try{const q=await al();t(1,s=q.threshold||0),t(0,n=q.falseAlarmOffset||0),q.calibrationOffset!==void 0&&(t(2,r=q.calibrationOffset),localStorage.setItem("calibrationOffset",r.toString())),q.overrideThreshold!==void 0&&q.overrideThreshold>0?t(3,o=q.overrideThreshold.toString()):t(3,o="")}catch(q){console.warn("Failed to load status:",q)}}async function m(){t(4,a=!0),t(5,u="");try{await or(r),localStorage.setItem("calibrationOffset",r.toString()),o&&parseInt(o)>0?(await ar(parseInt(o)),t(5,u="Calibration offset and override threshold saved")):t(5,u="Calibration offset saved"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(q){t(5,u=`Failed to save: ${q.message||q}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,a=!1)}}async function v(){t(4,a=!0),t(5,u="");try{await cr(),t(3,o=""),t(5,u="Override cleared"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(q){t(5,u=`Failed to clear override: ${q.message||q}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,a=!1)}}async function _(){t(4,a=!0),t(5,u="");try{await ur(),t(5,u="Re-calibration started"),t(6,f="success"),setTimeout(()=>{t(5,u=""),p()},2e3)}catch(q){t(5,u=`Failed to recalibrate: ${q.message||q}`),t(6,f="error"),setTimeout(()=>{t(5,u="")},3e3)}finally{t(4,a=!1)}}function h(){r=gt(this.value),t(2,r)}function g(){o=gt(this.value),t(3,o)}return[n,s,r,o,a,u,f,m,v,_,h,g]}class fi extends tt{constructor(e){super(),et(this,e,ui,ci,Xe,{})}}function Hl(l){let e,t;return{c(){e=d("div"),t=C(l[6]),c(e,"class","message svelte-1lrtwwl"),j(e,"success",l[7]==="success"),j(e,"error",l[7]==="error")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s&64&&O(t,n[6]),s&128&&j(e,"success",n[7]==="success"),s&128&&j(e,"error",n[7]==="error")},d(n){n&&k(e)}}}function di(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S,y,F,N,M,L,E,P,K,I,U,H,R,Y,W,B,X,Z=l[4]?"Saving...":"Save",ne,ae,se,G=l[5]?"Testing...":"Test Servo",le,Q,D,$;return{c(){e=d("div"),t=d("div"),n=d("label"),n.textContent="Start Position (Âµs):",s=b(),r=d("input"),o=b(),a=d("button"),u=C("Set"),f=b(),p=d("div"),m=d("label"),m.textContent="End Position (Âµs):",v=b(),_=d("input"),h=b(),g=d("button"),q=C("Set"),T=b(),S=d("div"),y=d("input"),F=b(),N=d("label"),N.textContent="Disable Servo",M=b(),L=d("div"),E=d("h3"),E.textContent="Live Control",P=b(),K=d("div"),I=d("input"),U=b(),H=d("div"),R=C(l[3]),Y=C(" Âµs"),W=b(),B=d("div"),X=d("button"),ne=C(Z),ae=b(),se=d("button"),le=C(G),c(n,"for","start-pos"),c(n,"class","svelte-1lrtwwl"),c(r,"id","start-pos"),c(r,"type","number"),c(r,"min","500"),c(r,"max","2500"),c(r,"step","10"),c(r,"class","svelte-1lrtwwl"),c(a,"class","btn btn-set svelte-1lrtwwl"),a.disabled=l[2],c(t,"class","position-row svelte-1lrtwwl"),c(m,"for","end-pos"),c(m,"class","svelte-1lrtwwl"),c(_,"id","end-pos"),c(_,"type","number"),c(_,"min","500"),c(_,"max","2500"),c(_,"step","10"),c(_,"class","svelte-1lrtwwl"),c(g,"class","btn btn-set svelte-1lrtwwl"),g.disabled=l[2],c(p,"class","position-row svelte-1lrtwwl"),c(y,"id","disable-servo"),c(y,"type","checkbox"),c(y,"class","svelte-1lrtwwl"),c(N,"for","disable-servo"),c(N,"class","svelte-1lrtwwl"),c(S,"class","checkbox-row svelte-1lrtwwl"),c(E,"class","svelte-1lrtwwl"),c(I,"type","range"),c(I,"min","500"),c(I,"max","2500"),c(I,"step","10"),I.disabled=l[2],c(I,"class","position-slider svelte-1lrtwwl"),c(H,"class","slider-value svelte-1lrtwwl"),c(K,"class","slider-container svelte-1lrtwwl"),c(L,"class","live-control svelte-1lrtwwl"),c(X,"class","btn btn-save svelte-1lrtwwl"),X.disabled=l[4],c(se,"class","btn btn-test svelte-1lrtwwl"),se.disabled=Q=l[5]||l[2],c(B,"class","button-group svelte-1lrtwwl"),c(e,"class","settings-content svelte-1lrtwwl")},m(te,re){w(te,e,re),i(e,t),i(t,n),i(t,s),i(t,r),ce(r,l[0]),i(t,o),i(t,a),i(a,u),i(e,f),i(e,p),i(p,m),i(p,v),i(p,_),ce(_,l[1]),i(p,h),i(p,g),i(g,q),i(e,T),i(e,S),i(S,y),y.checked=l[2],i(S,F),i(S,N),i(e,M),i(e,L),i(L,E),i(L,P),i(L,K),i(K,I),ce(I,l[3]),i(K,U),i(K,H),i(H,R),i(H,Y),i(e,W),i(e,B),i(B,X),i(X,ne),i(B,ae),i(B,se),i(se,le),D||($=[A(r,"input",l[12]),A(a,"click",l[13]),A(_,"input",l[14]),A(g,"click",l[15]),A(y,"change",l[16]),A(I,"change",l[17]),A(I,"input",l[17]),A(I,"input",l[11]),A(X,"click",l[9]),A(se,"click",l[10])],D=!0)},p(te,re){re&1&&gt(r.value)!==te[0]&&ce(r,te[0]),re&4&&(a.disabled=te[2]),re&2&&gt(_.value)!==te[1]&&ce(_,te[1]),re&4&&(g.disabled=te[2]),re&4&&(y.checked=te[2]),re&4&&(I.disabled=te[2]),re&8&&ce(I,te[3]),re&8&&O(R,te[3]),re&16&&Z!==(Z=te[4]?"Saving...":"Save")&&O(ne,Z),re&16&&(X.disabled=te[4]),re&32&&G!==(G=te[5]?"Testing...":"Test Servo")&&O(le,G),re&36&&Q!==(Q=te[5]||te[2])&&(se.disabled=Q)},d(te){te&&k(e),D=!1,Ae($)}}}function pi(l){let e,t,n,s,r,o,a=l[6]&&Hl(l);return r=new Ze({props:{title:"",$$slots:{default:[di]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Servo Settings",n=b(),a&&a.c(),s=b(),_e(r.$$.fragment),c(t,"class","svelte-1lrtwwl"),c(e,"class","page svelte-1lrtwwl")},m(u,f){w(u,e,f),i(e,t),i(e,n),a&&a.m(e,null),i(e,s),pe(r,e,null),o=!0},p(u,[f]){u[6]?a?a.p(u,f):(a=Hl(u),a.c(),a.m(e,s)):a&&(a.d(1),a=null);const p={};f&524351&&(p.$$scope={dirty:f,ctx:u}),r.$set(p)},i(u){o||(z(r.$$.fragment,u),o=!0)},o(u){J(r.$$.fragment,u),o=!1},d(u){u&&k(e),a&&a.d(),me(r)}}}function mi(l,e,t){let n=1500,s=1100,r=!1,o=1500,a=!1,u=!1,f="",p="";async function m(){try{const M=await dr();M.startUS!==void 0&&t(0,n=M.startUS),M.endUS!==void 0&&t(1,s=M.endUS);const L=localStorage.getItem("disableServo");L!==null?t(2,r=L==="true"):M.disabled!==void 0&&t(2,r=M.disabled),t(3,o=n)}catch(M){console.warn("Failed to load servo settings:",M)}}async function v(M,L){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}try{await fetch(`/servoSet?val=${M}`),t(6,f=`${L} set to ${M}Âµs`),t(7,p="success"),setTimeout(()=>{t(6,f="")},2e3)}catch{t(6,f=`Failed to set ${L}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}}async function _(){t(4,a=!0),t(6,f="");try{await pr({startUS:n,endUS:s,disabled:r}),localStorage.setItem("disableServo",r.toString()),t(6,f="Settings saved successfully"),t(7,p="success"),setTimeout(()=>{t(6,f="")},3e3)}catch(M){t(6,f=`Failed to save: ${M.message}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}finally{t(4,a=!1)}}async function h(){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}t(5,u=!0),t(6,f="");try{await Sn(),t(6,f="Servo triggered"),t(7,p="success"),setTimeout(()=>{t(6,f="")},2e3)}catch(M){t(6,f=`Failed to trigger servo: ${M.message}`),t(7,p="error"),setTimeout(()=>{t(6,f="")},3e3)}finally{t(5,u=!1)}}function g(){if(r){t(6,f="Servo is disabled"),t(7,p="error"),setTimeout(()=>{t(6,f="")},2e3);return}try{fetch(`/servoSet?val=${o}`)}catch(M){console.error("Failed to update live position:",M)}}ht(()=>{m()});function q(){n=gt(this.value),t(0,n)}const T=()=>v(n,"Start position");function S(){s=gt(this.value),t(1,s)}const y=()=>v(s,"End position");function F(){r=this.checked,t(2,r)}function N(){o=gt(this.value),t(3,o)}return[n,s,r,o,a,u,f,p,v,_,h,g,q,T,S,y,F,N]}class vi extends tt{constructor(e){super(),et(this,e,mi,pi,Xe,{})}}const{document:_i}=gn;function Wl(l,e,t){const n=l.slice();return n[58]=e[t],n}function jl(l,e,t){const n=l.slice();return n[58]=e[t],n}function zl(l,e,t){const n=l.slice();return n[58]=e[t],n}function Bl(l,e,t){const n=l.slice();return n[58]=e[t],n}function Vl(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",c(e,"class","btn-small svelte-16e85dp")},m(s,r){w(s,e,r),t||(n=A(e,"click",l[34]),t=!0)},p:V,d(s){s&&k(e),t=!1,n()}}}function Gl(l){let e;function t(r,o){return r[8]?wi:r[12]?ki:r[28].length===0&&r[4]?hi:r[0].length===0?gi:bi}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),c(e,"class","log-content svelte-16e85dp"),j(e,"expanded",l[17])},m(r,o){w(r,e,o),s.m(e,null),l[45](e)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),o[0]&131072&&j(e,"expanded",r[17])},d(r){r&&k(e),s.d(),l[45](null)}}}function bi(l){let e,t,n,s=Ue(l[28]),r=[];for(let a=0;a<s.length;a+=1)r[a]=Jl(Bl(l,s,a));let o=l[4]&&l[28].length>0&&Kl(l);return{c(){e=d("div");for(let a=0;a<r.length;a+=1)r[a].c();t=b(),o&&o.c(),n=$e(),c(e,"class","log-list svelte-16e85dp")},m(a,u){w(a,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);w(a,t,u),o&&o.m(a,u),w(a,n,u)},p(a,u){if(u[0]&268435456){s=Ue(a[28]);let f;for(f=0;f<s.length;f+=1){const p=Bl(a,s,f);r[f]?r[f].p(p,u):(r[f]=Jl(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}a[4]&&a[28].length>0?o?o.p(a,u):(o=Kl(a),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(a){a&&(k(e),k(t),k(n)),qt(r,a),o&&o.d(a)}}}function gi(l){let e;return{c(){e=d("div"),e.textContent="No system logs available",c(e,"class","no-data svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function hi(l){let e,t,n,s;return{c(){e=d("div"),t=C('No logs match filter "'),n=C(l[4]),s=C('"'),c(e,"class","no-results svelte-16e85dp")},m(r,o){w(r,e,o),i(e,t),i(e,n),i(e,s)},p(r,o){o[0]&16&&O(n,r[4])},d(r){r&&k(e)}}}function ki(l){let e,t,n;return{c(){e=d("div"),t=C("Error: "),n=C(l[12]),c(e,"class","error svelte-16e85dp")},m(s,r){w(s,e,r),i(e,t),i(e,n)},p(s,r){r[0]&4096&&O(n,s[12])},d(s){s&&k(e)}}}function wi(l){let e;return{c(){e=d("div"),e.textContent="Loading system logs...",c(e,"class","loading svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Jl(l){let e,t=l[58]+"",n;return{c(){e=d("div"),n=C(t),c(e,"class","log-line svelte-16e85dp")},m(s,r){w(s,e,r),i(e,n)},p(s,r){r[0]&268435456&&t!==(t=s[58]+"")&&O(n,t)},d(s){s&&k(e)}}}function Kl(l){let e,t,n=l[28].length+"",s,r,o=l[0].length+"",a,u;return{c(){e=d("div"),t=C("Showing "),s=C(n),r=C(" of "),a=C(o),u=C(" logs"),c(e,"class","filter-info svelte-16e85dp")},m(f,p){w(f,e,p),i(e,t),i(e,s),i(e,r),i(e,a),i(e,u)},p(f,p){p[0]&268435456&&n!==(n=f[28].length+"")&&O(s,n),p[0]&1&&o!==(o=f[0].length+"")&&O(a,o)},d(f){f&&k(e)}}}function Yl(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",c(e,"class","btn-small svelte-16e85dp")},m(s,r){w(s,e,r),t||(n=A(e,"click",l[35]),t=!0)},p:V,d(s){s&&k(e),t=!1,n()}}}function Ql(l){let e;function t(r,o){return r[9]?Ti:r[13]?Si:r[27].length===0&&r[5]?yi:r[1].length===0?Ci:qi}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),c(e,"class","log-content svelte-16e85dp"),j(e,"expanded",l[18])},m(r,o){w(r,e,o),s.m(e,null),l[48](e)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),o[0]&262144&&j(e,"expanded",r[18])},d(r){r&&k(e),s.d(),l[48](null)}}}function qi(l){let e,t,n,s=Ue(l[27]),r=[];for(let a=0;a<s.length;a+=1)r[a]=Zl(zl(l,s,a));let o=l[5]&&l[27].length>0&&Xl(l);return{c(){e=d("div");for(let a=0;a<r.length;a+=1)r[a].c();t=b(),o&&o.c(),n=$e(),c(e,"class","log-list svelte-16e85dp")},m(a,u){w(a,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);w(a,t,u),o&&o.m(a,u),w(a,n,u)},p(a,u){if(u[0]&134217728){s=Ue(a[27]);let f;for(f=0;f<s.length;f+=1){const p=zl(a,s,f);r[f]?r[f].p(p,u):(r[f]=Zl(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}a[5]&&a[27].length>0?o?o.p(a,u):(o=Xl(a),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(a){a&&(k(e),k(t),k(n)),qt(r,a),o&&o.d(a)}}}function Ci(l){let e;return{c(){e=d("div"),e.textContent="No previous logs available",c(e,"class","no-data svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function yi(l){let e,t,n,s;return{c(){e=d("div"),t=C('No logs match filter "'),n=C(l[5]),s=C('"'),c(e,"class","no-results svelte-16e85dp")},m(r,o){w(r,e,o),i(e,t),i(e,n),i(e,s)},p(r,o){o[0]&32&&O(n,r[5])},d(r){r&&k(e)}}}function Si(l){let e,t,n;return{c(){e=d("div"),t=C("Error: "),n=C(l[13]),c(e,"class","error svelte-16e85dp")},m(s,r){w(s,e,r),i(e,t),i(e,n)},p(s,r){r[0]&8192&&O(n,s[13])},d(s){s&&k(e)}}}function Ti(l){let e;return{c(){e=d("div"),e.textContent="Loading previous logs...",c(e,"class","loading svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Zl(l){let e,t=l[58]+"",n;return{c(){e=d("div"),n=C(t),c(e,"class","log-line svelte-16e85dp")},m(s,r){w(s,e,r),i(e,n)},p(s,r){r[0]&134217728&&t!==(t=s[58]+"")&&O(n,t)},d(s){s&&k(e)}}}function Xl(l){let e,t,n=l[27].length+"",s,r,o=l[1].length+"",a,u;return{c(){e=d("div"),t=C("Showing "),s=C(n),r=C(" of "),a=C(o),u=C(" logs"),c(e,"class","filter-info svelte-16e85dp")},m(f,p){w(f,e,p),i(e,t),i(e,s),i(e,r),i(e,a),i(e,u)},p(f,p){p[0]&134217728&&n!==(n=f[27].length+"")&&O(s,n),p[0]&2&&o!==(o=f[1].length+"")&&O(a,o)},d(f){f&&k(e)}}}function $l(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",c(e,"class","btn-small svelte-16e85dp")},m(s,r){w(s,e,r),t||(n=A(e,"click",l[36]),t=!0)},p:V,d(s){s&&k(e),t=!1,n()}}}function xl(l){let e;function t(r,o){return r[10]?Ii:r[14]?Ai:r[26].length===0&&r[6]?Ei:r[2].length===0?Li:Fi}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),c(e,"class","log-content svelte-16e85dp"),j(e,"expanded",l[19])},m(r,o){w(r,e,o),s.m(e,null),l[51](e)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),o[0]&524288&&j(e,"expanded",r[19])},d(r){r&&k(e),s.d(),l[51](null)}}}function Fi(l){let e,t,n,s=Ue(l[26]),r=[];for(let a=0;a<s.length;a+=1)r[a]=es(jl(l,s,a));let o=l[6]&&l[26].length>0&&ts(l);return{c(){e=d("div");for(let a=0;a<r.length;a+=1)r[a].c();t=b(),o&&o.c(),n=$e(),c(e,"class","log-list svelte-16e85dp")},m(a,u){w(a,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);w(a,t,u),o&&o.m(a,u),w(a,n,u)},p(a,u){if(u[0]&67108864){s=Ue(a[26]);let f;for(f=0;f<s.length;f+=1){const p=jl(a,s,f);r[f]?r[f].p(p,u):(r[f]=es(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}a[6]&&a[26].length>0?o?o.p(a,u):(o=ts(a),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(a){a&&(k(e),k(t),k(n)),qt(r,a),o&&o.d(a)}}}function Li(l){let e;return{c(){e=d("div"),e.textContent="No older logs available (logs from 2 boots ago)",c(e,"class","no-data svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Ei(l){let e,t,n,s;return{c(){e=d("div"),t=C('No logs match filter "'),n=C(l[6]),s=C('"'),c(e,"class","no-results svelte-16e85dp")},m(r,o){w(r,e,o),i(e,t),i(e,n),i(e,s)},p(r,o){o[0]&64&&O(n,r[6])},d(r){r&&k(e)}}}function Ai(l){let e,t,n;return{c(){e=d("div"),t=C("Error: "),n=C(l[14]),c(e,"class","error svelte-16e85dp")},m(s,r){w(s,e,r),i(e,t),i(e,n)},p(s,r){r[0]&16384&&O(n,s[14])},d(s){s&&k(e)}}}function Ii(l){let e;return{c(){e=d("div"),e.textContent="Loading older logs...",c(e,"class","loading svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function es(l){let e,t=l[58]+"",n;return{c(){e=d("div"),n=C(t),c(e,"class","log-line svelte-16e85dp")},m(s,r){w(s,e,r),i(e,n)},p(s,r){r[0]&67108864&&t!==(t=s[58]+"")&&O(n,t)},d(s){s&&k(e)}}}function ts(l){let e,t,n=l[26].length+"",s,r,o=l[2].length+"",a,u;return{c(){e=d("div"),t=C("Showing "),s=C(n),r=C(" of "),a=C(o),u=C(" logs"),c(e,"class","filter-info svelte-16e85dp")},m(f,p){w(f,e,p),i(e,t),i(e,s),i(e,r),i(e,a),i(e,u)},p(f,p){p[0]&67108864&&n!==(n=f[26].length+"")&&O(s,n),p[0]&4&&o!==(o=f[2].length+"")&&O(a,o)},d(f){f&&k(e)}}}function ls(l){let e,t,n;return{c(){e=d("button"),e.textContent="Clear",c(e,"class","btn-small svelte-16e85dp")},m(s,r){w(s,e,r),t||(n=A(e,"click",l[37]),t=!0)},p:V,d(s){s&&k(e),t=!1,n()}}}function ss(l){let e;function t(r,o){return r[11]?Ri:r[15]?Mi:r[25].length===0&&r[7]?Oi:r[3].length===0?Pi:Ni}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),c(e,"class","log-content svelte-16e85dp"),j(e,"expanded",l[20])},m(r,o){w(r,e,o),s.m(e,null),l[54](e)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null))),o[0]&1048576&&j(e,"expanded",r[20])},d(r){r&&k(e),s.d(),l[54](null)}}}function Ni(l){let e,t,n,s=Ue(l[25]),r=[];for(let a=0;a<s.length;a+=1)r[a]=ns(Wl(l,s,a));let o=l[7]&&l[25].length>0&&rs(l);return{c(){e=d("div");for(let a=0;a<r.length;a+=1)r[a].c();t=b(),o&&o.c(),n=$e(),c(e,"class","log-list svelte-16e85dp")},m(a,u){w(a,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);w(a,t,u),o&&o.m(a,u),w(a,n,u)},p(a,u){if(u[0]&33554432){s=Ue(a[25]);let f;for(f=0;f<s.length;f+=1){const p=Wl(a,s,f);r[f]?r[f].p(p,u):(r[f]=ns(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=s.length}a[7]&&a[25].length>0?o?o.p(a,u):(o=rs(a),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(a){a&&(k(e),k(t),k(n)),qt(r,a),o&&o.d(a)}}}function Pi(l){let e;return{c(){e=d("div"),e.textContent="No access logs available",c(e,"class","no-data svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Oi(l){let e,t,n,s;return{c(){e=d("div"),t=C('No logs match filter "'),n=C(l[7]),s=C('"'),c(e,"class","no-results svelte-16e85dp")},m(r,o){w(r,e,o),i(e,t),i(e,n),i(e,s)},p(r,o){o[0]&128&&O(n,r[7])},d(r){r&&k(e)}}}function Mi(l){let e,t,n;return{c(){e=d("div"),t=C("Error: "),n=C(l[15]),c(e,"class","error svelte-16e85dp")},m(s,r){w(s,e,r),i(e,t),i(e,n)},p(s,r){r[0]&32768&&O(n,s[15])},d(s){s&&k(e)}}}function Ri(l){let e;return{c(){e=d("div"),e.textContent="Loading access logs...",c(e,"class","loading svelte-16e85dp")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function ns(l){let e,t=l[58]+"",n;return{c(){e=d("div"),n=C(t),c(e,"class","log-line svelte-16e85dp")},m(s,r){w(s,e,r),i(e,n)},p(s,r){r[0]&33554432&&t!==(t=s[58]+"")&&O(n,t)},d(s){s&&k(e)}}}function rs(l){let e,t,n=l[25].length+"",s,r,o=l[3].length+"",a,u;return{c(){e=d("div"),t=C("Showing "),s=C(n),r=C(" of "),a=C(o),u=C(" logs"),c(e,"class","filter-info svelte-16e85dp")},m(f,p){w(f,e,p),i(e,t),i(e,s),i(e,r),i(e,a),i(e,u)},p(f,p){p[0]&33554432&&n!==(n=f[25].length+"")&&O(s,n),p[0]&8&&o!==(o=f[3].length+"")&&O(a,o)},d(f){f&&k(e)}}}function Di(l){let e,t,n,s,r,o,a,u=l[16]?"Auto-refresh On":"Auto-refresh Off",f,p,m,v,_,h,g,q,T,S,y=l[17]?"â–¼":"â–¶",F,N,M,L,E,P,K,I,U,H,R,Y,W,B,X,Z,ne=l[18]?"â–¼":"â–¶",ae,se,G,le,Q,D,$,te,re,Je,Me,lt,He,Ie,De,Se,Ce=l[19]?"â–¼":"â–¶",he,fe,we,mt,Oe,ye,at,de,Te,be,vt,Ke,_t,ze,Be,We,ft=l[20]?"â–¼":"â–¶",bt,ee,qe,xe,rt,Ye,Tt,it,Qe,Ct,nt,yt,ct,Ft,je=l[4]&&Vl(l),Ne=l[17]&&Gl(l),Fe=l[5]&&Yl(l),Ve=l[18]&&Ql(l),Re=l[6]&&$l(l),ke=l[19]&&xl(l),x=l[7]&&ls(l),ie=l[20]&&ss(l);return{c(){e=b(),t=d("div"),n=d("div"),s=d("h1"),s.textContent="Logs & Diagnostics",r=b(),o=d("div"),a=d("button"),f=C(u),p=C(" ("),m=C(In),v=C("s)"),_=b(),h=d("button"),h.textContent="Refresh Now",g=b(),q=d("div"),T=d("div"),S=d("button"),F=C(y),N=b(),M=d("h2"),M.textContent="System Logs",L=b(),E=d("div"),P=d("input"),K=b(),je&&je.c(),I=b(),U=d("button"),H=C("Export"),Y=b(),Ne&&Ne.c(),W=b(),B=d("div"),X=d("div"),Z=d("button"),ae=C(ne),se=b(),G=d("h2"),G.textContent="Previous System Logs",le=b(),Q=d("div"),D=d("input"),$=b(),Fe&&Fe.c(),te=b(),re=d("button"),Je=C("Export"),lt=b(),Ve&&Ve.c(),He=b(),Ie=d("div"),De=d("div"),Se=d("button"),he=C(Ce),fe=b(),we=d("h2"),we.textContent="Older Logs (2 boots ago)",mt=b(),Oe=d("div"),ye=d("input"),at=b(),Re&&Re.c(),de=b(),Te=d("button"),be=C("Export"),Ke=b(),ke&&ke.c(),_t=b(),ze=d("div"),Be=d("div"),We=d("button"),bt=C(ft),ee=b(),qe=d("h2"),qe.textContent="Access Logs",xe=b(),rt=d("div"),Ye=d("input"),Tt=b(),x&&x.c(),it=b(),Qe=d("button"),Ct=C("Export"),yt=b(),ie&&ie.c(),_i.title="Logs & Diagnostics - MouseTrap",c(s,"class","svelte-16e85dp"),c(a,"class","btn svelte-16e85dp"),j(a,"active",l[16]),c(h,"class","btn svelte-16e85dp"),c(o,"class","header-controls svelte-16e85dp"),c(n,"class","header svelte-16e85dp"),c(S,"class","expand-btn svelte-16e85dp"),c(M,"class","svelte-16e85dp"),c(P,"type","text"),c(P,"class","filter-input svelte-16e85dp"),c(P,"placeholder","Filter logs..."),c(U,"class","btn-small svelte-16e85dp"),U.disabled=R=l[0].length===0,c(E,"class","log-controls svelte-16e85dp"),c(T,"class","log-header svelte-16e85dp"),c(q,"class","log-section svelte-16e85dp"),c(Z,"class","expand-btn svelte-16e85dp"),c(G,"class","svelte-16e85dp"),c(D,"type","text"),c(D,"class","filter-input svelte-16e85dp"),c(D,"placeholder","Filter logs..."),c(re,"class","btn-small svelte-16e85dp"),re.disabled=Me=l[1].length===0,c(Q,"class","log-controls svelte-16e85dp"),c(X,"class","log-header svelte-16e85dp"),c(B,"class","log-section svelte-16e85dp"),c(Se,"class","expand-btn svelte-16e85dp"),c(we,"class","svelte-16e85dp"),c(ye,"type","text"),c(ye,"class","filter-input svelte-16e85dp"),c(ye,"placeholder","Filter logs..."),c(Te,"class","btn-small svelte-16e85dp"),Te.disabled=vt=l[2].length===0,c(Oe,"class","log-controls svelte-16e85dp"),c(De,"class","log-header svelte-16e85dp"),c(Ie,"class","log-section svelte-16e85dp"),c(We,"class","expand-btn svelte-16e85dp"),c(qe,"class","svelte-16e85dp"),c(Ye,"type","text"),c(Ye,"class","filter-input svelte-16e85dp"),c(Ye,"placeholder","Filter logs..."),c(Qe,"class","btn-small svelte-16e85dp"),Qe.disabled=nt=l[3].length===0,c(rt,"class","log-controls svelte-16e85dp"),c(Be,"class","log-header svelte-16e85dp"),c(ze,"class","log-section svelte-16e85dp"),c(t,"class","logs-container svelte-16e85dp")},m(oe,ve){w(oe,e,ve),w(oe,t,ve),i(t,n),i(n,s),i(n,r),i(n,o),i(o,a),i(a,f),i(a,p),i(a,m),i(a,v),i(o,_),i(o,h),i(t,g),i(t,q),i(q,T),i(T,S),i(S,F),i(T,N),i(T,M),i(T,L),i(T,E),i(E,P),ce(P,l[4]),i(E,K),je&&je.m(E,null),i(E,I),i(E,U),i(U,H),i(q,Y),Ne&&Ne.m(q,null),i(t,W),i(t,B),i(B,X),i(X,Z),i(Z,ae),i(X,se),i(X,G),i(X,le),i(X,Q),i(Q,D),ce(D,l[5]),i(Q,$),Fe&&Fe.m(Q,null),i(Q,te),i(Q,re),i(re,Je),i(B,lt),Ve&&Ve.m(B,null),i(t,He),i(t,Ie),i(Ie,De),i(De,Se),i(Se,he),i(De,fe),i(De,we),i(De,mt),i(De,Oe),i(Oe,ye),ce(ye,l[6]),i(Oe,at),Re&&Re.m(Oe,null),i(Oe,de),i(Oe,Te),i(Te,be),i(Ie,Ke),ke&&ke.m(Ie,null),i(t,_t),i(t,ze),i(ze,Be),i(Be,We),i(We,bt),i(Be,ee),i(Be,qe),i(Be,xe),i(Be,rt),i(rt,Ye),ce(Ye,l[7]),i(rt,Tt),x&&x.m(rt,null),i(rt,it),i(rt,Qe),i(Qe,Ct),i(ze,yt),ie&&ie.m(ze,null),ct||(Ft=[A(a,"click",l[33]),A(h,"click",l[42]),A(S,"click",l[38]),A(P,"input",l[43]),A(U,"click",l[44]),A(Z,"click",l[39]),A(D,"input",l[46]),A(re,"click",l[47]),A(Se,"click",l[40]),A(ye,"input",l[49]),A(Te,"click",l[50]),A(We,"click",l[41]),A(Ye,"input",l[52]),A(Qe,"click",l[53])],ct=!0)},p(oe,ve){ve[0]&65536&&u!==(u=oe[16]?"Auto-refresh On":"Auto-refresh Off")&&O(f,u),ve[0]&65536&&j(a,"active",oe[16]),ve[0]&131072&&y!==(y=oe[17]?"â–¼":"â–¶")&&O(F,y),ve[0]&16&&P.value!==oe[4]&&ce(P,oe[4]),oe[4]?je?je.p(oe,ve):(je=Vl(oe),je.c(),je.m(E,I)):je&&(je.d(1),je=null),ve[0]&1&&R!==(R=oe[0].length===0)&&(U.disabled=R),oe[17]?Ne?Ne.p(oe,ve):(Ne=Gl(oe),Ne.c(),Ne.m(q,null)):Ne&&(Ne.d(1),Ne=null),ve[0]&262144&&ne!==(ne=oe[18]?"â–¼":"â–¶")&&O(ae,ne),ve[0]&32&&D.value!==oe[5]&&ce(D,oe[5]),oe[5]?Fe?Fe.p(oe,ve):(Fe=Yl(oe),Fe.c(),Fe.m(Q,te)):Fe&&(Fe.d(1),Fe=null),ve[0]&2&&Me!==(Me=oe[1].length===0)&&(re.disabled=Me),oe[18]?Ve?Ve.p(oe,ve):(Ve=Ql(oe),Ve.c(),Ve.m(B,null)):Ve&&(Ve.d(1),Ve=null),ve[0]&524288&&Ce!==(Ce=oe[19]?"â–¼":"â–¶")&&O(he,Ce),ve[0]&64&&ye.value!==oe[6]&&ce(ye,oe[6]),oe[6]?Re?Re.p(oe,ve):(Re=$l(oe),Re.c(),Re.m(Oe,de)):Re&&(Re.d(1),Re=null),ve[0]&4&&vt!==(vt=oe[2].length===0)&&(Te.disabled=vt),oe[19]?ke?ke.p(oe,ve):(ke=xl(oe),ke.c(),ke.m(Ie,null)):ke&&(ke.d(1),ke=null),ve[0]&1048576&&ft!==(ft=oe[20]?"â–¼":"â–¶")&&O(bt,ft),ve[0]&128&&Ye.value!==oe[7]&&ce(Ye,oe[7]),oe[7]?x?x.p(oe,ve):(x=ls(oe),x.c(),x.m(rt,it)):x&&(x.d(1),x=null),ve[0]&8&&nt!==(nt=oe[3].length===0)&&(Qe.disabled=nt),oe[20]?ie?ie.p(oe,ve):(ie=ss(oe),ie.c(),ie.m(ze,null)):ie&&(ie.d(1),ie=null)},i:V,o:V,d(oe){oe&&(k(e),k(t)),je&&je.d(),Ne&&Ne.d(),Fe&&Fe.d(),Ve&&Ve.d(),Re&&Re.d(),ke&&ke.d(),x&&x.d(),ie&&ie.d(),ct=!1,Ae(Ft)}}}let In=5;function zt(l,e){const t=l.join(`
`),n=new Blob([t],{type:"text/plain"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=e,r.click(),URL.revokeObjectURL(s)}function Ui(l,e,t){let n,s,r,o,a=[],u=[],f=[],p=[],m=!0,v=!0,_=!0,h=!0,g=null,q=null,T=null,S=null,y=!1,F=null,N="",M="",L="",E="",P=!0,K=!0,I=!1,U=!0,H,R,Y,W;async function B(de=!0){const Te=(H==null?void 0:H.scrollTop)||0;de&&t(8,m=!0),t(12,g=null);try{t(0,a=await vr())}catch(be){console.error("Failed to fetch system logs:",be),t(12,g=be.message),t(0,a=[])}finally{de&&t(8,m=!1),H&&Te>0&&requestAnimationFrame(()=>{t(21,H.scrollTop=Te,H)})}}async function X(de=!0){const Te=(R==null?void 0:R.scrollTop)||0;de&&t(9,v=!0),t(13,q=null);try{t(1,u=await _r())}catch(be){console.error("Failed to fetch previous logs:",be),t(13,q=be.message),t(1,u=[])}finally{de&&t(9,v=!1),R&&Te>0&&requestAnimationFrame(()=>{t(22,R.scrollTop=Te,R)})}}async function Z(de=!0){const Te=(Y==null?void 0:Y.scrollTop)||0;de&&t(10,_=!0),t(14,T=null);try{t(2,f=await br())}catch(be){console.error("Failed to fetch older logs:",be),t(14,T=be.message),t(2,f=[])}finally{de&&t(10,_=!1),Y&&Te>0&&requestAnimationFrame(()=>{t(23,Y.scrollTop=Te,Y)})}}async function ne(de=!0){const Te=(W==null?void 0:W.scrollTop)||0;de&&t(11,h=!0),t(15,S=null);try{t(3,p=await gr())}catch(be){console.error("Failed to fetch access logs:",be),t(15,S=be.message),t(3,p=[])}finally{de&&t(11,h=!1),W&&Te>0&&requestAnimationFrame(()=>{t(24,W.scrollTop=Te,W)})}}function ae(){t(16,y=!y),y?se():G()}function se(){G(),F=setInterval(()=>{B(!1),X(!1),Z(!1),ne(!1)},In*1e3)}function G(){F&&(clearInterval(F),F=null)}function le(){t(4,N="")}function Q(){t(5,M="")}function D(){t(6,L="")}function $(){t(7,E="")}function te(){t(17,P=!P)}function re(){t(18,K=!K)}function Je(){t(19,I=!I)}function Me(){t(20,U=!U)}ht(()=>{B(),X(),Z(),ne()}),It(()=>{G()});const lt=()=>{B(!0),X(!0),Z(!0),ne(!0)};function He(){N=this.value,t(4,N)}const Ie=()=>zt(a,"system-logs.txt");function De(de){Et[de?"unshift":"push"](()=>{H=de,t(21,H)})}function Se(){M=this.value,t(5,M)}const Ce=()=>zt(u,"previous-logs.txt");function he(de){Et[de?"unshift":"push"](()=>{R=de,t(22,R)})}function fe(){L=this.value,t(6,L)}const we=()=>zt(f,"older-logs.txt");function mt(de){Et[de?"unshift":"push"](()=>{Y=de,t(23,Y)})}function Oe(){E=this.value,t(7,E)}const ye=()=>zt(p,"access-logs.txt");function at(de){Et[de?"unshift":"push"](()=>{W=de,t(24,W)})}return l.$$.update=()=>{l.$$.dirty[0]&17&&t(28,n=a.filter(de=>de.toLowerCase().includes(N.toLowerCase()))),l.$$.dirty[0]&34&&t(27,s=u.filter(de=>de.toLowerCase().includes(M.toLowerCase()))),l.$$.dirty[0]&68&&t(26,r=f.filter(de=>de.toLowerCase().includes(L.toLowerCase()))),l.$$.dirty[0]&136&&t(25,o=p.filter(de=>de.toLowerCase().includes(E.toLowerCase())))},[a,u,f,p,N,M,L,E,m,v,_,h,g,q,T,S,y,P,K,I,U,H,R,Y,W,o,r,s,n,B,X,Z,ne,ae,le,Q,D,$,te,re,Je,Me,lt,He,Ie,De,Se,Ce,he,fe,we,mt,Oe,ye,at]}class is extends tt{constructor(e){super(),et(this,e,Ui,Di,Xe,{},null,[-1,-1,-1])}}function Hi(l){let e,t,n,s,r,o,a,u,f,p,m=l[6]&&os();return n=new Ze({props:{$$slots:{default:[ji]},$$scope:{ctx:l}}}),r=new Ze({props:{$$slots:{default:[zi]},$$scope:{ctx:l}}}),a=new Ze({props:{$$slots:{default:[Yi]},$$scope:{ctx:l}}}),f=new Ze({props:{$$slots:{default:[Xi]},$$scope:{ctx:l}}}),{c(){m&&m.c(),e=b(),t=d("div"),_e(n.$$.fragment),s=b(),_e(r.$$.fragment),o=b(),_e(a.$$.fragment),u=b(),_e(f.$$.fragment),c(t,"class","cards-grid svelte-qwtv9g")},m(v,_){m&&m.m(v,_),w(v,e,_),w(v,t,_),pe(n,t,null),i(t,s),pe(r,t,null),i(t,o),pe(a,t,null),i(t,u),pe(f,t,null),p=!0},p(v,_){v[6]?m||(m=os(),m.c(),m.m(e.parentNode,e)):m&&(m.d(1),m=null);const h={};_&65537&&(h.$$scope={dirty:_,ctx:v}),n.$set(h);const g={};_&65552&&(g.$$scope={dirty:_,ctx:v}),r.$set(g);const q={};_&65596&&(q.$$scope={dirty:_,ctx:v}),a.$set(q);const T={};_&65537&&(T.$$scope={dirty:_,ctx:v}),f.$set(T)},i(v){p||(z(n.$$.fragment,v),z(r.$$.fragment,v),z(a.$$.fragment,v),z(f.$$.fragment,v),p=!0)},o(v){J(n.$$.fragment,v),J(r.$$.fragment,v),J(a.$$.fragment,v),J(f.$$.fragment,v),p=!1},d(v){v&&(k(e),k(t)),m&&m.d(v),me(n),me(r),me(a),me(f)}}}function Wi(l){let e,t,n;return t=new ot({}),{c(){e=d("div"),_e(t.$$.fragment),c(e,"class","loading-container svelte-qwtv9g")},m(s,r){w(s,e,r),pe(t,e,null),n=!0},p:V,i(s){n||(z(t.$$.fragment,s),n=!0)},o(s){J(t.$$.fragment,s),n=!1},d(s){s&&k(e),me(t)}}}function os(l){let e;return{c(){e=d("div"),e.textContent="Device is back online!",c(e,"class","online-banner svelte-qwtv9g")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function as(l){let e,t,n=l[0].buildDate+"",s;return{c(){e=d("div"),t=C("Built: "),s=C(n),c(e,"class","build-date svelte-qwtv9g")},m(r,o){w(r,e,o),i(e,t),i(e,s)},p(r,o){o&1&&n!==(n=r[0].buildDate+"")&&O(s,n)},d(r){r&&k(e)}}}function cs(l){let e,t,n,s,r=l[0].chipModel+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="Chip Model",n=b(),s=d("td"),o=C(r),c(t,"class","label svelte-qwtv9g"),c(s,"class","value svelte-qwtv9g"),c(e,"class","svelte-qwtv9g")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&1&&r!==(r=a[0].chipModel+"")&&O(o,r)},d(a){a&&k(e)}}}function us(l){let e,t,n,s,r=_s(l[0].cpuFreq)+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="CPU Frequency",n=b(),s=d("td"),o=C(r),c(t,"class","label svelte-qwtv9g"),c(s,"class","value svelte-qwtv9g"),c(e,"class","svelte-qwtv9g")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&1&&r!==(r=_s(a[0].cpuFreq)+"")&&O(o,r)},d(a){a&&k(e)}}}function fs(l){let e,t,n,s,r=Qt(l[0].flashSize)+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="Flash Size",n=b(),s=d("td"),o=C(r),c(t,"class","label svelte-qwtv9g"),c(s,"class","value svelte-qwtv9g"),c(e,"class","svelte-qwtv9g")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&1&&r!==(r=Qt(a[0].flashSize)+"")&&O(o,r)},d(a){a&&k(e)}}}function ds(l){let e,t,n,s,r=Qt(l[0].psramSize)+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="PSRAM Size",n=b(),s=d("td"),o=C(r),c(t,"class","label svelte-qwtv9g"),c(s,"class","value svelte-qwtv9g"),c(e,"class","svelte-qwtv9g")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&1&&r!==(r=Qt(a[0].psramSize)+"")&&O(o,r)},d(a){a&&k(e)}}}function ps(l){let e,t,n,s,r=l[0].macAddress+"",o;return{c(){e=d("tr"),t=d("td"),t.textContent="MAC Address",n=b(),s=d("td"),o=C(r),c(t,"class","label svelte-qwtv9g"),c(s,"class","value svelte-qwtv9g"),c(e,"class","svelte-qwtv9g")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&1&&r!==(r=a[0].macAddress+"")&&O(o,r)},d(a){a&&k(e)}}}function ji(l){var N,M,L,E,P,K,I;let e,t,n,s=(((N=l[0])==null?void 0:N.firmwareVersion)||"Unknown")+"",r,o,a,u,f,p,m,v,_,h,g=((M=l[0])==null?void 0:M.buildDate)&&as(l),q=((L=l[0])==null?void 0:L.chipModel)&&cs(l),T=((E=l[0])==null?void 0:E.cpuFreq)&&us(l),S=((P=l[0])==null?void 0:P.flashSize)&&fs(l),y=((K=l[0])==null?void 0:K.psramSize)&&ds(l),F=((I=l[0])==null?void 0:I.macAddress)&&ps(l);return{c(){e=d("h2"),e.textContent="ESP32 Sketch",t=b(),n=d("div"),r=C(s),o=b(),g&&g.c(),a=b(),u=d("div"),f=d("table"),p=d("tbody"),q&&q.c(),m=b(),T&&T.c(),v=b(),S&&S.c(),_=b(),y&&y.c(),h=b(),F&&F.c(),c(e,"class","svelte-qwtv9g"),c(n,"class","firmware-version svelte-qwtv9g"),c(f,"class","svelte-qwtv9g"),c(u,"class","device-info svelte-qwtv9g")},m(U,H){w(U,e,H),w(U,t,H),w(U,n,H),i(n,r),w(U,o,H),g&&g.m(U,H),w(U,a,H),w(U,u,H),i(u,f),i(f,p),q&&q.m(p,null),i(p,m),T&&T.m(p,null),i(p,v),S&&S.m(p,null),i(p,_),y&&y.m(p,null),i(p,h),F&&F.m(p,null)},p(U,H){var R,Y,W,B,X,Z,ne;H&1&&s!==(s=(((R=U[0])==null?void 0:R.firmwareVersion)||"Unknown")+"")&&O(r,s),(Y=U[0])!=null&&Y.buildDate?g?g.p(U,H):(g=as(U),g.c(),g.m(a.parentNode,a)):g&&(g.d(1),g=null),(W=U[0])!=null&&W.chipModel?q?q.p(U,H):(q=cs(U),q.c(),q.m(p,m)):q&&(q.d(1),q=null),(B=U[0])!=null&&B.cpuFreq?T?T.p(U,H):(T=us(U),T.c(),T.m(p,v)):T&&(T.d(1),T=null),(X=U[0])!=null&&X.flashSize?S?S.p(U,H):(S=fs(U),S.c(),S.m(p,_)):S&&(S.d(1),S=null),(Z=U[0])!=null&&Z.psramSize?y?y.p(U,H):(y=ds(U),y.c(),y.m(p,h)):y&&(y.d(1),y=null),(ne=U[0])!=null&&ne.macAddress?F?F.p(U,H):(F=ps(U),F.c(),F.m(p,null)):F&&(F.d(1),F=null)},d(U){U&&(k(e),k(t),k(n),k(o),k(a),k(u)),g&&g.d(U),q&&q.d(),T&&T.d(),S&&S.d(),y&&y.d(),F&&F.d()}}}function zi(l){let e,t,n,s,r,o,a,u,f,p;return{c(){e=d("h2"),e.textContent="OTA Update",t=b(),n=d("p"),n.textContent="Upload new firmware via the web-based OTA interface.",s=b(),r=d("button"),o=C("Open OTA Update Interface"),a=b(),u=d("div"),u.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 12H7V7h2v5zm0-6H7V4h2v2z"></path></svg>
          Device will reboot after update`,c(e,"class","svelte-qwtv9g"),c(n,"class","description svelte-qwtv9g"),c(r,"class","ota-button svelte-qwtv9g"),r.disabled=l[4],c(u,"class","warning-text svelte-qwtv9g")},m(m,v){w(m,e,v),w(m,t,v),w(m,n,v),w(m,s,v),w(m,r,v),i(r,o),w(m,a,v),w(m,u,v),f||(p=A(r,"click",xi),f=!0)},p(m,v){v&16&&(r.disabled=m[4])},d(m){m&&(k(e),k(t),k(n),k(s),k(r),k(a),k(u)),f=!1,p()}}}function Bi(l){let e,t,n,s,r,o,a;return{c(){e=d("p"),e.textContent="Restart the device to apply configuration changes or recover from errors.",t=b(),n=d("button"),n.textContent="Reboot Device",s=b(),r=d("div"),r.innerHTML=`<svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M8 0C3.6 0 0 3.6 0 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm1 12H7V7h2v5zm0-6H7V4h2v2z"></path></svg>
            Device will be unavailable for approximately 30 seconds`,c(e,"class","description svelte-qwtv9g"),c(n,"class","reboot-button svelte-qwtv9g"),c(r,"class","warning-text svelte-qwtv9g")},m(u,f){w(u,e,f),w(u,t,f),w(u,n,f),w(u,s,f),w(u,r,f),o||(a=A(n,"click",l[7]),o=!0)},p:V,i:V,o:V,d(u){u&&(k(e),k(t),k(n),k(s),k(r)),o=!1,a()}}}function Vi(l){let e,t,n,s,r,o,a,u=l[3]!==1?"s":"",f,p,m,v,_,h;return{c(){e=d("div"),t=d("p"),t.textContent="Are you sure you want to reboot the device?",n=b(),s=d("div"),r=C("Rebooting in "),o=C(l[3]),a=C(" second"),f=C(u),p=C("..."),m=b(),v=d("button"),v.textContent="Cancel",c(t,"class","confirm-text svelte-qwtv9g"),c(s,"class","countdown svelte-qwtv9g"),c(v,"class","cancel-button svelte-qwtv9g"),c(e,"class","confirm-container svelte-qwtv9g")},m(g,q){w(g,e,q),i(e,t),i(e,n),i(e,s),i(s,r),i(s,o),i(s,a),i(s,f),i(s,p),i(e,m),i(e,v),_||(h=A(v,"click",l[8]),_=!0)},p(g,q){q&8&&O(o,g[3]),q&8&&u!==(u=g[3]!==1?"s":"")&&O(f,u)},i:V,o:V,d(g){g&&k(e),_=!1,h()}}}function Gi(l){let e,t,n,s,r;t=new ot({});function o(f,p){return f[5]?Ki:Ji}let a=o(l),u=a(l);return{c(){e=d("div"),_e(t.$$.fragment),n=b(),s=d("div"),u.c(),c(s,"class","rebooting-text svelte-qwtv9g"),c(e,"class","rebooting-container svelte-qwtv9g")},m(f,p){w(f,e,p),pe(t,e,null),i(e,n),i(e,s),u.m(s,null),r=!0},p(f,p){a!==(a=o(f))&&(u.d(1),u=a(f),u&&(u.c(),u.m(s,null)))},i(f){r||(z(t.$$.fragment,f),r=!0)},o(f){J(t.$$.fragment,f),r=!1},d(f){f&&k(e),me(t),u.d()}}}function Ji(l){let e;return{c(){e=C("Rebooting device...")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Ki(l){let e;return{c(){e=C("Waiting for device to come back online...")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Yi(l){let e,t,n,s,r,o;const a=[Gi,Vi,Bi],u=[];function f(p,m){return p[4]?0:p[2]?1:2}return n=f(l),s=u[n]=a[n](l),{c(){e=d("h2"),e.textContent="Device Reboot",t=b(),s.c(),r=$e(),c(e,"class","svelte-qwtv9g")},m(p,m){w(p,e,m),w(p,t,m),u[n].m(p,m),w(p,r,m),o=!0},p(p,m){let v=n;n=f(p),n===v?u[n].p(p,m):(Le(),J(u[v],1,1,()=>{u[v]=null}),Ee(),s=u[n],s?s.p(p,m):(s=u[n]=a[n](p),s.c()),z(s,1),s.m(r.parentNode,r))},i(p){o||(z(s),o=!0)},o(p){J(s),o=!1},d(p){p&&(k(e),k(t),k(r)),u[n].d(p)}}}function Qi(l){let e;return{c(){e=d("p"),e.textContent="No version information available",c(e,"class","placeholder-text svelte-qwtv9g")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Zi(l){let e,t,n,s,r,o=(l[0].firmwareVersion||"Unknown")+"",a,u,f,p,m,v,_=Bt(l[0].firmwareUpdateTime)+"",h,g,q,T,S,y,F,N=Bt(l[0].filesystemUpdateTime)+"",M,L,E=l[0].filesystemVersion&&ms(l),P=l[0].sdkVersion&&vs(l);return{c(){e=d("div"),t=d("div"),n=d("div"),n.textContent="Sketch Version:",s=b(),r=d("div"),a=C(o),u=b(),f=d("div"),p=d("div"),p.textContent="Last Firmware Update:",m=b(),v=d("div"),h=C(_),g=b(),E&&E.c(),q=b(),T=d("div"),S=d("div"),S.textContent="Last Filesystem Update:",y=b(),F=d("div"),M=C(N),L=b(),P&&P.c(),c(n,"class","history-label svelte-qwtv9g"),c(r,"class","history-value svelte-qwtv9g"),c(t,"class","history-item svelte-qwtv9g"),c(p,"class","timestamp-label svelte-qwtv9g"),c(v,"class","timestamp-value svelte-qwtv9g"),c(f,"class","timestamp-item svelte-qwtv9g"),c(S,"class","timestamp-label svelte-qwtv9g"),c(F,"class","timestamp-value svelte-qwtv9g"),c(T,"class","timestamp-item svelte-qwtv9g"),c(e,"class","update-history svelte-qwtv9g")},m(K,I){w(K,e,I),i(e,t),i(t,n),i(t,s),i(t,r),i(r,a),i(e,u),i(e,f),i(f,p),i(f,m),i(f,v),i(v,h),i(e,g),E&&E.m(e,null),i(e,q),i(e,T),i(T,S),i(T,y),i(T,F),i(F,M),i(e,L),P&&P.m(e,null)},p(K,I){I&1&&o!==(o=(K[0].firmwareVersion||"Unknown")+"")&&O(a,o),I&1&&_!==(_=Bt(K[0].firmwareUpdateTime)+"")&&O(h,_),K[0].filesystemVersion?E?E.p(K,I):(E=ms(K),E.c(),E.m(e,q)):E&&(E.d(1),E=null),I&1&&N!==(N=Bt(K[0].filesystemUpdateTime)+"")&&O(M,N),K[0].sdkVersion?P?P.p(K,I):(P=vs(K),P.c(),P.m(e,null)):P&&(P.d(1),P=null)},d(K){K&&k(e),E&&E.d(),P&&P.d()}}}function ms(l){let e,t,n,s,r=l[0].filesystemVersion+"",o;return{c(){e=d("div"),t=d("div"),t.textContent="Svelte App Version:",n=b(),s=d("div"),o=C(r),c(t,"class","history-label svelte-qwtv9g"),c(s,"class","history-value svelte-qwtv9g"),c(e,"class","history-item svelte-qwtv9g")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&1&&r!==(r=a[0].filesystemVersion+"")&&O(o,r)},d(a){a&&k(e)}}}function vs(l){let e,t,n,s,r=l[0].sdkVersion+"",o;return{c(){e=d("div"),t=d("div"),t.textContent="ESP32 SDK:",n=b(),s=d("div"),o=C(r),c(t,"class","history-label svelte-qwtv9g"),c(s,"class","history-value svelte-qwtv9g"),c(e,"class","history-item svelte-qwtv9g")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&1&&r!==(r=a[0].sdkVersion+"")&&O(o,r)},d(a){a&&k(e)}}}function Xi(l){let e,t,n;function s(a,u){return a[0]?Zi:Qi}let r=s(l),o=r(l);return{c(){e=d("h2"),e.textContent="Version Information",t=b(),o.c(),n=$e(),c(e,"class","svelte-qwtv9g")},m(a,u){w(a,e,u),w(a,t,u),o.m(a,u),w(a,n,u)},p(a,u){r===(r=s(a))&&o?o.p(a,u):(o.d(1),o=r(a),o&&(o.c(),o.m(n.parentNode,n)))},d(a){a&&(k(e),k(t),k(n)),o.d(a)}}}function $i(l){let e,t,n,s,r,o;const a=[Wi,Hi],u=[];function f(p,m){return p[1]?0:1}return s=f(l),r=u[s]=a[s](l),{c(){e=d("div"),t=d("h1"),t.textContent="Firmware & Updates",n=b(),r.c(),c(t,"class","svelte-qwtv9g"),c(e,"class","firmware-container svelte-qwtv9g")},m(p,m){w(p,e,m),i(e,t),i(e,n),u[s].m(e,null),o=!0},p(p,[m]){let v=s;s=f(p),s===v?u[s].p(p,m):(Le(),J(u[v],1,1,()=>{u[v]=null}),Ee(),r=u[s],r?r.p(p,m):(r=u[s]=a[s](p),r.c()),z(r,1),r.m(e,null))},i(p){o||(z(r),o=!0)},o(p){J(r),o=!1},d(p){p&&k(e),u[s].d()}}}function xi(){window.open("/update","_blank")}function Qt(l){return l?`${(l/(1024*1024)).toFixed(2)} MB`:"N/A"}function _s(l){return l?`${l} MHz`:"N/A"}function Bt(l){return!l||l===0?"Never":new Date(l*1e3).toLocaleString()}function eo(l,e,t){let n=null,s=!0,r=!1,o=0,a=!1,u=!1,f=!1,p=null,m=null,v=null;ht(async()=>{await _(),v=setInterval(async()=>{!a&&!r&&await _()},3e4)}),It(()=>{p&&clearInterval(p),m&&clearInterval(m),v&&clearInterval(v)});async function _(){t(1,s=!0);try{t(0,n=await Fn())}catch(S){console.warn("Failed to load system info:",S),t(0,n=null)}finally{t(1,s=!1)}}function h(){t(2,r=!0),t(3,o=3),p=setInterval(()=>{t(3,o--,o),o<=0&&(clearInterval(p),p=null,q())},1e3)}function g(){t(2,r=!1),p&&(clearInterval(p),p=null),t(3,o=0)}async function q(){t(2,r=!1),t(4,a=!0);try{await kr()}catch{}setTimeout(()=>{t(5,u=!0),T()},5e3)}function T(){m=setInterval(async()=>{try{(await fetch("/status",{method:"GET",cache:"no-cache"})).ok&&(clearInterval(m),m=null,t(5,u=!1),t(4,a=!1),t(6,f=!0),await _(),setTimeout(()=>{t(6,f=!1)},5e3))}catch{}},2e3)}return[n,s,r,o,a,u,f,h,g]}class bs extends tt{constructor(e){super(),et(this,e,eo,$i,Xe,{})}}function gs(l){let e,t;return{c(){e=d("div"),t=C(l[2]),c(e,"class","message svelte-1gg1mca"),j(e,"success",l[3]==="success"),j(e,"error",l[3]==="error")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s&4&&O(t,n[2]),s&8&&j(e,"success",n[3]==="success"),s&8&&j(e,"error",n[3]==="error")},d(n){n&&k(e)}}}function to(l){let e,t,n,s,r,o=l[0]?"â³":l[4]?"ðŸ”„":"ðŸ””",a,u,f=l[4]?"Reset Alert":"Test Alert",p,m,v,_=l[1]?"â³":"âš™ï¸",h,g,q,T,S,y=l[2]&&gs(l);return{c(){e=d("div"),t=d("p"),t.textContent="Press a button to simulate an event or just fire the servo.",n=b(),s=d("div"),r=d("button"),a=C(o),u=b(),p=C(f),m=b(),v=d("button"),h=C(_),g=C(" Test Servo"),q=b(),y&&y.c(),c(t,"class","description svelte-1gg1mca"),c(r,"class","btn test-alert-btn svelte-1gg1mca"),r.disabled=l[0],j(r,"alert-active",l[4]),c(v,"class","btn test-servo-btn svelte-1gg1mca"),v.disabled=l[1],c(s,"class","button-group svelte-1gg1mca"),c(e,"class","content svelte-1gg1mca")},m(F,N){w(F,e,N),i(e,t),i(e,n),i(e,s),i(s,r),i(r,a),i(r,u),i(r,p),i(s,m),i(s,v),i(v,h),i(v,g),i(e,q),y&&y.m(e,null),T||(S=[A(r,"click",l[5]),A(v,"click",l[6])],T=!0)},p(F,N){N&17&&o!==(o=F[0]?"â³":F[4]?"ðŸ”„":"ðŸ””")&&O(a,o),N&16&&f!==(f=F[4]?"Reset Alert":"Test Alert")&&O(p,f),N&1&&(r.disabled=F[0]),N&16&&j(r,"alert-active",F[4]),N&2&&_!==(_=F[1]?"â³":"âš™ï¸")&&O(h,_),N&2&&(v.disabled=F[1]),F[2]?y?y.p(F,N):(y=gs(F),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},d(F){F&&k(e),y&&y.d(),T=!1,Ae(S)}}}function lo(l){let e,t,n,s,r;return s=new Ze({props:{title:"",$$slots:{default:[to]},$$scope:{ctx:l}}}),{c(){e=d("div"),t=d("h1"),t.textContent="Test Alert",n=b(),_e(s.$$.fragment),c(t,"class","svelte-1gg1mca"),c(e,"class","page svelte-1gg1mca")},m(o,a){w(o,e,a),i(e,t),i(e,n),pe(s,e,null),r=!0},p(o,[a]){const u={};a&543&&(u.$$scope={dirty:a,ctx:o}),s.$set(u)},i(o){r||(z(s.$$.fragment,o),r=!0)},o(o){J(s.$$.fragment,o),r=!1},d(o){o&&k(e),me(s)}}}function so(l,e,t){let n=!1,s=!1,r="",o="",a=!1,u=null;async function f(){try{const v=await al();t(4,a=v.detectionState||!1)}catch(v){console.error("Failed to check alert status:",v)}}async function p(){t(0,n=!0),t(2,r=""),t(3,o="");try{if(a)await Ln(),t(2,r="âœ… Alert reset successfully"),t(3,o="success"),t(4,a=!1);else{const v=await Tn();t(2,r=v||"âœ… Test alert started â€“ check /gallery or /captures"),t(3,o="success"),t(4,a=!0)}}catch(v){t(2,r=`Error: ${v.message||(a?"Failed to reset alert":"Failed to trigger test alert")}`),t(3,o="error")}finally{t(0,n=!1),f()}}async function m(){t(1,s=!0),t(2,r=""),t(3,o="");try{await Sn(),t(2,r="Servo triggered"),t(3,o="success")}catch(v){t(2,r=`Error: ${v.message||"Failed to trigger servo"}`),t(3,o="error")}finally{t(1,s=!1)}}return ht(()=>{f(),u=setInterval(f,2e3)}),It(()=>{u&&clearInterval(u)}),[n,s,r,o,a,p,m]}class no extends tt{constructor(e){super(),et(this,e,so,lo,Xe,{})}}function hs(l,e,t){const n=l.slice();return n[72]=e[t],n}function ks(l,e,t){const n=l.slice();return n[75]=e[t],n}function ws(l){let e,t;return{c(){e=d("div"),t=d("div"),c(t,"class","progress-fill svelte-1p3uq1f"),ut(t,"width",l[7]/(Us-1)*100+"%"),c(e,"class","progress-bar svelte-1p3uq1f")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s[0]&128&&ut(t,"width",n[7]/(Us-1)*100+"%")},d(n){n&&k(e)}}}function qs(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S;function y(P,K){return P[20]?io:ro}let F=y(l),N=F(l);const M=[uo,co],L=[];function E(P,K){return P[8]?0:1}return u=E(l),f=L[u]=M[u](l),{c(){e=d("div"),N.c(),t=b(),n=d("h1"),n.textContent="MouseTrap Setup",s=b(),r=d("p"),r.textContent="Let's get your device connected and ready to protect your home.",o=b(),a=d("button"),f.c(),p=b(),m=d("div"),v=d("button"),_=C("Standalone Mode (Local Only)"),h=b(),g=d("p"),g.textContent="Connect to WiFi without cloud registration",c(n,"class","svelte-1p3uq1f"),c(r,"class","welcome-text svelte-1p3uq1f"),c(a,"class","btn-primary btn-large svelte-1p3uq1f"),a.disabled=l[8],c(v,"class","btn-link svelte-1p3uq1f"),v.disabled=l[8],c(g,"class","standalone-hint svelte-1p3uq1f"),c(m,"class","standalone-option svelte-1p3uq1f"),c(e,"class","step welcome-step svelte-1p3uq1f")},m(P,K){w(P,e,K),N.m(e,null),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(e,a),L[u].m(a,null),i(e,p),i(e,m),i(m,v),i(v,_),i(m,h),i(m,g),q=!0,T||(S=[A(a,"click",l[43]),A(v,"click",l[41])],T=!0)},p(P,K){F===(F=y(P))&&N?N.p(P,K):(N.d(1),N=F(P),N&&(N.c(),N.m(e,t)));let I=u;u=E(P),u===I?L[u].p(P,K):(Le(),J(L[I],1,1,()=>{L[I]=null}),Ee(),f=L[u],f?f.p(P,K):(f=L[u]=M[u](P),f.c()),z(f,1),f.m(a,null)),(!q||K[0]&256)&&(a.disabled=P[8]),(!q||K[0]&256)&&(v.disabled=P[8])},i(P){q||(z(f),q=!0)},o(P){J(f),q=!1},d(P){P&&k(e),N.d(),L[u].d(),T=!1,Ae(S)}}}function ro(l){let e;return{c(){e=d("div"),e.innerHTML='<span class="mouse-emoji svelte-1p3uq1f" role="img" aria-label="mouse">ðŸ</span>',c(e,"class","welcome-icon svelte-1p3uq1f")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function io(l){let e,t,n,s,r,o,a,u,f,p;function m(h,g){if(h[21]==="invalid_credentials")return ao;if(h[21]==="wifi_failed")return oo}let v=m(l),_=v&&v(l);return{c(){e=d("div"),t=d("div"),t.innerHTML='<span class="error-icon svelte-1p3uq1f">âš </span> <strong>Previous Setup Failed</strong>',n=b(),s=d("p"),r=C(l[20]),o=b(),_&&_.c(),a=b(),u=d("button"),u.textContent="Dismiss",c(t,"class","error-header svelte-1p3uq1f"),c(s,"class","error-text svelte-1p3uq1f"),c(u,"class","btn-dismiss svelte-1p3uq1f"),c(e,"class","previous-error-box svelte-1p3uq1f")},m(h,g){w(h,e,g),i(e,t),i(e,n),i(e,s),i(s,r),i(e,o),_&&_.m(e,null),i(e,a),i(e,u),f||(p=A(u,"click",l[32]),f=!0)},p(h,g){g[0]&1048576&&O(r,h[20]),v!==(v=m(h))&&(_&&_.d(1),_=v&&v(h),_&&(_.c(),_.m(e,a)))},d(h){h&&k(e),_&&_.d(),f=!1,p()}}}function oo(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1p3uq1f">Check your WiFi password and make sure the network is in range.</p>',c(e,"class","error-help svelte-1p3uq1f")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function ao(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1p3uq1f">Double-check your email and password, or create a new account.</p> <a href="https://dashboard.mousetrap.com/forgot-password" target="_blank" rel="noopener noreferrer" class="forgot-link svelte-1p3uq1f">Forgot your password?</a>',c(e,"class","error-help svelte-1p3uq1f")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function co(l){let e=l[20]?"Try Again":"Get Started",t,n,s;return{c(){t=C(e),n=b(),s=d("span"),s.textContent="â†’",c(s,"class","arrow svelte-1p3uq1f")},m(r,o){w(r,t,o),w(r,n,o),w(r,s,o)},p(r,o){o[0]&1048576&&e!==(e=r[20]?"Try Again":"Get Started")&&O(t,e)},i:V,o:V,d(r){r&&(k(t),k(n),k(s))}}}function uo(l){let e,t,n;return e=new ot({props:{size:"small"}}),{c(){_e(e.$$.fragment),t=C(" Loading...")},m(s,r){pe(e,s,r),w(s,t,r),n=!0},p:V,i(s){n||(z(e.$$.fragment,s),n=!0)},o(s){J(e.$$.fragment,s),n=!1},d(s){s&&k(t),me(e,s)}}}function Cs(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g,q;const T=[mo,po,fo],S=[];function y(L,E){return L[11]?0:L[10]||L[9].length===0?1:2}s=y(l),r=S[s]=T[s](l);const F=[go,bo],N=[];function M(L,E){return L[25]?0:1}return v=M(l),_=N[v]=F[v](l),{c(){e=d("div"),t=d("h2"),t.textContent="Select your WiFi network",n=b(),r.c(),o=b(),a=d("div"),u=d("button"),f=d("span"),f.textContent="â†",p=C(" Back"),m=b(),_.c(),c(t,"class","svelte-1p3uq1f"),c(f,"class","arrow svelte-1p3uq1f"),c(u,"class","btn-secondary svelte-1p3uq1f"),u.disabled=l[13],c(a,"class","button-row svelte-1p3uq1f"),c(e,"class","step wifi-step svelte-1p3uq1f")},m(L,E){w(L,e,E),i(e,t),i(e,n),S[s].m(e,null),i(e,o),i(e,a),i(a,u),i(u,f),i(u,p),i(a,m),N[v].m(a,null),h=!0,g||(q=A(u,"click",l[51]),g=!0)},p(L,E){let P=s;s=y(L),s===P?S[s].p(L,E):(Le(),J(S[P],1,1,()=>{S[P]=null}),Ee(),r=S[s],r?r.p(L,E):(r=S[s]=T[s](L),r.c()),z(r,1),r.m(e,o)),(!h||E[0]&8192)&&(u.disabled=L[13]);let K=v;v=M(L),v===K?N[v].p(L,E):(Le(),J(N[K],1,1,()=>{N[K]=null}),Ee(),_=N[v],_?_.p(L,E):(_=N[v]=F[v](L),_.c()),z(_,1),_.m(a,null))},i(L){h||(z(r),z(_),h=!0)},o(L){J(r),J(_),h=!1},d(L){L&&k(e),S[s].d(),N[v].d(),g=!1,q()}}}function fo(l){let e,t,n,s,r=l[0]==="manual"?"â—‰":"â—‹",o,a,u,f,p,m,v,_,h,g,q,T=l[12]?"Hide":"Show",S,y,F,N=l[2].length+"",M,L,E,P,K,I,U,H,R,Y,W=Ue(l[9]),B=[];for(let D=0;D<W.length;D+=1)B[D]=ys(ks(l,W,D));let X=l[0]==="manual"&&Ss(l);function Z(D,$){return D[12]?_o:vo}let ne=Z(l),ae=ne(l),se=l[14]&&Ts(l),G=l[13]&&Fs(),le=l[24]&&Ls(l),Q=l[23]&&l[22]&&As(l);return{c(){e=d("div");for(let D=0;D<B.length;D+=1)B[D].c();t=b(),n=d("button"),s=d("span"),o=C(r),a=b(),u=d("span"),u.textContent="Enter manually...",f=b(),X&&X.c(),p=b(),m=d("div"),v=d("label"),v.textContent="Password",_=b(),h=d("div"),ae.c(),g=b(),q=d("button"),S=C(T),y=b(),F=d("p"),M=C(N),L=C("/8 characters minimum"),E=b(),se&&se.c(),P=b(),G&&G.c(),K=b(),le&&le.c(),I=b(),Q&&Q.c(),U=$e(),c(s,"class","network-radio svelte-1p3uq1f"),c(u,"class","network-name svelte-1p3uq1f"),c(n,"class","network-item manual-entry svelte-1p3uq1f"),j(n,"selected",l[0]==="manual"),c(e,"class","network-list svelte-1p3uq1f"),c(v,"for","wifi-password"),c(v,"class","svelte-1p3uq1f"),c(q,"type","button"),c(q,"class","toggle-password svelte-1p3uq1f"),c(h,"class","password-input-group svelte-1p3uq1f"),c(F,"class","field-hint svelte-1p3uq1f"),j(F,"valid",l[2].length>=8),c(m,"class","form-group svelte-1p3uq1f")},m(D,$){w(D,e,$);for(let te=0;te<B.length;te+=1)B[te]&&B[te].m(e,null);i(e,t),i(e,n),i(n,s),i(s,o),i(n,a),i(n,u),w(D,f,$),X&&X.m(D,$),w(D,p,$),w(D,m,$),i(m,v),i(m,_),i(m,h),ae.m(h,null),i(h,g),i(h,q),i(q,S),i(m,y),i(m,F),i(F,M),i(F,L),w(D,E,$),se&&se.m(D,$),w(D,P,$),G&&G.m(D,$),w(D,K,$),le&&le.m(D,$),w(D,I,$),Q&&Q.m(D,$),w(D,U,$),H=!0,R||(Y=[A(n,"click",l[46]),A(q,"click",l[50])],R=!0)},p(D,$){if($[0]&513|$[1]&8){W=Ue(D[9]);let te;for(te=0;te<W.length;te+=1){const re=ks(D,W,te);B[te]?B[te].p(re,$):(B[te]=ys(re),B[te].c(),B[te].m(e,t))}for(;te<B.length;te+=1)B[te].d(1);B.length=W.length}(!H||$[0]&1)&&r!==(r=D[0]==="manual"?"â—‰":"â—‹")&&O(o,r),(!H||$[0]&1)&&j(n,"selected",D[0]==="manual"),D[0]==="manual"?X?X.p(D,$):(X=Ss(D),X.c(),X.m(p.parentNode,p)):X&&(X.d(1),X=null),ne===(ne=Z(D))&&ae?ae.p(D,$):(ae.d(1),ae=ne(D),ae&&(ae.c(),ae.m(h,g))),(!H||$[0]&4096)&&T!==(T=D[12]?"Hide":"Show")&&O(S,T),(!H||$[0]&4)&&N!==(N=D[2].length+"")&&O(M,N),(!H||$[0]&4)&&j(F,"valid",D[2].length>=8),D[14]?se?se.p(D,$):(se=Ts(D),se.c(),se.m(P.parentNode,P)):se&&(se.d(1),se=null),D[13]?G?$[0]&8192&&z(G,1):(G=Fs(),G.c(),z(G,1),G.m(K.parentNode,K)):G&&(Le(),J(G,1,1,()=>{G=null}),Ee()),D[24]?le?le.p(D,$):(le=Ls(D),le.c(),le.m(I.parentNode,I)):le&&(le.d(1),le=null),D[23]&&D[22]?Q?Q.p(D,$):(Q=As(D),Q.c(),Q.m(U.parentNode,U)):Q&&(Q.d(1),Q=null)},i(D){H||(z(G),H=!0)},o(D){J(G),H=!1},d(D){D&&(k(e),k(f),k(p),k(m),k(E),k(P),k(K),k(I),k(U)),qt(B,D),X&&X.d(D),ae.d(),se&&se.d(D),G&&G.d(D),le&&le.d(D),Q&&Q.d(D),R=!1,Ae(Y)}}}function po(l){let e,t,n=(l[10]||"No networks found")+"",s,r,o,a,u,f,p;return{c(){e=d("div"),t=d("p"),s=C(n),r=b(),o=d("button"),o.textContent="Retry Scan",a=b(),u=d("p"),u.textContent="Tap Retry to scan again. This may take 10-15 seconds.",c(t,"class","svelte-1p3uq1f"),c(o,"class","btn-primary svelte-1p3uq1f"),c(u,"class","hint svelte-1p3uq1f"),c(e,"class","error-box svelte-1p3uq1f")},m(m,v){w(m,e,v),i(e,t),i(t,s),i(e,r),i(e,o),i(e,a),i(e,u),f||(p=A(o,"click",l[44]),f=!0)},p(m,v){v[0]&1024&&n!==(n=(m[10]||"No networks found")+"")&&O(s,n)},i:V,o:V,d(m){m&&k(e),f=!1,p()}}}function mo(l){let e,t,n,s,r;return t=new ot({}),{c(){e=d("div"),_e(t.$$.fragment),n=b(),s=d("p"),s.textContent="Scanning for networks...",c(e,"class","loading-container svelte-1p3uq1f")},m(o,a){w(o,e,a),pe(t,e,null),i(e,n),i(e,s),r=!0},p:V,i(o){r||(z(t.$$.fragment,o),r=!0)},o(o){J(t.$$.fragment,o),r=!1},d(o){o&&k(e),me(t)}}}function ys(l){let e,t,n=l[0]===l[75].ssid?"â—‰":"â—‹",s,r,o,a=l[75].ssid+"",u,f,p,m,v,_,h=js(Ws(l[75].rssi))+"",g,q,T;function S(){return l[45](l[75])}return{c(){e=d("button"),t=d("span"),s=C(n),r=b(),o=d("span"),u=C(a),f=b(),p=d("span"),m=d("span"),m.textContent="ðŸ“¶",v=b(),_=d("span"),g=C(h),c(t,"class","network-radio svelte-1p3uq1f"),c(o,"class","network-name svelte-1p3uq1f"),c(m,"class","signal-label svelte-1p3uq1f"),c(_,"class","signal-bars svelte-1p3uq1f"),c(p,"class","signal-icon svelte-1p3uq1f"),c(p,"title","Signal strength"),c(e,"class","network-item svelte-1p3uq1f"),j(e,"selected",l[0]===l[75].ssid)},m(y,F){w(y,e,F),i(e,t),i(t,s),i(e,r),i(e,o),i(o,u),i(e,f),i(e,p),i(p,m),i(p,v),i(p,_),i(_,g),q||(T=A(e,"click",S),q=!0)},p(y,F){l=y,F[0]&513&&n!==(n=l[0]===l[75].ssid?"â—‰":"â—‹")&&O(s,n),F[0]&512&&a!==(a=l[75].ssid+"")&&O(u,a),F[0]&512&&h!==(h=js(Ws(l[75].rssi))+"")&&O(g,h),F[0]&513&&j(e,"selected",l[0]===l[75].ssid)},d(y){y&&k(e),q=!1,T()}}}function Ss(l){let e,t,n,s,r,o;return{c(){e=d("div"),t=d("label"),t.textContent="Network Name (SSID)",n=b(),s=d("input"),c(t,"for","manual-ssid"),c(t,"class","svelte-1p3uq1f"),c(s,"id","manual-ssid"),c(s,"type","text"),c(s,"placeholder","Enter network name"),c(s,"autocomplete","off"),c(s,"class","svelte-1p3uq1f"),c(e,"class","form-group svelte-1p3uq1f")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),ce(s,l[1]),r||(o=A(s,"input",l[47]),r=!0)},p(a,u){u[0]&2&&s.value!==a[1]&&ce(s,a[1])},d(a){a&&k(e),r=!1,o()}}}function vo(l){let e,t,n;return{c(){e=d("input"),c(e,"id","wifi-password"),c(e,"type","password"),c(e,"placeholder","Enter WiFi password"),c(e,"autocomplete","off"),c(e,"class","svelte-1p3uq1f")},m(s,r){w(s,e,r),ce(e,l[2]),t||(n=A(e,"input",l[49]),t=!0)},p(s,r){r[0]&4&&e.value!==s[2]&&ce(e,s[2])},d(s){s&&k(e),t=!1,n()}}}function _o(l){let e,t,n;return{c(){e=d("input"),c(e,"id","wifi-password"),c(e,"type","text"),c(e,"placeholder","Enter WiFi password"),c(e,"autocomplete","off"),c(e,"class","svelte-1p3uq1f")},m(s,r){w(s,e,r),ce(e,l[2]),t||(n=A(e,"input",l[48]),t=!0)},p(s,r){r[0]&4&&e.value!==s[2]&&ce(e,s[2])},d(s){s&&k(e),t=!1,n()}}}function Ts(l){let e,t,n,s,r,o,a;return{c(){e=d("div"),t=d("p"),t.textContent="âš ",n=b(),s=d("p"),r=C(l[14]),o=b(),a=d("p"),a.textContent="Check your WiFi password and try again.",c(t,"class","error-icon svelte-1p3uq1f"),c(s,"class","error-text svelte-1p3uq1f"),c(a,"class","error-hint svelte-1p3uq1f"),c(e,"class","wifi-error-box svelte-1p3uq1f")},m(u,f){w(u,e,f),i(e,t),i(e,n),i(e,s),i(s,r),i(e,o),i(e,a)},p(u,f){f[0]&16384&&O(r,u[14])},d(u){u&&k(e)}}}function Fs(l){let e,t,n,s,r;return t=new ot({props:{size:"small"}}),{c(){e=d("div"),_e(t.$$.fragment),n=b(),s=d("p"),s.textContent="Connecting to WiFi...",c(s,"class","svelte-1p3uq1f"),c(e,"class","wifi-connecting-box svelte-1p3uq1f")},m(o,a){w(o,e,a),pe(t,e,null),i(e,n),i(e,s),r=!0},i(o){r||(z(t.$$.fragment,o),r=!0)},o(o){J(t.$$.fragment,o),r=!1},d(o){o&&k(e),me(t)}}}function Ls(l){let e,t,n,s,r,o,a,u=l[22]&&Es(l);return{c(){e=d("div"),t=d("div"),t.innerHTML='<span class="success-icon svelte-1p3uq1f">âœ…</span> <strong>WiFi Connected!</strong>',n=b(),u&&u.c(),s=b(),r=d("button"),r.innerHTML='Continue to Account Setup <span class="arrow svelte-1p3uq1f">â†’</span>',c(t,"class","wifi-success-header svelte-1p3uq1f"),c(r,"class","btn-primary btn-continue svelte-1p3uq1f"),c(e,"class","wifi-success-box svelte-1p3uq1f")},m(f,p){w(f,e,p),i(e,t),i(e,n),u&&u.m(e,null),i(e,s),i(e,r),o||(a=A(r,"click",l[36]),o=!0)},p(f,p){f[22]?u?u.p(f,p):(u=Es(f),u.c(),u.m(e,s)):u&&(u.d(1),u=null)},d(f){f&&k(e),u&&u.d(),o=!1,a()}}}function Es(l){let e,t,n,s,r,o,a,u,f,p;return{c(){e=d("div"),t=d("p"),t.textContent="Your phone may disconnect from this setup network.",n=b(),s=d("p"),s.innerHTML="<strong>If that happens</strong>, connect to your home WiFi and visit:",r=b(),o=d("div"),a=d("span"),u=C(l[22]),f=b(),p=d("p"),p.textContent="Save this address before continuing!",c(t,"class","notice-text svelte-1p3uq1f"),c(s,"class","notice-text svelte-1p3uq1f"),c(a,"class","lan-ip svelte-1p3uq1f"),c(o,"class","lan-ip-display svelte-1p3uq1f"),c(p,"class","notice-hint svelte-1p3uq1f"),c(e,"class","lan-ip-notice svelte-1p3uq1f")},m(m,v){w(m,e,v),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(o,a),i(a,u),i(e,f),i(e,p)},p(m,v){v[0]&4194304&&O(u,m[22])},d(m){m&&k(e)}}}function As(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h;return{c(){e=d("div"),t=d("div"),t.innerHTML='<span class="wifi-success-icon svelte-1p3uq1f">âœ…</span> <strong>WiFi Connected!</strong>',n=b(),s=d("p"),s.textContent="Your phone disconnected from the setup network. This is normal - the device is now on your home WiFi.",r=b(),o=d("div"),a=d("p"),a.textContent="To complete setup, connect to your home WiFi and visit:",u=b(),f=d("a"),p=C("http://"),m=C(l[22]),_=b(),h=d("p"),h.textContent="Or scan this address on your phone's browser",c(t,"class","connection-lost-header svelte-1p3uq1f"),c(s,"class","connection-lost-text svelte-1p3uq1f"),c(a,"class","svelte-1p3uq1f"),c(f,"href",v="http://"+l[22]),c(f,"class","lan-link svelte-1p3uq1f"),c(f,"target","_blank"),c(f,"rel","noopener noreferrer"),c(h,"class","lan-hint svelte-1p3uq1f"),c(o,"class","continue-lan-box svelte-1p3uq1f"),c(e,"class","connection-lost-box svelte-1p3uq1f")},m(g,q){w(g,e,q),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(o,a),i(o,u),i(o,f),i(f,p),i(f,m),i(o,_),i(o,h)},p(g,q){q[0]&4194304&&O(m,g[22]),q[0]&4194304&&v!==(v="http://"+g[22])&&c(f,"href",v)},d(g){g&&k(e)}}}function bo(l){let e,t,n,s,r,o,a;const u=[ko,ho],f=[];function p(m,v){return m[13]?0:1}return t=p(l),n=f[t]=u[t](l),{c(){e=d("button"),n.c(),c(e,"class","btn-primary svelte-1p3uq1f"),e.disabled=s=!l[31]||l[13]},m(m,v){w(m,e,v),f[t].m(e,null),r=!0,o||(a=A(e,"click",l[37]),o=!0)},p(m,v){let _=t;t=p(m),t!==_&&(Le(),J(f[_],1,1,()=>{f[_]=null}),Ee(),n=f[t],n||(n=f[t]=u[t](m),n.c()),z(n,1),n.m(e,null)),(!r||v[0]&8192|v[1]&1&&s!==(s=!m[31]||m[13]))&&(e.disabled=s)},i(m){r||(z(n),r=!0)},o(m){J(n),r=!1},d(m){m&&k(e),f[t].d(),o=!1,a()}}}function go(l){let e,t,n,s,r,o,a;const u=[qo,wo],f=[];function p(m,v){return m[26]?0:1}return t=p(l),n=f[t]=u[t](l),{c(){e=d("button"),n.c(),c(e,"class","btn-primary svelte-1p3uq1f"),e.disabled=s=!l[31]||l[26]},m(m,v){w(m,e,v),f[t].m(e,null),r=!0,o||(a=A(e,"click",l[42]),o=!0)},p(m,v){let _=t;t=p(m),t!==_&&(Le(),J(f[_],1,1,()=>{f[_]=null}),Ee(),n=f[t],n||(n=f[t]=u[t](m),n.c()),z(n,1),n.m(e,null)),(!r||v[0]&67108864|v[1]&1&&s!==(s=!m[31]||m[26]))&&(e.disabled=s)},i(m){r||(z(n),r=!0)},o(m){J(n),r=!1},d(m){m&&k(e),f[t].d(),o=!1,a()}}}function ho(l){let e,t;return{c(){e=C("Connect "),t=d("span"),t.textContent="â†’",c(t,"class","arrow svelte-1p3uq1f")},m(n,s){w(n,e,s),w(n,t,s)},i:V,o:V,d(n){n&&(k(e),k(t))}}}function ko(l){let e,t,n;return e=new ot({props:{size:"small"}}),{c(){_e(e.$$.fragment),t=C(" Connecting...")},m(s,r){pe(e,s,r),w(s,t,r),n=!0},i(s){n||(z(e.$$.fragment,s),n=!0)},o(s){J(e.$$.fragment,s),n=!1},d(s){s&&k(t),me(e,s)}}}function wo(l){let e;return{c(){e=C("Enable Standalone Mode")},m(t,n){w(t,e,n)},i:V,o:V,d(t){t&&k(e)}}}function qo(l){let e,t,n;return e=new ot({props:{size:"small"}}),{c(){_e(e.$$.fragment),t=C(" Enabling...")},m(s,r){pe(e,s,r),w(s,t,r),n=!0},i(s){n||(z(e.$$.fragment,s),n=!0)},o(s){J(e.$$.fragment,s),n=!1},d(s){s&&k(t),me(e,s)}}}function Is(l){let e,t,n,s,r,o,a,u=l[3]?"Create your account":"Sign in",f,p,m,v,_,h,g,q,T,S,y,F,N,M=l[15]?"Hide":"Show",L,E,P,K=l[5].length+"",I,U,H,R,Y,W,B,X,Z,ne,ae,se,G,le,Q,D,$=l[3]?"Create & Activate":"Sign In & Activate",te,re,Je,Me,lt,He;function Ie(fe,we){return fe[15]?yo:Co}let De=Ie(l),Se=De(l),Ce=!l[3]&&Ns(l),he=l[16]&&Ps(l);return{c(){e=d("div"),t=d("div"),n=d("button"),n.textContent="Sign In",s=b(),r=d("button"),r.textContent="Create Account",o=b(),a=d("h2"),f=C(u),p=b(),m=d("div"),v=d("label"),v.textContent="Email",_=b(),h=d("input"),g=b(),q=d("div"),T=d("label"),T.textContent="Password",S=b(),y=d("div"),Se.c(),F=b(),N=d("button"),L=C(M),E=b(),P=d("p"),I=C(K),U=C("/8 characters minimum"),H=b(),Ce&&Ce.c(),R=b(),he&&he.c(),Y=b(),W=d("div"),B=d("label"),B.textContent="Name this device",X=b(),Z=d("input"),ne=b(),ae=d("div"),ae.innerHTML='<span class="wifi-icon svelte-1p3uq1f">âœ…</span> <span>WiFi Connected</span>',se=b(),G=d("div"),le=d("button"),le.innerHTML='<span class="arrow svelte-1p3uq1f">â†</span> Back',Q=b(),D=d("button"),te=C($),re=b(),Je=d("span"),Je.textContent="â†’",c(n,"class","tab-btn svelte-1p3uq1f"),j(n,"active",!l[3]),c(r,"class","tab-btn svelte-1p3uq1f"),j(r,"active",l[3]),c(t,"class","account-tabs svelte-1p3uq1f"),c(a,"class","svelte-1p3uq1f"),c(v,"for","email"),c(v,"class","svelte-1p3uq1f"),c(h,"id","email"),c(h,"type","email"),c(h,"placeholder","you@example.com"),c(h,"autocomplete","email"),c(h,"class","svelte-1p3uq1f"),c(m,"class","form-group svelte-1p3uq1f"),c(T,"for","account-password"),c(T,"class","svelte-1p3uq1f"),c(N,"type","button"),c(N,"class","toggle-password svelte-1p3uq1f"),c(y,"class","password-input-group svelte-1p3uq1f"),c(P,"class","field-hint svelte-1p3uq1f"),j(P,"valid",l[5].length>=8),c(q,"class","form-group svelte-1p3uq1f"),c(B,"for","device-name"),c(B,"class","svelte-1p3uq1f"),c(Z,"id","device-name"),c(Z,"type","text"),c(Z,"placeholder","Kitchen"),c(Z,"autocomplete","off"),c(Z,"class","svelte-1p3uq1f"),c(W,"class","form-group svelte-1p3uq1f"),c(ae,"class","wifi-connected-box svelte-1p3uq1f"),c(le,"class","btn-secondary svelte-1p3uq1f"),c(Je,"class","arrow svelte-1p3uq1f"),c(D,"class","btn-primary svelte-1p3uq1f"),D.disabled=Me=!l[30],c(G,"class","button-row svelte-1p3uq1f"),c(e,"class","step account-step svelte-1p3uq1f")},m(fe,we){w(fe,e,we),i(e,t),i(t,n),i(t,s),i(t,r),i(e,o),i(e,a),i(a,f),i(e,p),i(e,m),i(m,v),i(m,_),i(m,h),ce(h,l[4]),i(e,g),i(e,q),i(q,T),i(q,S),i(q,y),Se.m(y,null),i(y,F),i(y,N),i(N,L),i(q,E),i(q,P),i(P,I),i(P,U),i(q,H),Ce&&Ce.m(q,null),i(e,R),he&&he.m(e,null),i(e,Y),i(e,W),i(W,B),i(W,X),i(W,Z),ce(Z,l[6]),i(e,ne),i(e,ae),i(e,se),i(e,G),i(G,le),i(G,Q),i(G,D),i(D,te),i(D,re),i(D,Je),lt||(He=[A(n,"click",l[52]),A(r,"click",l[53]),A(h,"input",l[54]),A(N,"click",l[57]),A(Z,"input",l[60]),A(le,"click",l[61]),A(D,"click",l[38])],lt=!0)},p(fe,we){we[0]&8&&j(n,"active",!fe[3]),we[0]&8&&j(r,"active",fe[3]),we[0]&8&&u!==(u=fe[3]?"Create your account":"Sign in")&&O(f,u),we[0]&16&&h.value!==fe[4]&&ce(h,fe[4]),De===(De=Ie(fe))&&Se?Se.p(fe,we):(Se.d(1),Se=De(fe),Se&&(Se.c(),Se.m(y,F))),we[0]&32768&&M!==(M=fe[15]?"Hide":"Show")&&O(L,M),we[0]&32&&K!==(K=fe[5].length+"")&&O(I,K),we[0]&32&&j(P,"valid",fe[5].length>=8),fe[3]?Ce&&(Ce.d(1),Ce=null):Ce?Ce.p(fe,we):(Ce=Ns(fe),Ce.c(),Ce.m(q,null)),fe[16]?he?he.p(fe,we):(he=Ps(fe),he.c(),he.m(e,Y)):he&&(he.d(1),he=null),we[0]&64&&Z.value!==fe[6]&&ce(Z,fe[6]),we[0]&8&&$!==($=fe[3]?"Create & Activate":"Sign In & Activate")&&O(te,$),we[0]&1073741824&&Me!==(Me=!fe[30])&&(D.disabled=Me)},d(fe){fe&&k(e),Se.d(),Ce&&Ce.d(),he&&he.d(),lt=!1,Ae(He)}}}function Co(l){let e,t,n,s,r;return{c(){e=d("input"),c(e,"id","account-password"),c(e,"type","password"),c(e,"placeholder",t=l[3]?"Create a password":"Enter your password"),c(e,"autocomplete",n=l[3]?"new-password":"current-password"),c(e,"class","svelte-1p3uq1f")},m(o,a){w(o,e,a),ce(e,l[5]),s||(r=A(e,"input",l[56]),s=!0)},p(o,a){a[0]&8&&t!==(t=o[3]?"Create a password":"Enter your password")&&c(e,"placeholder",t),a[0]&8&&n!==(n=o[3]?"new-password":"current-password")&&c(e,"autocomplete",n),a[0]&32&&e.value!==o[5]&&ce(e,o[5])},d(o){o&&k(e),s=!1,r()}}}function yo(l){let e,t,n,s,r;return{c(){e=d("input"),c(e,"id","account-password"),c(e,"type","text"),c(e,"placeholder",t=l[3]?"Create a password":"Enter your password"),c(e,"autocomplete",n=l[3]?"new-password":"current-password"),c(e,"class","svelte-1p3uq1f")},m(o,a){w(o,e,a),ce(e,l[5]),s||(r=A(e,"input",l[55]),s=!0)},p(o,a){a[0]&8&&t!==(t=o[3]?"Create a password":"Enter your password")&&c(e,"placeholder",t),a[0]&8&&n!==(n=o[3]?"new-password":"current-password")&&c(e,"autocomplete",n),a[0]&32&&e.value!==o[5]&&ce(e,o[5])},d(o){o&&k(e),s=!1,r()}}}function Ns(l){let e,t,n;return{c(){e=d("button"),e.textContent="Forgot password?",c(e,"type","button"),c(e,"class","forgot-password-link svelte-1p3uq1f")},m(s,r){w(s,e,r),t||(n=A(e,"click",l[58]),t=!0)},p:V,d(s){s&&k(e),t=!1,n()}}}function Ps(l){let e,t,n,s,r,o,a,u,f,p;return{c(){e=d("div"),t=d("button"),t.textContent="Ã—",n=b(),s=d("p"),s.textContent="To reset your password:",r=b(),o=d("ol"),o.innerHTML='<li class="svelte-1p3uq1f">Connect to your home WiFi network</li> <li class="svelte-1p3uq1f">Visit <strong class="svelte-1p3uq1f">dashboard.mousetrap.com/forgot-password</strong></li> <li class="svelte-1p3uq1f">Reset your password via email</li> <li class="svelte-1p3uq1f">Return here to complete setup</li>',a=b(),u=d("p"),u.textContent="The captive portal doesn't have internet access, so you'll need to use your home WiFi to reset your password.",c(t,"type","button"),c(t,"class","info-box-close svelte-1p3uq1f"),c(s,"class","info-title svelte-1p3uq1f"),c(o,"class","info-steps svelte-1p3uq1f"),c(u,"class","info-note svelte-1p3uq1f"),c(e,"class","forgot-password-info-box svelte-1p3uq1f")},m(m,v){w(m,e,v),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(e,a),i(e,u),f||(p=A(t,"click",l[59]),f=!0)},p:V,d(m){m&&k(e),f=!1,p()}}}function Os(l){let e,t,n,s,r=Ue(l[29]),o=[];for(let a=0;a<r.length;a+=1)o[a]=Rs(hs(l,r,a));return{c(){e=d("div"),t=d("h2"),t.textContent="Setting up your device...",n=b(),s=d("div");for(let a=0;a<o.length;a+=1)o[a].c();c(t,"class","svelte-1p3uq1f"),c(s,"class","progress-list svelte-1p3uq1f"),c(e,"class","step progress-step svelte-1p3uq1f")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(s,null)},p(a,u){if(u[0]&536870912){r=Ue(a[29]);let f;for(f=0;f<r.length;f+=1){const p=hs(a,r,f);o[f]?o[f].p(p,u):(o[f]=Rs(p),o[f].c(),o[f].m(s,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=r.length}},d(a){a&&k(e),qt(o,a)}}}function Ms(l){let e;return{c(){e=d("span"),c(e,"class","progress-spinner svelte-1p3uq1f")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Rs(l){let e,t,n=zs(l[72].status)+"",s,r,o,a=l[72].label+"",u,f,p,m=l[72].status==="in_progress"&&Ms();return{c(){e=d("div"),t=d("span"),s=C(n),r=b(),o=d("span"),u=C(a),f=b(),m&&m.c(),p=b(),c(t,"class","progress-icon svelte-1p3uq1f"),c(o,"class","progress-label svelte-1p3uq1f"),c(e,"class","progress-item svelte-1p3uq1f"),j(e,"completed",l[72].status==="completed"),j(e,"in-progress",l[72].status==="in_progress"),j(e,"failed",l[72].status==="failed")},m(v,_){w(v,e,_),i(e,t),i(t,s),i(e,r),i(e,o),i(o,u),i(e,f),m&&m.m(e,null),i(e,p)},p(v,_){_[0]&536870912&&n!==(n=zs(v[72].status)+"")&&O(s,n),_[0]&536870912&&a!==(a=v[72].label+"")&&O(u,a),v[72].status==="in_progress"?m||(m=Ms(),m.c(),m.m(e,p)):m&&(m.d(1),m=null),_[0]&536870912&&j(e,"completed",v[72].status==="completed"),_[0]&536870912&&j(e,"in-progress",v[72].status==="in_progress"),_[0]&536870912&&j(e,"failed",v[72].status==="failed")},d(v){v&&k(e),m&&m.d()}}}function Ds(l){let e,t,n,s;const r=[To,So],o=[];function a(u,f){return u[17]?0:1}return e=a(l),t=o[e]=r[e](l),{c(){t.c(),n=$e()},m(u,f){o[e].m(u,f),w(u,n,f),s=!0},p(u,f){let p=e;e=a(u),e===p?o[e].p(u,f):(Le(),J(o[p],1,1,()=>{o[p]=null}),Ee(),t=o[e],t?t.p(u,f):(t=o[e]=r[e](u),t.c()),z(t,1),t.m(n.parentNode,n))},i(u){s||(z(t),s=!0)},o(u){J(t),s=!1},d(u){u&&k(n),o[e].d(u)}}}function So(l){let e,t,n,s,r,o,a,u,f,p,m,v;function _(q,T){if(q[27]==="invalid_credentials")return Eo;if(q[27]==="wifi_failed")return Lo;if(q[27]==="connection_error")return Fo}let h=_(l),g=h&&h(l);return{c(){e=d("div"),t=d("div"),t.innerHTML='<span role="img" aria-label="error">âŒ</span>',n=b(),s=d("h2"),s.textContent="Setup Failed",r=b(),o=d("p"),a=C(l[18]),u=b(),g&&g.c(),f=b(),p=d("button"),p.textContent="Try Again",c(t,"class","result-icon error svelte-1p3uq1f"),c(s,"class","svelte-1p3uq1f"),c(o,"class","error-message svelte-1p3uq1f"),c(p,"class","btn-primary btn-large svelte-1p3uq1f"),c(e,"class","step error-step svelte-1p3uq1f")},m(q,T){w(q,e,T),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(o,a),i(e,u),g&&g.m(e,null),i(e,f),i(e,p),m||(v=A(p,"click",l[40]),m=!0)},p(q,T){T[0]&262144&&O(a,q[18]),h!==(h=_(q))&&(g&&g.d(1),g=h&&h(q),g&&(g.c(),g.m(e,f)))},i:V,o:V,d(q){q&&k(e),g&&g.d(),m=!1,v()}}}function To(l){let e,t,n,s;const r=[No,Io,Ao],o=[];function a(u,f){return u[25]?0:u[19]?1:2}return t=a(l),n=o[t]=r[t](l),{c(){e=d("div"),n.c(),c(e,"class","step success-step svelte-1p3uq1f")},m(u,f){w(u,e,f),o[t].m(e,null),s=!0},p(u,f){let p=t;t=a(u),t===p?o[t].p(u,f):(Le(),J(o[p],1,1,()=>{o[p]=null}),Ee(),n=o[t],n?n.p(u,f):(n=o[t]=r[t](u),n.c()),z(n,1),n.m(e,null))},i(u){s||(z(n),s=!0)},o(u){J(n),s=!1},d(u){u&&k(e),o[t].d()}}}function Fo(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1p3uq1f">Make sure your WiFi has internet access and the server is reachable.</p>',c(e,"class","error-help-box svelte-1p3uq1f")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Lo(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1p3uq1f">Check your WiFi password and make sure the network is in range.</p>',c(e,"class","error-help-box svelte-1p3uq1f")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Eo(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-1p3uq1f">Double-check your email and password, or create a new account.</p> <a href="https://dashboard.mousetrap.com/forgot-password" target="_blank" rel="noopener noreferrer" class="forgot-link svelte-1p3uq1f">Forgot your password?</a>',c(e,"class","error-help-box svelte-1p3uq1f")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Ao(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S,y;const F=[Oo,Po],N=[];function M(L,E){return L[28]?0:1}return _=M(l),h=N[_]=F[_](l),{c(){e=d("div"),e.innerHTML='<span role="img" aria-label="success">âœ…</span>',t=b(),n=d("h2"),n.textContent="Setup Complete!",s=b(),r=d("p"),o=C('Your device "'),a=C(l[6]),u=C('" has been registered successfully.'),f=b(),p=d("div"),p.innerHTML='<p class="svelte-1p3uq1f">Access your dashboard at:</p> <a href="https://dashboard.mousetrap.com" class="dashboard-link svelte-1p3uq1f" target="_blank" rel="noopener noreferrer">https://dashboard.mousetrap.com</a>',m=b(),v=d("button"),h.c(),g=b(),q=d("p"),q.textContent="The device will reboot and connect to your home WiFi.",c(e,"class","result-icon success svelte-1p3uq1f"),c(n,"class","svelte-1p3uq1f"),c(r,"class","result-text svelte-1p3uq1f"),c(p,"class","dashboard-link-box svelte-1p3uq1f"),c(v,"class","btn-primary btn-large svelte-1p3uq1f"),v.disabled=l[28],c(q,"class","auto-close-text svelte-1p3uq1f")},m(L,E){w(L,e,E),w(L,t,E),w(L,n,E),w(L,s,E),w(L,r,E),i(r,o),i(r,a),i(r,u),w(L,f,E),w(L,p,E),w(L,m,E),w(L,v,E),N[_].m(v,null),w(L,g,E),w(L,q,E),T=!0,S||(y=A(v,"click",l[39]),S=!0)},p(L,E){(!T||E[0]&64)&&O(a,L[6]);let P=_;_=M(L),_!==P&&(Le(),J(N[P],1,1,()=>{N[P]=null}),Ee(),h=N[_],h||(h=N[_]=F[_](L),h.c()),z(h,1),h.m(v,null)),(!T||E[0]&268435456)&&(v.disabled=L[28])},i(L){T||(z(h),T=!0)},o(L){J(h),T=!1},d(L){L&&(k(e),k(t),k(n),k(s),k(r),k(f),k(p),k(m),k(v),k(g),k(q)),N[_].d(),S=!1,y()}}}function Io(l){let e,t,n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S,y;const F=[Ro,Mo],N=[];function M(L,E){return L[28]?0:1}return _=M(l),h=N[_]=F[_](l),{c(){e=d("div"),e.innerHTML='<span role="img" aria-label="success">âœ…</span>',t=b(),n=d("h2"),n.textContent="Connection Restored!",s=b(),r=d("p"),o=C('Your device "'),a=C(l[6]),u=C('" has reconnected successfully.'),f=b(),p=d("div"),p.innerHTML='<p class="svelte-1p3uq1f">Access your dashboard at:</p> <a href="https://dashboard.mousetrap.com" class="dashboard-link svelte-1p3uq1f" target="_blank" rel="noopener noreferrer">https://dashboard.mousetrap.com</a>',m=b(),v=d("button"),h.c(),g=b(),q=d("p"),q.textContent="The device will reboot and connect to your home WiFi.",c(e,"class","result-icon success svelte-1p3uq1f"),c(n,"class","svelte-1p3uq1f"),c(r,"class","result-text svelte-1p3uq1f"),c(p,"class","dashboard-link-box svelte-1p3uq1f"),c(v,"class","btn-primary btn-large svelte-1p3uq1f"),v.disabled=l[28],c(q,"class","auto-close-text svelte-1p3uq1f")},m(L,E){w(L,e,E),w(L,t,E),w(L,n,E),w(L,s,E),w(L,r,E),i(r,o),i(r,a),i(r,u),w(L,f,E),w(L,p,E),w(L,m,E),w(L,v,E),N[_].m(v,null),w(L,g,E),w(L,q,E),T=!0,S||(y=A(v,"click",l[39]),S=!0)},p(L,E){(!T||E[0]&64)&&O(a,L[6]);let P=_;_=M(L),_!==P&&(Le(),J(N[P],1,1,()=>{N[P]=null}),Ee(),h=N[_],h||(h=N[_]=F[_](L),h.c()),z(h,1),h.m(v,null)),(!T||E[0]&268435456)&&(v.disabled=L[28])},i(L){T||(z(h),T=!0)},o(L){J(h),T=!1},d(L){L&&(k(e),k(t),k(n),k(s),k(r),k(f),k(p),k(m),k(v),k(g),k(q)),N[_].d(),S=!1,y()}}}function No(l){let e,t,n,s,r,o,a,u,f;return{c(){e=d("div"),e.innerHTML='<span role="img" aria-label="success">âœ…</span>',t=b(),n=d("h2"),n.textContent="Standalone Mode Enabled",s=b(),r=d("p"),r.textContent="Device will reboot and connect to WiFi without cloud registration.",o=b(),a=d("div"),a.innerHTML='<p class="svelte-1p3uq1f">After reboot, access the device at:</p> <p class="dashboard-link svelte-1p3uq1f">http://192.168.4.1</p> <p class="hint-text svelte-1p3uq1f">(Connect to the MouseTrap WiFi network first)</p>',u=b(),f=d("p"),f.innerHTML=`Device is rebooting...<br/>
              You can view system logs at /app/#/logs`,c(e,"class","result-icon success svelte-1p3uq1f"),c(n,"class","svelte-1p3uq1f"),c(r,"class","result-text svelte-1p3uq1f"),c(a,"class","dashboard-link-box svelte-1p3uq1f"),c(f,"class","auto-close-text svelte-1p3uq1f")},m(p,m){w(p,e,m),w(p,t,m),w(p,n,m),w(p,s,m),w(p,r,m),w(p,o,m),w(p,a,m),w(p,u,m),w(p,f,m)},p:V,i:V,o:V,d(p){p&&(k(e),k(t),k(n),k(s),k(r),k(o),k(a),k(u),k(f))}}}function Po(l){let e;return{c(){e=C("Finish Setup")},m(t,n){w(t,e,n)},i:V,o:V,d(t){t&&k(e)}}}function Oo(l){let e,t,n;return e=new ot({props:{size:"small"}}),{c(){_e(e.$$.fragment),t=C(" Rebooting...")},m(s,r){pe(e,s,r),w(s,t,r),n=!0},i(s){n||(z(e.$$.fragment,s),n=!0)},o(s){J(e.$$.fragment,s),n=!1},d(s){s&&k(t),me(e,s)}}}function Mo(l){let e;return{c(){e=C("Finish Setup")},m(t,n){w(t,e,n)},i:V,o:V,d(t){t&&k(e)}}}function Ro(l){let e,t,n;return e=new ot({props:{size:"small"}}),{c(){_e(e.$$.fragment),t=C(" Rebooting...")},m(s,r){pe(e,s,r),w(s,t,r),n=!0},i(s){n||(z(e.$$.fragment,s),n=!0)},o(s){J(e.$$.fragment,s),n=!1},d(s){s&&k(t),me(e,s)}}}function Do(l){let e,t,n,s,r,o,a,u,f=l[7]<5&&ws(l),p=l[7]===1&&qs(l),m=l[7]===2&&Cs(l),v=l[7]===3&&Is(l),_=l[7]===4&&Os(l),h=l[7]===5&&Ds(l);return{c(){e=d("div"),t=d("div"),f&&f.c(),n=b(),p&&p.c(),s=b(),m&&m.c(),r=b(),v&&v.c(),o=b(),_&&_.c(),a=b(),h&&h.c(),c(t,"class","setup-card svelte-1p3uq1f"),c(e,"class","setup-container svelte-1p3uq1f")},m(g,q){w(g,e,q),i(e,t),f&&f.m(t,null),i(t,n),p&&p.m(t,null),i(t,s),m&&m.m(t,null),i(t,r),v&&v.m(t,null),i(t,o),_&&_.m(t,null),i(t,a),h&&h.m(t,null),u=!0},p(g,q){g[7]<5?f?f.p(g,q):(f=ws(g),f.c(),f.m(t,n)):f&&(f.d(1),f=null),g[7]===1?p?(p.p(g,q),q[0]&128&&z(p,1)):(p=qs(g),p.c(),z(p,1),p.m(t,s)):p&&(Le(),J(p,1,1,()=>{p=null}),Ee()),g[7]===2?m?(m.p(g,q),q[0]&128&&z(m,1)):(m=Cs(g),m.c(),z(m,1),m.m(t,r)):m&&(Le(),J(m,1,1,()=>{m=null}),Ee()),g[7]===3?v?v.p(g,q):(v=Is(g),v.c(),v.m(t,o)):v&&(v.d(1),v=null),g[7]===4?_?_.p(g,q):(_=Os(g),_.c(),_.m(t,a)):_&&(_.d(1),_=null),g[7]===5?h?(h.p(g,q),q[0]&128&&z(h,1)):(h=Ds(g),h.c(),z(h,1),h.m(t,null)):h&&(Le(),J(h,1,1,()=>{h=null}),Ee())},i(g){u||(z(p),z(m),z(h),u=!0)},o(g){J(p),J(m),J(h),u=!1},d(g){g&&k(e),f&&f.d(),p&&p.d(),m&&m.d(),v&&v.d(),_&&_.d(),h&&h.d()}}}const Us=5,Hs=3;function Ws(l){return l>=-50?4:l>=-60?3:l>=-70?2:1}function js(l){const e="â–ˆ",t="â–‘";let n="";for(let s=0;s<4;s++)n+=s<l?e:t;return n}function Uo(l){switch(l){case"wifi_failed":return{wifi:"failed",account:"pending",activate:"pending"};case"ntp_failed":case"invalid_credentials":case"server_rejected":return{wifi:"completed",account:"failed",activate:"pending"};case"connection_error":case"server_error":case"registration_failed":return{wifi:"completed",account:"completed",activate:"failed"};default:return{wifi:"completed",account:"completed",activate:"failed"}}}function zs(l){switch(l){case"completed":return"âœ“";case"in_progress":return"â³";case"failed":return"âœ—";default:return"â—‹"}}function Ho(l,e,t){let n,s,r,o=1,a=!1,u=[],f=null,p=!1,m=null,v="",_="",h=!1,g=!1,q=null,T=!1,S="",y="",F=!1,N="",M=!1,L=!1,E=null,P=!1,K=null,I=null,U=null,H=!1,R=0,Y=!1,W=!1,B=!1,X=Intl.DateTimeFormat().resolvedOptions().timeZone||"UTC";ht(async()=>{try{const ee=await yr();ee.attempted&&!ee.success&&(t(20,K=ee.errorMessage),t(21,I=ee.errorCode),console.log("[SETUP] Previous error found:",ee.errorCode,ee.errorMessage))}catch(ee){console.log("[SETUP] Could not check setup status:",ee.message)}});async function Z(){try{await Sr()}catch(ee){console.log("[SETUP] Could not clear setup status:",ee.message)}t(20,K=null),t(21,I=null)}async function ne(ee=!1){console.log("[SETUP] loadNetworks called, forceRescan="+ee),t(11,p=!0),t(10,f=null),t(9,u=[]);try{console.log("[SETUP] About to call scanWiFiNetworks...");const qe=await An(ee);console.log("[SETUP] scanWiFiNetworks returned:",JSON.stringify(qe)),t(9,u=qe.networks||[]),console.log("[SETUP] Networks set to:",u.length,"items"),u.length===0&&t(10,f="No networks found. Tap Retry to scan again.")}catch(qe){console.error("[SETUP] Scan error:",qe),console.error("[SETUP] Error details:",qe.message,qe.stack),t(10,f="Scan failed: "+(qe.message||"Unknown error")),t(9,u=[])}finally{console.log("[SETUP] loadNetworks finished, setting networkLoading=false"),t(11,p=!1)}}function ae(ee){t(0,m=ee),ee!=="manual"&&t(1,v="")}async function se(ee){t(8,a=!0);try{ee===2&&await ne(),t(7,o=ee)}finally{t(8,a=!1)}}let G=null;function le(){t(24,Y=!1),t(7,o=3)}async function Q(){t(13,g=!0),t(14,q=null),t(23,H=!1),R=0,t(24,Y=!1);const ee=m==="manual"?v:m;try{await Lr({ssid:ee,password:_}),D()}catch(qe){t(14,q=qe.message||"Failed to start WiFi test. Please try again."),t(13,g=!1)}}function D(){G=setInterval(async()=>{try{const ee=await ql();console.log("[WIFI-TEST] Progress:",ee.state,ee.step,"staIP:",ee.staIP),R=0,ee.staIP&&ee.staIP!=="0.0.0.0"&&(t(22,U=ee.staIP),console.log("[WIFI-TEST] Device LAN IP:",U)),ee.state==="wifi_connected"?(re(),t(13,g=!1),t(7,o=3)):ee.state==="checking_claim"?console.log("[WIFI-TEST] Device is checking claim status..."):ee.state==="claim_recovered"?(re(),t(13,g=!1),t(6,N=ee.recoveredDeviceName||"Device"),t(17,L=!0),t(19,P=!0),t(7,o=5)):ee.state==="failed"&&(re(),t(14,q=ee.error||"WiFi connection failed"),t(13,g=!1))}catch(ee){console.log("[WIFI-TEST] Poll error:",ee.message),R++,R>=Hs&&U&&(console.log("[WIFI-TEST] Connection lost to AP, showing LAN fallback"),re(),t(13,g=!1),t(23,H=!0))}},500)}async function $(){t(7,o=4),t(17,L=!1),t(18,E=null),t(29,n=[{id:"wifi",label:"WiFi Connected",status:"completed"},{id:"account",label:T?"Creating account":"Signing in",status:"in_progress"},{id:"activate",label:"Activating device",status:"pending"}]);try{await Er({email:S,accountPassword:y,deviceName:N,isNewAccount:T,timezone:X}),te()}catch(ee){t(18,E=ee.message||"Failed to start registration. Please try again."),t(29,n=n.map(qe=>qe.status==="in_progress"?{...qe,status:"failed"}:qe)),t(7,o=5)}}function te(){G=setInterval(async()=>{try{const ee=await ql();console.log("[REGISTER] Progress:",ee.state,ee.step),R=0,ee.staIP&&ee.staIP!=="0.0.0.0"&&t(22,U=ee.staIP),Je(ee),ee.state==="complete"?(re(),t(17,L=!0),t(7,o=5)):ee.state==="failed"&&(re(),t(18,E=ee.error||"Registration failed"),t(27,Me=ee.errorCode),t(7,o=5))}catch(ee){console.log("[REGISTER] Poll error:",ee.message),R++,R>=Hs&&U&&(console.log("[REGISTER] Connection lost during registration, showing LAN fallback"),re(),t(23,H=!0),t(7,o=2))}},500)}function re(){G&&(clearInterval(G),G=null)}function Je(ee){const qe={idle:{wifi:"pending",account:"pending",activate:"pending"},connecting_wifi:{wifi:"in_progress",account:"pending",activate:"pending"},syncing_time:{wifi:"completed",account:"in_progress",activate:"pending"},registering:{wifi:"completed",account:"in_progress",activate:"pending"},saving:{wifi:"completed",account:"completed",activate:"in_progress"},complete:{wifi:"completed",account:"completed",activate:"completed"},failed:Uo(ee.errorCode)},xe=qe[ee.state]||qe.idle;t(29,n=[{id:"wifi",label:"Connecting to WiFi",status:xe.wifi},{id:"account",label:T?"Creating account":"Signing in",status:xe.account},{id:"activate",label:"Activating device",status:xe.activate}])}let Me=null,lt=!1;async function He(){t(28,lt=!0);try{await Fr()}catch{console.log("[SETUP] Reboot request sent (connection may be lost)")}}async function Ie(){try{await Tr()}catch(ee){console.log("[SETUP] Could not reset state:",ee.message)}t(18,E=null),t(27,Me=null),t(7,o=3)}async function De(){t(25,W=!0),await se(2)}async function Se(){t(26,B=!0),t(18,E=null);const ee=m==="manual"?v:m;try{await Ar({ssid:ee,password:_}),t(17,L=!0),t(7,o=5)}catch(qe){t(18,E=qe.message||"Failed to enable standalone mode"),t(7,o=5),t(17,L=!1)}finally{t(26,B=!1)}}const Ce=()=>{t(25,W=!1),Z(),se(2)},he=()=>{console.log("[SETUP] Retry clicked!"),ne(!0)},fe=ee=>ae(ee.ssid),we=()=>ae("manual");function mt(){v=this.value,t(1,v)}function Oe(){_=this.value,t(2,_)}function ye(){_=this.value,t(2,_)}const at=()=>t(12,h=!h),de=()=>{t(7,o=1),t(25,W=!1),t(14,q=null)},Te=()=>{t(3,T=!1)},be=()=>{t(3,T=!0),t(16,M=!1)};function vt(){S=this.value,t(4,S)}function Ke(){y=this.value,t(5,y)}function _t(){y=this.value,t(5,y)}const ze=()=>t(15,F=!F),Be=()=>t(16,M=!M),We=()=>t(16,M=!1);function ft(){N=this.value,t(6,N)}const bt=()=>t(7,o=2);return l.$$.update=()=>{l.$$.dirty[0]&8&&t(29,n=[{id:"wifi",label:"Connecting to WiFi",status:"pending"},{id:"account",label:T?"Creating account":"Signing in",status:"pending"},{id:"activate",label:"Activating device",status:"pending"}]),l.$$.dirty[0]&7&&t(31,s=(m||v.trim())&&(m!=="manual"||v.trim())&&_.length>=8),l.$$.dirty[0]&112&&t(30,r=S.trim()&&y.length>=8&&N.trim())},[m,v,_,T,S,y,N,o,a,u,f,p,h,g,q,F,M,L,E,P,K,I,U,H,Y,W,B,Me,lt,n,r,s,Z,ne,ae,se,le,Q,$,He,Ie,De,Se,Ce,he,fe,we,mt,Oe,ye,at,de,Te,be,vt,Ke,_t,ze,Be,We,ft,bt]}class Wo extends tt{constructor(e){super(),et(this,e,Ho,Do,Xe,{},null,[-1,-1,-1])}}function Bs(l,e,t){const n=l.slice();return n[19]=e[t],n}function jo(l){let e,t,n,s;return e=new Ze({props:{title:"Update WiFi Network",$$slots:{default:[Qo]},$$scope:{ctx:l}}}),{c(){_e(e.$$.fragment),t=b(),n=d("div"),n.innerHTML='<a href="#/" class="svelte-1p30553">â† Back to Dashboard</a>',c(n,"class","back-link svelte-1p30553")},m(r,o){pe(e,r,o),w(r,t,o),w(r,n,o),s=!0},p(r,o){const a={};o&4195310&&(a.$$scope={dirty:o,ctx:r}),e.$set(a)},i(r){s||(z(e.$$.fragment,r),s=!0)},o(r){J(e.$$.fragment,r),s=!1},d(r){r&&(k(t),k(n)),me(e,r)}}}function zo(l){let e,t;return e=new Ze({props:{$$slots:{default:[Zo]},$$scope:{ctx:l}}}),{c(){_e(e.$$.fragment)},m(n,s){pe(e,n,s),t=!0},p(n,s){const r={};s&4194320&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){me(e,n)}}}function Bo(l){let e,t,n,s,r;return t=new ot({}),{c(){e=d("div"),_e(t.$$.fragment),n=b(),s=d("p"),s.textContent="Scanning for networks...",c(e,"class","loading-container svelte-1p30553")},m(o,a){w(o,e,a),pe(t,e,null),i(e,n),i(e,s),r=!0},p:V,i(o){r||(z(t.$$.fragment,o),r=!0)},o(o){J(t.$$.fragment,o),r=!1},d(o){o&&k(e),me(t)}}}function Vs(l){let e,t;return{c(){e=d("div"),t=C(l[3]),c(e,"class","error-text svelte-1p30553")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s&8&&O(t,n[3])},d(n){n&&k(e)}}}function Gs(l){let e,t,n,s,r,o=l[1]?"Scanning...":"Rescan",a,u,f,p,m,v,_;const h=[Jo,Go,Vo],g=[];function q(T,S){return T[1]?0:T[8].length===0?1:2}return f=q(l),p=g[f]=h[f](l),{c(){e=d("div"),t=d("div"),n=d("span"),n.textContent="Available Networks",s=b(),r=d("button"),a=C(o),u=b(),p.c(),c(r,"type","button"),c(r,"class","btn-link svelte-1p30553"),r.disabled=l[1],c(t,"class","network-list-header svelte-1p30553"),c(e,"class","network-list svelte-1p30553")},m(T,S){w(T,e,S),i(e,t),i(t,n),i(t,s),i(t,r),i(r,a),i(e,u),g[f].m(e,null),m=!0,v||(_=A(r,"click",l[10]),v=!0)},p(T,S){(!m||S&2)&&o!==(o=T[1]?"Scanning...":"Rescan")&&O(a,o),(!m||S&2)&&(r.disabled=T[1]);let y=f;f=q(T),f===y?g[f].p(T,S):(Le(),J(g[y],1,1,()=>{g[y]=null}),Ee(),p=g[f],p?p.p(T,S):(p=g[f]=h[f](T),p.c()),z(p,1),p.m(e,null))},i(T){m||(z(p),m=!0)},o(T){J(p),m=!1},d(T){T&&k(e),g[f].d(),v=!1,_()}}}function Vo(l){let e,t=Ue(l[8]),n=[];for(let s=0;s<t.length;s+=1)n[s]=Ks(Bs(l,t,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=$e()},m(s,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(s,r);w(s,e,r)},p(s,r){if(r&2336){t=Ue(s[8]);let o;for(o=0;o<t.length;o+=1){const a=Bs(s,t,o);n[o]?n[o].p(a,r):(n[o]=Ks(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},i:V,o:V,d(s){s&&k(e),qt(n,s)}}}function Go(l){let e;return{c(){e=d("div"),e.textContent="No networks found. Try rescanning or enter SSID manually.",c(e,"class","no-networks svelte-1p30553")},m(t,n){w(t,e,n)},p:V,i:V,o:V,d(t){t&&k(e)}}}function Jo(l){let e,t,n,s,r;return t=new ot({props:{size:"small"}}),{c(){e=d("div"),_e(t.$$.fragment),n=b(),s=d("span"),s.textContent="Scanning...",c(e,"class","scanning svelte-1p30553")},m(o,a){w(o,e,a),pe(t,e,null),i(e,n),i(e,s),r=!0},p:V,i(o){r||(z(t.$$.fragment,o),r=!0)},o(o){J(t.$$.fragment,o),r=!1},d(o){o&&k(e),me(t)}}}function Js(l){let e;return{c(){e=d("span"),e.textContent="ðŸ”’",c(e,"class","lock svelte-1p30553")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function Ks(l){let e,t,n=l[19].ssid+"",s,r,o,a,u=Ys(l[19].rssi)+"",f,p,m,v,_,h=l[19].secure&&Js();function g(){return l[15](l[19])}return{c(){e=d("button"),t=d("span"),s=C(n),r=b(),o=d("span"),a=d("span"),f=C(u),p=b(),h&&h.c(),m=b(),c(t,"class","network-name svelte-1p30553"),c(a,"class","signal svelte-1p30553"),c(o,"class","network-info svelte-1p30553"),c(e,"type","button"),c(e,"class","network-item svelte-1p30553"),j(e,"selected",l[5]===l[19].ssid)},m(q,T){w(q,e,T),i(e,t),i(t,s),i(e,r),i(e,o),i(o,a),i(a,f),i(o,p),h&&h.m(o,null),i(e,m),v||(_=A(e,"click",g),v=!0)},p(q,T){l=q,T&256&&n!==(n=l[19].ssid+"")&&O(s,n),T&256&&u!==(u=Ys(l[19].rssi)+"")&&O(f,u),l[19].secure?h||(h=Js(),h.c(),h.m(o,null)):h&&(h.d(1),h=null),T&288&&j(e,"selected",l[5]===l[19].ssid)},d(q){q&&k(e),h&&h.d(),v=!1,_()}}}function Ko(l){let e,t,n;return{c(){e=d("input"),c(e,"id","password"),c(e,"type","password"),c(e,"placeholder","Enter WiFi password"),e.disabled=l[2],c(e,"class","svelte-1p30553")},m(s,r){w(s,e,r),ce(e,l[6]),t||(n=A(e,"input",l[17]),t=!0)},p(s,r){r&4&&(e.disabled=s[2]),r&64&&e.value!==s[6]&&ce(e,s[6])},d(s){s&&k(e),t=!1,n()}}}function Yo(l){let e,t,n;return{c(){e=d("input"),c(e,"id","password"),c(e,"type","text"),c(e,"placeholder","Enter WiFi password"),e.disabled=l[2],c(e,"class","svelte-1p30553")},m(s,r){w(s,e,r),ce(e,l[6]),t||(n=A(e,"input",l[16]),t=!0)},p(s,r){r&4&&(e.disabled=s[2]),r&64&&e.value!==s[6]&&ce(e,s[6])},d(s){s&&k(e),t=!1,n()}}}function Qo(l){let e,t,n,s,r,o,a,u,f,p=l[9]?"Hide":"Browse",m,v,_,h,g,q,T,S,y,F=l[7]?"Hide":"Show",N,M,L,E,P,K,I,U=l[2]?"Saving...":"Update WiFi Settings",H,R,Y,W,B,X=l[3]&&Vs(l),Z=l[9]&&Gs(l);function ne(G,le){return G[7]?Yo:Ko}let ae=ne(l),se=ae(l);return{c(){e=d("div"),X&&X.c(),t=b(),n=d("div"),s=d("label"),s.textContent="WiFi Network (SSID)",r=b(),o=d("div"),a=d("input"),u=b(),f=d("button"),m=C(p),v=b(),Z&&Z.c(),_=b(),h=d("div"),g=d("label"),g.textContent="Password",q=b(),T=d("div"),se.c(),S=b(),y=d("button"),N=C(F),M=b(),L=d("div"),L.textContent="Minimum 8 characters",E=b(),P=d("div"),P.textContent=`The device will restart after saving. You may need to reconnect
          to the new network to continue using the device.`,K=b(),I=d("button"),H=C(U),c(s,"for","ssid"),c(s,"class","svelte-1p30553"),c(a,"id","ssid"),c(a,"type","text"),c(a,"placeholder","Enter network name"),a.disabled=l[2],c(a,"class","svelte-1p30553"),c(f,"type","button"),c(f,"class","btn-secondary scan-btn svelte-1p30553"),f.disabled=l[2],c(o,"class","ssid-input-group svelte-1p30553"),c(n,"class","form-group svelte-1p30553"),c(g,"for","password"),c(g,"class","svelte-1p30553"),c(y,"type","button"),c(y,"class","toggle-password svelte-1p30553"),c(T,"class","password-input-group svelte-1p30553"),c(L,"class","help-text svelte-1p30553"),c(h,"class","form-group svelte-1p30553"),c(P,"class","warning-text svelte-1p30553"),c(I,"type","button"),c(I,"class","btn-primary svelte-1p30553"),I.disabled=R=l[2]||!l[5].trim()||l[6].length<8,c(e,"class","form-section svelte-1p30553")},m(G,le){w(G,e,le),X&&X.m(e,null),i(e,t),i(e,n),i(n,s),i(n,r),i(n,o),i(o,a),ce(a,l[5]),i(o,u),i(o,f),i(f,m),i(e,v),Z&&Z.m(e,null),i(e,_),i(e,h),i(h,g),i(h,q),i(h,T),se.m(T,null),i(T,S),i(T,y),i(y,N),i(h,M),i(h,L),i(e,E),i(e,P),i(e,K),i(e,I),i(I,H),Y=!0,W||(B=[A(a,"input",l[13]),A(f,"click",l[14]),A(y,"click",l[18]),A(I,"click",l[12])],W=!0)},p(G,le){G[3]?X?X.p(G,le):(X=Vs(G),X.c(),X.m(e,t)):X&&(X.d(1),X=null),(!Y||le&4)&&(a.disabled=G[2]),le&32&&a.value!==G[5]&&ce(a,G[5]),(!Y||le&512)&&p!==(p=G[9]?"Hide":"Browse")&&O(m,p),(!Y||le&4)&&(f.disabled=G[2]),G[9]?Z?(Z.p(G,le),le&512&&z(Z,1)):(Z=Gs(G),Z.c(),z(Z,1),Z.m(e,_)):Z&&(Le(),J(Z,1,1,()=>{Z=null}),Ee()),ae===(ae=ne(G))&&se?se.p(G,le):(se.d(1),se=ae(G),se&&(se.c(),se.m(T,S))),(!Y||le&128)&&F!==(F=G[7]?"Hide":"Show")&&O(N,F),(!Y||le&4)&&U!==(U=G[2]?"Saving...":"Update WiFi Settings")&&O(H,U),(!Y||le&100&&R!==(R=G[2]||!G[5].trim()||G[6].length<8))&&(I.disabled=R)},i(G){Y||(z(Z),Y=!0)},o(G){J(Z),Y=!1},d(G){G&&k(e),X&&X.d(),Z&&Z.d(),se.d(),W=!1,Ae(B)}}}function Zo(l){let e,t,n,s,r,o,a,u,f;return{c(){e=d("div"),t=d("div"),t.textContent="âœ“",n=b(),s=d("h2"),s.textContent="Success!",r=b(),o=d("p"),a=C(l[4]),u=b(),f=d("p"),f.textContent=`The device is restarting. Once it connects to your WiFi network,
          you can access it at its new IP address.`,c(t,"class","success-icon svelte-1p30553"),c(s,"class","svelte-1p30553"),c(o,"class","svelte-1p30553"),c(f,"class","reconnect-info svelte-1p30553"),c(e,"class","success-message svelte-1p30553")},m(p,m){w(p,e,m),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(o,a),i(e,u),i(e,f)},p(p,m){m&16&&O(a,p[4])},d(p){p&&k(e)}}}function Xo(l){let e,t,n,s,r,o;const a=[Bo,zo,jo],u=[];function f(p,m){return p[0]?0:p[4]?1:2}return s=f(l),r=u[s]=a[s](l),{c(){e=d("div"),t=d("div"),t.innerHTML='<h1 class="svelte-1p30553">WiFi Settings</h1> <p class="subtitle svelte-1p30553">Update your WiFi connection without losing device registration</p>',n=b(),r.c(),c(t,"class","header svelte-1p30553"),c(e,"class","wifi-container svelte-1p30553")},m(p,m){w(p,e,m),i(e,t),i(e,n),u[s].m(e,null),o=!0},p(p,[m]){let v=s;s=f(p),s===v?u[s].p(p,m):(Le(),J(u[v],1,1,()=>{u[v]=null}),Ee(),r=u[s],r?r.p(p,m):(r=u[s]=a[s](p),r.c()),z(r,1),r.m(e,null))},i(p){o||(z(r),o=!0)},o(p){J(r),o=!1},d(p){p&&k(e),u[s].d()}}}function Ys(l){return l>=-50?"â–ˆâ–ˆâ–ˆâ–ˆ":l>=-60?"â–ˆâ–ˆâ–ˆâ–‘":l>=-70?"â–ˆâ–ˆâ–‘â–‘":"â–ˆâ–‘â–‘â–‘"}function $o(l,e,t){let n=!0,s=!1,r=!1,o=null,a=null,u="",f="",p=!1,m=[],v=!1;ht(async()=>{await _(),t(0,n=!1)});async function _(){t(1,s=!0),t(3,o=null);try{const M=await An(!0);t(8,m=M.networks||[]),console.log("[WIFI] Found networks:",m)}catch(M){console.error("[WIFI] Scan error:",M),t(8,m=[])}t(1,s=!1)}function h(M){t(5,u=M.ssid),t(9,v=!1)}async function g(){if(t(3,o=null),t(4,a=null),!u.trim()){t(3,o="Please enter or select a WiFi network");return}if(f.length<8){t(3,o="Password must be at least 8 characters");return}t(2,r=!0);try{await Ir({ssid:u.trim(),password:f}),t(4,a="WiFi credentials saved. Device is restarting...")}catch(M){const L=M.message||"";if(L.includes("Failed to fetch")||L.includes("NetworkError")||L.includes("network")||L.includes("Load failed"))t(4,a="WiFi credentials saved. Device is restarting...");else{t(3,o=M.message||"Failed to update WiFi settings"),t(2,r=!1);return}}t(2,r=!1)}function q(){u=this.value,t(5,u)}const T=()=>t(9,v=!v),S=M=>h(M);function y(){f=this.value,t(6,f)}function F(){f=this.value,t(6,f)}return[n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S,y,F,()=>t(7,p=!p)]}class xo extends tt{constructor(e){super(),et(this,e,$o,Xo,Xe,{})}}function ea(l){var v;let e,t,n,s,r,o,a,u,f,p,m;return t=new Ze({props:{title:"Claim Status",$$slots:{default:[ra]},$$scope:{ctx:l}}}),s=new Ze({props:{title:"Connection Status",$$slots:{default:[aa]},$$scope:{ctx:l}}}),o=new Ze({props:{title:"Device Identity",$$slots:{default:[ca]},$$scope:{ctx:l}}}),u=new Ze({props:{title:(v=l[2])!=null&&v.claimed?"Device Actions":"Need Help?",$$slots:{default:[da]},$$scope:{ctx:l}}}),{c(){e=d("div"),_e(t.$$.fragment),n=b(),_e(s.$$.fragment),r=b(),_e(o.$$.fragment),a=b(),_e(u.$$.fragment),f=b(),p=d("div"),p.innerHTML='<a href="#/" class="svelte-kqurmp">â† Back to Dashboard</a>',c(e,"class","cards-grid svelte-kqurmp"),c(p,"class","back-link svelte-kqurmp")},m(_,h){w(_,e,h),pe(t,e,null),i(e,n),pe(s,e,null),i(e,r),pe(o,e,null),i(e,a),pe(u,e,null),w(_,f,h),w(_,p,h),m=!0},p(_,h){var y;const g={};h&4340&&(g.$$scope={dirty:h,ctx:_}),t.$set(g);const q={};h&4100&&(q.$$scope={dirty:h,ctx:_}),s.$set(q);const T={};h&4108&&(T.$$scope={dirty:h,ctx:_}),o.$set(T);const S={};h&4&&(S.title=(y=_[2])!=null&&y.claimed?"Device Actions":"Need Help?"),h&4228&&(S.$$scope={dirty:h,ctx:_}),u.$set(S)},i(_){m||(z(t.$$.fragment,_),z(s.$$.fragment,_),z(o.$$.fragment,_),z(u.$$.fragment,_),m=!0)},o(_){J(t.$$.fragment,_),J(s.$$.fragment,_),J(o.$$.fragment,_),J(u.$$.fragment,_),m=!1},d(_){_&&(k(e),k(f),k(p)),me(t),me(s),me(o),me(u)}}}function ta(l){let e,t;return e=new Ze({props:{$$slots:{default:[pa]},$$scope:{ctx:l}}}),{c(){_e(e.$$.fragment)},m(n,s){pe(e,n,s),t=!0},p(n,s){const r={};s&4098&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){me(e,n)}}}function la(l){let e,t,n,s,r;return t=new ot({}),{c(){e=d("div"),_e(t.$$.fragment),n=b(),s=d("p"),s.textContent="Loading claim status...",c(e,"class","loading-container svelte-kqurmp")},m(o,a){w(o,e,a),pe(t,e,null),i(e,n),i(e,s),r=!0},p:V,i(o){r||(z(t.$$.fragment,o),r=!0)},o(o){J(t.$$.fragment,o),r=!1},d(o){o&&k(e),me(t)}}}function sa(l){let e,t,n,s,r,o,a=l[7]?"Claiming...":"Claim Device",u,f,p,m;return{c(){e=d("div"),t=d("p"),t.textContent="Enter the claim code from your dashboard:",n=b(),s=d("input"),r=b(),o=d("button"),u=C(a),c(t,"class","claim-instructions svelte-kqurmp"),c(s,"type","text"),c(s,"placeholder","Claim Code"),c(s,"maxlength","8"),c(s,"class","claim-input svelte-kqurmp"),s.disabled=l[7],c(o,"class","btn-claim svelte-kqurmp"),o.disabled=f=l[7]||!l[4].trim(),c(e,"class","claim-form svelte-kqurmp")},m(v,_){w(v,e,_),i(e,t),i(e,n),i(e,s),ce(s,l[4]),i(e,r),i(e,o),i(o,u),p||(m=[A(s,"input",l[11]),A(o,"click",l[9])],p=!0)},p(v,_){_&128&&(s.disabled=v[7]),_&16&&s.value!==v[4]&&ce(s,v[4]),_&128&&a!==(a=v[7]?"Claiming...":"Claim Device")&&O(u,a),_&144&&f!==(f=v[7]||!v[4].trim())&&(o.disabled=f)},d(v){v&&k(e),p=!1,Ae(m)}}}function na(l){let e,t,n,s=l[2].deviceName&&Qs(l),r=l[2].tenantId&&Zs(l),o=l[2].deviceId&&Xs(l);return{c(){e=d("div"),s&&s.c(),t=b(),r&&r.c(),n=b(),o&&o.c(),c(e,"class","info-grid svelte-kqurmp")},m(a,u){w(a,e,u),s&&s.m(e,null),i(e,t),r&&r.m(e,null),i(e,n),o&&o.m(e,null)},p(a,u){a[2].deviceName?s?s.p(a,u):(s=Qs(a),s.c(),s.m(e,t)):s&&(s.d(1),s=null),a[2].tenantId?r?r.p(a,u):(r=Zs(a),r.c(),r.m(e,n)):r&&(r.d(1),r=null),a[2].deviceId?o?o.p(a,u):(o=Xs(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(a){a&&k(e),s&&s.d(),r&&r.d(),o&&o.d()}}}function Qs(l){let e,t,n,s,r=l[2].deviceName+"",o;return{c(){e=d("div"),t=d("span"),t.textContent="Device Name",n=b(),s=d("span"),o=C(r),c(t,"class","label svelte-kqurmp"),c(s,"class","value svelte-kqurmp"),c(e,"class","info-row svelte-kqurmp")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&4&&r!==(r=a[2].deviceName+"")&&O(o,r)},d(a){a&&k(e)}}}function Zs(l){let e,t,n,s,r=l[2].tenantId.substring(0,8)+"",o,a;return{c(){e=d("div"),t=d("span"),t.textContent="Tenant ID",n=b(),s=d("span"),o=C(r),a=C("..."),c(t,"class","label svelte-kqurmp"),c(s,"class","value mono svelte-kqurmp"),c(e,"class","info-row svelte-kqurmp")},m(u,f){w(u,e,f),i(e,t),i(e,n),i(e,s),i(s,o),i(s,a)},p(u,f){f&4&&r!==(r=u[2].tenantId.substring(0,8)+"")&&O(o,r)},d(u){u&&k(e)}}}function Xs(l){let e,t,n,s,r=l[2].deviceId.substring(0,8)+"",o,a;return{c(){e=d("div"),t=d("span"),t.textContent="Device ID",n=b(),s=d("span"),o=C(r),a=C("..."),c(t,"class","label svelte-kqurmp"),c(s,"class","value mono svelte-kqurmp"),c(e,"class","info-row svelte-kqurmp")},m(u,f){w(u,e,f),i(e,t),i(e,n),i(e,s),i(s,o),i(s,a)},p(u,f){f&4&&r!==(r=u[2].deviceId.substring(0,8)+"")&&O(o,r)},d(u){u&&k(e)}}}function $s(l){let e,t;return{c(){e=d("div"),t=C(l[5]),c(e,"class","message-box svelte-kqurmp"),j(e,"success",l[6]==="success"),j(e,"error",l[6]==="error")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s&32&&O(t,n[5]),s&64&&j(e,"success",n[6]==="success"),s&64&&j(e,"error",n[6]==="error")},d(n){n&&k(e)}}}function ra(l){var q,T;let e,t,n,s=(q=l[2])!=null&&q.claimed?"âœ“":"â—‹",r,o,a,u=(T=l[2])!=null&&T.claimed?"Claimed":"Not Claimed",f,p,m;function v(S,y){var F;return(F=S[2])!=null&&F.claimed?na:sa}let _=v(l),h=_(l),g=l[5]&&$s(l);return{c(){var S,y;e=d("div"),t=d("div"),n=d("span"),r=C(s),o=b(),a=d("span"),f=C(u),p=b(),h.c(),m=b(),g&&g.c(),c(n,"class","status-icon svelte-kqurmp"),c(a,"class","status-text svelte-kqurmp"),c(t,"class","status-indicator svelte-kqurmp"),j(t,"claimed",(S=l[2])==null?void 0:S.claimed),j(t,"unclaimed",!((y=l[2])!=null&&y.claimed)),c(e,"class","status-section svelte-kqurmp")},m(S,y){w(S,e,y),i(e,t),i(t,n),i(n,r),i(t,o),i(t,a),i(a,f),i(e,p),h.m(e,null),i(e,m),g&&g.m(e,null)},p(S,y){var F,N,M,L;y&4&&s!==(s=(F=S[2])!=null&&F.claimed?"âœ“":"â—‹")&&O(r,s),y&4&&u!==(u=(N=S[2])!=null&&N.claimed?"Claimed":"Not Claimed")&&O(f,u),y&4&&j(t,"claimed",(M=S[2])==null?void 0:M.claimed),y&4&&j(t,"unclaimed",!((L=S[2])!=null&&L.claimed)),_===(_=v(S))&&h?h.p(S,y):(h.d(1),h=_(S),h&&(h.c(),h.m(e,m))),S[5]?g?g.p(S,y):(g=$s(S),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},d(S){S&&k(e),h.d(),g&&g.d()}}}function ia(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-kqurmp">Device is claimed but not connected to the server. Check your network connection.</p>',c(e,"class","warning-box svelte-kqurmp")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function oa(l){let e;return{c(){e=d("div"),e.innerHTML='<p class="svelte-kqurmp">Device must be claimed before it can connect to the server.</p>',c(e,"class","info-box svelte-kqurmp")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function aa(l){var _;let e,t,n,s,r,o=(_=l[2])!=null&&_.mqttConnected?"Connected":"Disconnected",a,u,f;function p(h,g){var q,T;if(!((q=h[2])!=null&&q.claimed))return oa;if(!((T=h[2])!=null&&T.mqttConnected))return ia}let m=p(l),v=m&&m(l);return{c(){var h,g;e=d("div"),t=d("div"),n=d("span"),n.textContent="MQTT",s=b(),r=d("span"),a=C(o),u=b(),v&&v.c(),f=$e(),c(n,"class","connection-label svelte-kqurmp"),c(r,"class","connection-status svelte-kqurmp"),j(r,"connected",(h=l[2])==null?void 0:h.mqttConnected),j(r,"disconnected",!((g=l[2])!=null&&g.mqttConnected)),c(t,"class","connection-item svelte-kqurmp"),c(e,"class","connection-section svelte-kqurmp")},m(h,g){w(h,e,g),i(e,t),i(t,n),i(t,s),i(t,r),i(r,a),w(h,u,g),v&&v.m(h,g),w(h,f,g)},p(h,g){var q,T,S;g&4&&o!==(o=(q=h[2])!=null&&q.mqttConnected?"Connected":"Disconnected")&&O(a,o),g&4&&j(r,"connected",(T=h[2])==null?void 0:T.mqttConnected),g&4&&j(r,"disconnected",!((S=h[2])!=null&&S.mqttConnected)),m!==(m=p(h))&&(v&&v.d(1),v=m&&m(h),v&&(v.c(),v.m(f.parentNode,f)))},d(h){h&&(k(e),k(u),k(f)),v&&v.d(h)}}}function xs(l){var a,u;let e,t,n,s,r=(((a=l[3])==null?void 0:a.macAddress)||((u=l[2])==null?void 0:u.macAddress))+"",o;return{c(){e=d("div"),t=d("span"),t.textContent="MAC Address",n=b(),s=d("span"),o=C(r),c(t,"class","label svelte-kqurmp"),c(s,"class","value mono svelte-kqurmp"),c(e,"class","info-row svelte-kqurmp")},m(f,p){w(f,e,p),i(e,t),i(e,n),i(e,s),i(s,o)},p(f,p){var m,v;p&12&&r!==(r=(((m=f[3])==null?void 0:m.macAddress)||((v=f[2])==null?void 0:v.macAddress))+"")&&O(o,r)},d(f){f&&k(e)}}}function en(l){let e,t,n,s,r=l[3].firmwareVersion+"",o;return{c(){e=d("div"),t=d("span"),t.textContent="Firmware",n=b(),s=d("span"),o=C(r),c(t,"class","label svelte-kqurmp"),c(s,"class","value svelte-kqurmp"),c(e,"class","info-row svelte-kqurmp")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&8&&r!==(r=a[3].firmwareVersion+"")&&O(o,r)},d(a){a&&k(e)}}}function tn(l){let e,t,n,s,r=l[3].chipModel+"",o;return{c(){e=d("div"),t=d("span"),t.textContent="Chip",n=b(),s=d("span"),o=C(r),c(t,"class","label svelte-kqurmp"),c(s,"class","value svelte-kqurmp"),c(e,"class","info-row svelte-kqurmp")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),i(s,o)},p(a,u){u&8&&r!==(r=a[3].chipModel+"")&&O(o,r)},d(a){a&&k(e)}}}function ca(l){var a,u,f,p;let e,t,n,s=(((a=l[3])==null?void 0:a.macAddress)||((u=l[2])==null?void 0:u.macAddress))&&xs(l),r=((f=l[3])==null?void 0:f.firmwareVersion)&&en(l),o=((p=l[3])==null?void 0:p.chipModel)&&tn(l);return{c(){e=d("div"),s&&s.c(),t=b(),r&&r.c(),n=b(),o&&o.c(),c(e,"class","identity-section svelte-kqurmp")},m(m,v){w(m,e,v),s&&s.m(e,null),i(e,t),r&&r.m(e,null),i(e,n),o&&o.m(e,null)},p(m,v){var _,h,g,q;(_=m[3])!=null&&_.macAddress||(h=m[2])!=null&&h.macAddress?s?s.p(m,v):(s=xs(m),s.c(),s.m(e,t)):s&&(s.d(1),s=null),(g=m[3])!=null&&g.firmwareVersion?r?r.p(m,v):(r=en(m),r.c(),r.m(e,n)):r&&(r.d(1),r=null),(q=m[3])!=null&&q.chipModel?o?o.p(m,v):(o=tn(m),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(m){m&&k(e),s&&s.d(),r&&r.d(),o&&o.d()}}}function ua(l){let e,t,n,s,r,o=l[7]?"Processing...":"Unclaim Device",a,u,f;return{c(){e=d("h3"),e.textContent="Unclaim Device",t=b(),n=d("p"),n.textContent="Unclaiming will clear all credentials. The device will need to be reclaimed to connect to the server again.",s=b(),r=d("button"),a=C(o),c(e,"class","svelte-kqurmp"),c(n,"class","unclaim-warning svelte-kqurmp"),c(r,"class","btn-unclaim svelte-kqurmp"),r.disabled=l[7]},m(p,m){w(p,e,m),w(p,t,m),w(p,n,m),w(p,s,m),w(p,r,m),i(r,a),u||(f=A(r,"click",l[10]),u=!0)},p(p,m){m&128&&o!==(o=p[7]?"Processing...":"Unclaim Device")&&O(a,o),m&128&&(r.disabled=p[7])},d(p){p&&(k(e),k(t),k(n),k(s),k(r)),u=!1,f()}}}function fa(l){let e,t,n;return{c(){e=d("h3"),e.textContent="How to Claim This Device",t=b(),n=d("ol"),n.innerHTML='<li class="svelte-kqurmp">Open the MouseTrap mobile app or web dashboard</li> <li class="svelte-kqurmp">Navigate to &quot;Add Device&quot;</li> <li class="svelte-kqurmp">Enter the claim code above</li> <li class="svelte-kqurmp">The device will connect automatically once claimed</li>',c(e,"class","svelte-kqurmp"),c(n,"class","help-steps svelte-kqurmp")},m(s,r){w(s,e,r),w(s,t,r),w(s,n,r)},p:V,d(s){s&&(k(e),k(t),k(n))}}}function da(l){let e;function t(r,o){var a;return(a=r[2])!=null&&a.claimed?ua:fa}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),c(e,"class","help-section svelte-kqurmp")},m(r,o){w(r,e,o),s.m(e,null)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null)))},d(r){r&&k(e),s.d()}}}function pa(l){let e,t,n,s,r,o,a,u,f,p,m;return{c(){e=d("div"),t=d("div"),t.textContent="!",n=b(),s=d("h2"),s.textContent="Error",r=b(),o=d("p"),a=C(l[1]),u=b(),f=d("button"),f.textContent="Retry",c(t,"class","error-icon svelte-kqurmp"),c(s,"class","svelte-kqurmp"),c(o,"class","svelte-kqurmp"),c(f,"class","btn-primary svelte-kqurmp"),c(e,"class","error-state svelte-kqurmp")},m(v,_){w(v,e,_),i(e,t),i(e,n),i(e,s),i(e,r),i(e,o),i(o,a),i(e,u),i(e,f),p||(m=A(f,"click",l[8]),p=!0)},p(v,_){_&2&&O(a,v[1])},d(v){v&&k(e),p=!1,m()}}}function ma(l){let e,t,n,s,r,o;const a=[la,ta,ea],u=[];function f(p,m){return p[0]?0:p[1]?1:2}return s=f(l),r=u[s]=a[s](l),{c(){e=d("div"),t=d("div"),t.innerHTML='<h1 class="svelte-kqurmp">Device Registration</h1> <p class="subtitle svelte-kqurmp">View and manage device claim status</p>',n=b(),r.c(),c(t,"class","header svelte-kqurmp"),c(e,"class","claim-container svelte-kqurmp")},m(p,m){w(p,e,m),i(e,t),i(e,n),u[s].m(e,null),o=!0},p(p,[m]){let v=s;s=f(p),s===v?u[s].p(p,m):(Le(),J(u[v],1,1,()=>{u[v]=null}),Ee(),r=u[s],r?r.p(p,m):(r=u[s]=a[s](p),r.c()),z(r,1),r.m(e,null))},i(p){o||(z(r),o=!0)},o(p){J(r),o=!1},d(p){p&&k(e),u[s].d()}}}function va(l,e,t){let n=!0,s=null,r=null,o=null,a="",u="",f="",p=!1;ht(async()=>{await m()});async function m(){t(0,n=!0),t(1,s=null);try{const[g,q]=await Promise.all([En(),Fn().catch(()=>null)]);t(2,r=g),t(3,o=q)}catch(g){console.error("Failed to load claim info:",g),t(1,s=g.message||"Failed to load claim status")}t(0,n=!1)}async function v(){if(!a.trim()){t(5,u="Please enter a claim code"),t(6,f="error");return}t(7,p=!0),t(5,u="");try{const g=await qr(a.trim().toUpperCase());g.success?(t(5,u=g.message||"Device claimed successfully!"),t(6,f="success"),t(4,a=""),setTimeout(m,2e3)):(t(5,u=g.error||"Claim failed"),t(6,f="error"))}catch(g){console.error("Claim error:",g),t(5,u="Claim failed: "+g.message),t(6,f="error")}finally{t(7,p=!1)}}async function _(){if(confirm("Are you sure you want to unclaim this device? This will clear all credentials and the device will need to be reclaimed.")){t(7,p=!0),t(5,u="");try{const g=await Cr();g.success?(t(5,u=g.message||"Device unclaimed successfully"),t(6,f="success"),setTimeout(m,2e3)):(t(5,u=g.error||"Unclaim failed"),t(6,f="error"))}catch(g){console.error("Unclaim error:",g),t(5,u="Unclaim failed: "+g.message),t(6,f="error")}finally{t(7,p=!1)}}}function h(){a=this.value,t(4,a)}return[n,s,r,o,a,u,f,p,m,v,_,h]}class _a extends tt{constructor(e){super(),et(this,e,va,ma,Xe,{})}}function ln(l,e,t){const n=l.slice();return n[38]=e[t],n}function ba(l){let e,t,n,s,r,o,a,u,f,p=l[7]?"On":"Off",m,v,_,h,g,q,T,S,y,F,N,M,L,E,P,K,I,U,H,R,Y,W=an(l[10])+"",B,X,Z,ne,ae,se,G,le,Q,D,$,te,re,Je,Me,lt,He,Ie,De,Se,Ce,he,fe,we,mt,Oe,ye,at,de,Te,be,vt,Ke,_t,ze,Be,We,ft,bt,ee,qe,xe,rt,Ye,Tt,it,Qe,Ct=l[1]?"Saving...":"Save",nt,yt,ct,Ft,je,Ne,Fe;function Ve(ue,Pe){return ue[6]?ka:ha}let Re=Ve(l),ke=Re(l),x=l[2]&&sn(l),ie=l[3]&&nn(l),oe=Ue(l[16]),ve=[];for(let ue=0;ue<oe.length;ue+=1)ve[ue]=rn(ln(l,oe,ue));let dt=l[4]&&on();return{c(){e=d("div"),t=d("div"),n=d("div"),ke.c(),s=b(),r=d("div"),o=d("button"),o.textContent="Refresh",a=b(),u=d("button"),f=C("LED "),m=C(p),v=b(),_=d("div"),x&&x.c(),h=b(),ie&&ie.c(),g=b(),q=d("div"),T=d("label"),S=d("input"),y=b(),F=d("span"),F.textContent="Record video (10s) instead of photos",N=b(),M=d("div"),L=d("label"),L.textContent="Resolution",E=b(),P=d("select");for(let ue=0;ue<ve.length;ue+=1)ve[ue].c();K=b(),I=d("div"),U=d("label"),H=C("Quality: "),R=C(l[10]),Y=C(" ("),B=C(W),X=C(")"),Z=b(),ne=d("input"),ae=b(),se=d("div"),se.innerHTML="<span>Best</span><span>Low</span>",G=b(),le=d("div"),Q=d("label"),D=C("Brightness: "),$=C(l[11]),te=b(),re=d("input"),Je=b(),Me=d("div"),Me.innerHTML="<span>-2</span><span>+2</span>",lt=b(),He=d("div"),Ie=d("label"),De=C("Contrast: "),Se=C(l[12]),Ce=b(),he=d("input"),fe=b(),we=d("div"),we.innerHTML="<span>-2</span><span>+2</span>",mt=b(),Oe=d("div"),ye=d("label"),at=C("Saturation: "),de=C(l[13]),Te=b(),be=d("input"),vt=b(),Ke=d("div"),Ke.innerHTML="<span>-2</span><span>+2</span>",_t=b(),ze=d("div"),Be=d("label"),We=d("input"),ft=b(),bt=d("span"),bt.textContent="Flip V",ee=b(),qe=d("label"),xe=d("input"),rt=b(),Ye=d("span"),Ye.textContent="Mirror H",Tt=b(),it=d("div"),Qe=d("button"),nt=C(Ct),yt=b(),ct=d("button"),Ft=C("Reset"),je=b(),dt&&dt.c(),c(n,"class","preview-container svelte-1tv9ufw"),c(o,"class","svelte-1tv9ufw"),c(u,"class","svelte-1tv9ufw"),j(u,"active",l[7]),c(r,"class","preview-controls svelte-1tv9ufw"),c(t,"class","preview-section svelte-1tv9ufw"),c(S,"type","checkbox"),c(S,"class","svelte-1tv9ufw"),c(T,"class","checkbox svelte-1tv9ufw"),c(q,"class","control-group svelte-1tv9ufw"),c(L,"class","svelte-1tv9ufw"),c(P,"class","svelte-1tv9ufw"),l[9]===void 0&&Kt(()=>l[25].call(P)),c(M,"class","control-group svelte-1tv9ufw"),c(U,"class","svelte-1tv9ufw"),c(ne,"type","range"),c(ne,"min","4"),c(ne,"max","50"),c(ne,"class","svelte-1tv9ufw"),c(se,"class","range-hint svelte-1tv9ufw"),c(I,"class","control-group svelte-1tv9ufw"),c(Q,"class","svelte-1tv9ufw"),c(re,"type","range"),c(re,"min","-2"),c(re,"max","2"),c(re,"class","svelte-1tv9ufw"),c(Me,"class","range-hint svelte-1tv9ufw"),c(le,"class","control-group svelte-1tv9ufw"),c(Ie,"class","svelte-1tv9ufw"),c(he,"type","range"),c(he,"min","-2"),c(he,"max","2"),c(he,"class","svelte-1tv9ufw"),c(we,"class","range-hint svelte-1tv9ufw"),c(He,"class","control-group svelte-1tv9ufw"),c(ye,"class","svelte-1tv9ufw"),c(be,"type","range"),c(be,"min","-2"),c(be,"max","2"),c(be,"class","svelte-1tv9ufw"),c(Ke,"class","range-hint svelte-1tv9ufw"),c(Oe,"class","control-group svelte-1tv9ufw"),c(We,"type","checkbox"),c(We,"class","svelte-1tv9ufw"),c(Be,"class","checkbox svelte-1tv9ufw"),c(xe,"type","checkbox"),c(xe,"class","svelte-1tv9ufw"),c(qe,"class","checkbox svelte-1tv9ufw"),c(ze,"class","control-group row svelte-1tv9ufw"),c(Qe,"class","btn-save svelte-1tv9ufw"),Qe.disabled=l[1],c(ct,"class","btn-reset svelte-1tv9ufw"),ct.disabled=l[1],c(it,"class","actions svelte-1tv9ufw"),c(_,"class","controls-section svelte-1tv9ufw"),c(e,"class","layout svelte-1tv9ufw")},m(ue,Pe){w(ue,e,Pe),i(e,t),i(t,n),ke.m(n,null),i(t,s),i(t,r),i(r,o),i(r,a),i(r,u),i(u,f),i(u,m),i(e,v),i(e,_),x&&x.m(_,null),i(_,h),ie&&ie.m(_,null),i(_,g),i(_,q),i(q,T),i(T,S),S.checked=l[8],i(T,y),i(T,F),i(_,N),i(_,M),i(M,L),i(M,E),i(M,P);for(let st=0;st<ve.length;st+=1)ve[st]&&ve[st].m(P,null);fl(P,l[9],!0),i(_,K),i(_,I),i(I,U),i(U,H),i(U,R),i(U,Y),i(U,B),i(U,X),i(I,Z),i(I,ne),ce(ne,l[10]),i(I,ae),i(I,se),i(_,G),i(_,le),i(le,Q),i(Q,D),i(Q,$),i(le,te),i(le,re),ce(re,l[11]),i(le,Je),i(le,Me),i(_,lt),i(_,He),i(He,Ie),i(Ie,De),i(Ie,Se),i(He,Ce),i(He,he),ce(he,l[12]),i(He,fe),i(He,we),i(_,mt),i(_,Oe),i(Oe,ye),i(ye,at),i(ye,de),i(Oe,Te),i(Oe,be),ce(be,l[13]),i(Oe,vt),i(Oe,Ke),i(_,_t),i(_,ze),i(ze,Be),i(Be,We),We.checked=l[14],i(Be,ft),i(Be,bt),i(ze,ee),i(ze,qe),i(qe,xe),xe.checked=l[15],i(qe,rt),i(qe,Ye),i(_,Tt),i(_,it),i(it,Qe),i(Qe,nt),i(it,yt),i(it,ct),i(ct,Ft),i(_,je),dt&&dt.m(_,null),Ne||(Fe=[A(o,"click",l[17]),A(u,"click",l[19]),A(S,"change",l[24]),A(S,"change",l[21]),A(P,"change",l[25]),A(P,"change",l[21]),A(ne,"change",l[26]),A(ne,"input",l[26]),A(ne,"input",l[20]),A(re,"change",l[27]),A(re,"input",l[27]),A(re,"input",l[20]),A(he,"change",l[28]),A(he,"input",l[28]),A(he,"input",l[20]),A(be,"change",l[29]),A(be,"input",l[29]),A(be,"input",l[20]),A(We,"change",l[30]),A(We,"change",l[21]),A(xe,"change",l[31]),A(xe,"change",l[21]),A(Qe,"click",l[22]),A(ct,"click",l[23])],Ne=!0)},p(ue,Pe){if(Re===(Re=Ve(ue))&&ke?ke.p(ue,Pe):(ke.d(1),ke=Re(ue),ke&&(ke.c(),ke.m(n,null))),Pe[0]&128&&p!==(p=ue[7]?"On":"Off")&&O(m,p),Pe[0]&128&&j(u,"active",ue[7]),ue[2]?x?x.p(ue,Pe):(x=sn(ue),x.c(),x.m(_,h)):x&&(x.d(1),x=null),ue[3]?ie?ie.p(ue,Pe):(ie=nn(ue),ie.c(),ie.m(_,g)):ie&&(ie.d(1),ie=null),Pe[0]&256&&(S.checked=ue[8]),Pe[0]&65536){oe=Ue(ue[16]);let st;for(st=0;st<oe.length;st+=1){const cl=ln(ue,oe,st);ve[st]?ve[st].p(cl,Pe):(ve[st]=rn(cl),ve[st].c(),ve[st].m(P,null))}for(;st<ve.length;st+=1)ve[st].d(1);ve.length=oe.length}Pe[0]&66048&&fl(P,ue[9]),Pe[0]&1024&&O(R,ue[10]),Pe[0]&1024&&W!==(W=an(ue[10])+"")&&O(B,W),Pe[0]&1024&&ce(ne,ue[10]),Pe[0]&2048&&O($,ue[11]),Pe[0]&2048&&ce(re,ue[11]),Pe[0]&4096&&O(Se,ue[12]),Pe[0]&4096&&ce(he,ue[12]),Pe[0]&8192&&O(de,ue[13]),Pe[0]&8192&&ce(be,ue[13]),Pe[0]&16384&&(We.checked=ue[14]),Pe[0]&32768&&(xe.checked=ue[15]),Pe[0]&2&&Ct!==(Ct=ue[1]?"Saving...":"Save")&&O(nt,Ct),Pe[0]&2&&(Qe.disabled=ue[1]),Pe[0]&2&&(ct.disabled=ue[1]),ue[4]?dt||(dt=on(),dt.c(),dt.m(_,null)):dt&&(dt.d(1),dt=null)},d(ue){ue&&k(e),ke.d(),x&&x.d(),ie&&ie.d(),qt(ve,ue),dt&&dt.d(),Ne=!1,Ae(Fe)}}}function ga(l){let e;return{c(){e=d("div"),e.textContent="Loading...",c(e,"class","loading svelte-1tv9ufw")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function ha(l){let e,t,n,s;return{c(){e=d("img"),Lt(e.src,t=l[5])||c(e,"src",t),c(e,"alt","Preview"),c(e,"class","svelte-1tv9ufw")},m(r,o){w(r,e,o),n||(s=A(e,"error",l[18]),n=!0)},p(r,o){o[0]&32&&!Lt(e.src,t=r[5])&&c(e,"src",t)},d(r){r&&k(e),n=!1,s()}}}function ka(l){let e,t,n,s,r,o;return{c(){e=d("div"),t=d("p"),t.textContent="Preview unavailable",n=b(),s=d("button"),s.textContent="Retry",c(s,"class","svelte-1tv9ufw"),c(e,"class","preview-error svelte-1tv9ufw")},m(a,u){w(a,e,u),i(e,t),i(e,n),i(e,s),r||(o=A(s,"click",l[17]),r=!0)},p:V,d(a){a&&k(e),r=!1,o()}}}function sn(l){let e,t;return{c(){e=d("div"),t=C(l[2]),c(e,"class","error-msg svelte-1tv9ufw")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s[0]&4&&O(t,n[2])},d(n){n&&k(e)}}}function nn(l){let e,t;return{c(){e=d("div"),t=C(l[3]),c(e,"class","success-msg svelte-1tv9ufw")},m(n,s){w(n,e,s),i(e,t)},p(n,s){s[0]&8&&O(t,n[3])},d(n){n&&k(e)}}}function rn(l){let e,t=l[38].label+"",n;return{c(){e=d("option"),n=C(t),e.__value=l[38].value,ce(e,e.__value)},m(s,r){w(s,e,r),i(e,n)},p:V,d(s){s&&k(e)}}}function on(l){let e;return{c(){e=d("p"),e.textContent="Unsaved changes will be lost on exit",c(e,"class","unsaved-hint svelte-1tv9ufw")},m(t,n){w(t,e,n)},d(t){t&&k(e)}}}function wa(l){let e;function t(r,o){return r[0]?ga:ba}let n=t(l),s=n(l);return{c(){e=d("div"),s.c(),c(e,"class","page svelte-1tv9ufw")},m(r,o){w(r,e,o),s.m(e,null)},p(r,o){n===(n=t(r))&&s?s.p(r,o):(s.d(1),s=n(r),s&&(s.c(),s.m(e,null)))},i:V,o:V,d(r){r&&k(e),s.d()}}}function an(l){return l<=10?"Best":l<=20?"High":l<=35?"Medium":"Low"}function qa(l,e,t){let n=!0,s=!1,r=null,o=null,a=!1,u=`/auto.jpg?t=${Date.now()}`,f=!1,p=!1,m=!1,v=8,_=12,h=0,g=0,q=0,T=!1,S=!1,y=null,F=null;const N=[{value:5,label:"QVGA 320x240"},{value:6,label:"CIF 400x296"},{value:8,label:"VGA 640x480"},{value:9,label:"SVGA 800x600"},{value:10,label:"XGA 1024x768"}];ht(async()=>{await M(),await L()}),It(()=>{F&&clearTimeout(F),a&&y&&Y()});async function M(){t(0,n=!0),t(2,r=null);try{const Q=await mr();t(8,m=Q.videoMode||!1),t(9,v=Q.framesize??8),t(10,_=Q.quality??12),t(11,h=Q.brightness??0),t(12,g=Q.contrast??0),t(13,q=Q.saturation??0),t(14,T=!!Q.vflip),t(15,S=!!Q.hmirror),y={...Q},t(4,a=!1)}catch(Q){console.error("Failed to load camera settings:",Q),t(2,r=Q.message||"Failed to load settings")}t(0,n=!1),E()}async function L(){try{const Q=await nr();t(7,p=Q.on||Q.ledOn||!1)}catch(Q){console.error("Failed to get LED status:",Q)}}function E(){t(5,u=`/auto.jpg?t=${Date.now()}`),t(6,f=!1)}function P(){t(6,f=!0)}async function K(){try{await yn(),t(7,p=!p),setTimeout(E,200)}catch(Q){console.error("Failed to toggle LED:",Q)}}async function I(){try{await xt({videoMode:m,framesize:v,quality:_,brightness:h,contrast:g,saturation:q,vflip:T,hmirror:S,persist:!1}),t(4,a=!0),E()}catch(Q){console.error("Failed to apply settings:",Q)}}function U(){F&&clearTimeout(F),F=setTimeout(I,1e3)}function H(){F&&clearTimeout(F),I()}async function R(){t(1,s=!0),t(2,r=null),t(3,o=null);try{await xt({videoMode:m,framesize:v,quality:_,brightness:h,contrast:g,saturation:q,vflip:T,hmirror:S,persist:!0}),y={videoMode:m,framesize:v,quality:_,brightness:h,contrast:g,saturation:q,vflip:T,hmirror:S},t(4,a=!1),t(3,o="Settings saved"),setTimeout(()=>t(3,o=null),2e3)}catch(Q){console.error("Failed to save settings:",Q),t(2,r=Q.message||"Failed to save")}t(1,s=!1)}async function Y(){if(y)try{await xt({...y,persist:!1})}catch(Q){console.error("Failed to revert settings:",Q)}}async function W(){y&&(t(8,m=y.videoMode||!1),t(9,v=y.framesize??8),t(10,_=y.quality??12),t(11,h=y.brightness??0),t(12,g=y.contrast??0),t(13,q=y.saturation??0),t(14,T=!!y.vflip),t(15,S=!!y.hmirror),await I(),t(4,a=!1))}function B(){m=this.checked,t(8,m)}function X(){v=Un(this),t(9,v),t(16,N)}function Z(){_=gt(this.value),t(10,_)}function ne(){h=gt(this.value),t(11,h)}function ae(){g=gt(this.value),t(12,g)}function se(){q=gt(this.value),t(13,q)}function G(){T=this.checked,t(14,T)}function le(){S=this.checked,t(15,S)}return[n,s,r,o,a,u,f,p,m,v,_,h,g,q,T,S,N,E,P,K,U,H,R,W,B,X,Z,ne,ae,se,G,le]}class Ca extends tt{constructor(e){super(),et(this,e,qa,wa,Xe,{},null,[-1,-1])}}function cn(l,e,t){const n=l.slice();return n[7]=e[t],n}function ya(l){const e=l.slice(),t=(e[0].psramTotal||0)-(e[0].psramFree||0);e[10]=t;const n=pt(e[10],e[0].psramTotal||1);return e[11]=n,e}function Sa(l){let e,t,n,s,r,o,a,u,f,p=(l[0].firmwareVersion||"N/A")+"",m,v,_,h,g,q,T=(l[0].filesystemVersion||"N/A")+"",S,y,F,N,M,L,E=pn(l[0].uptimeSeconds||0)+"",P,K,I,U,H=(l[0].cpuFreq||0)+"",R,Y,W,B,X,Z,ne,ae,se,G,le=Ge((l[0].heapTotal||0)-(l[0].heapFree||0))+"",Q,D,$=Ge(l[0].heapTotal||0)+"",te,re,Je=pt((l[0].heapTotal||0)-(l[0].heapFree||0),l[0].heapTotal||1)+"",Me,lt,He,Ie,De,Se=Ge(l[0].heapFree||0)+"",Ce,he,fe,we,mt,Oe,ye,at,de,Te,be,vt,Ke,_t=Ge(l[0].fsUsed||0)+"",ze,Be,We=Ge(l[0].fsTotal||0)+"",ft,bt,ee=pt(l[0].fsUsed||0,l[0].fsTotal||1)+"",qe,xe,rt,Ye,Tt,it=Ge(l[0].fsFree||0)+"",Qe,Ct,nt,yt,ct;function Ft(x,ie){return x[0].psramTotal>0?un:La}function je(x,ie){return ie===un?ya(x):x}let Ne=Ft(l),Fe=Ne(je(l,Ne));function Ve(x,ie){return x[0].captures&&x[0].captures.length>0?Aa:Ea}let Re=Ve(l),ke=Re(l);return{c(){e=d("div"),t=d("div"),n=d("h3"),n.textContent="Version",s=b(),r=d("div"),o=d("div"),a=d("span"),a.textContent="Firmware:",u=b(),f=d("span"),m=C(p),v=b(),_=d("div"),h=d("span"),h.textContent="Filesystem:",g=b(),q=d("span"),S=C(T),y=b(),F=d("div"),N=d("h3"),N.textContent="Uptime",M=b(),L=d("div"),P=C(E),K=b(),I=d("div"),U=C("CPU: "),R=C(H),Y=C(" MHz"),W=b(),B=d("div"),X=d("h3"),X.textContent="Heap Memory",Z=b(),ne=d("div"),ae=d("div"),se=b(),G=d("div"),Q=C(le),D=C(" / "),te=C($),re=C(" ("),Me=C(Je),lt=C("%)"),He=b(),Ie=d("div"),De=C("Free: "),Ce=C(Se),he=b(),fe=d("div"),we=d("h3"),we.textContent="PSRAM",mt=b(),Fe.c(),Oe=b(),ye=d("div"),at=d("h3"),at.textContent="Filesystem",de=b(),Te=d("div"),be=d("div"),vt=b(),Ke=d("div"),ze=C(_t),Be=C(" / "),ft=C(We),bt=C(" ("),qe=C(ee),xe=C("%)"),rt=b(),Ye=d("div"),Tt=C("Free: "),Qe=C(it),Ct=b(),nt=d("div"),yt=d("h3"),yt.textContent="Captures",ct=b(),ke.c(),c(n,"class","svelte-quog9r"),c(a,"class","label svelte-quog9r"),c(f,"class","value svelte-quog9r"),c(o,"class","info-row svelte-quog9r"),c(h,"class","label svelte-quog9r"),c(q,"class","value svelte-quog9r"),c(_,"class","info-row svelte-quog9r"),c(r,"class","info-grid svelte-quog9r"),c(t,"class","card svelte-quog9r"),c(N,"class","svelte-quog9r"),c(L,"class","uptime-display svelte-quog9r"),c(I,"class","info-subtext svelte-quog9r"),c(F,"class","card svelte-quog9r"),c(X,"class","svelte-quog9r"),c(ae,"class","progress-fill svelte-quog9r"),ut(ae,"width",pt((l[0].heapTotal||0)-(l[0].heapFree||0),l[0].heapTotal||1)+"%"),c(ne,"class","progress-bar svelte-quog9r"),c(G,"class","progress-label svelte-quog9r"),c(Ie,"class","info-subtext svelte-quog9r"),c(B,"class","card svelte-quog9r"),c(we,"class","svelte-quog9r"),c(fe,"class","card svelte-quog9r"),c(at,"class","svelte-quog9r"),c(be,"class","progress-fill svelte-quog9r"),ut(be,"width",pt(l[0].fsUsed||0,l[0].fsTotal||1)+"%"),j(be,"warning",pt(l[0].fsUsed||0,l[0].fsTotal||1)>80),j(be,"critical",pt(l[0].fsUsed||0,l[0].fsTotal||1)>95),c(Te,"class","progress-bar svelte-quog9r"),c(Ke,"class","progress-label svelte-quog9r"),c(Ye,"class","info-subtext svelte-quog9r"),c(ye,"class","card svelte-quog9r"),c(yt,"class","svelte-quog9r"),c(nt,"class","card svelte-quog9r"),c(e,"class","status-grid svelte-quog9r")},m(x,ie){w(x,e,ie),i(e,t),i(t,n),i(t,s),i(t,r),i(r,o),i(o,a),i(o,u),i(o,f),i(f,m),i(r,v),i(r,_),i(_,h),i(_,g),i(_,q),i(q,S),i(e,y),i(e,F),i(F,N),i(F,M),i(F,L),i(L,P),i(F,K),i(F,I),i(I,U),i(I,R),i(I,Y),i(e,W),i(e,B),i(B,X),i(B,Z),i(B,ne),i(ne,ae),i(B,se),i(B,G),i(G,Q),i(G,D),i(G,te),i(G,re),i(G,Me),i(G,lt),i(B,He),i(B,Ie),i(Ie,De),i(Ie,Ce),i(e,he),i(e,fe),i(fe,we),i(fe,mt),Fe.m(fe,null),i(e,Oe),i(e,ye),i(ye,at),i(ye,de),i(ye,Te),i(Te,be),i(ye,vt),i(ye,Ke),i(Ke,ze),i(Ke,Be),i(Ke,ft),i(Ke,bt),i(Ke,qe),i(Ke,xe),i(ye,rt),i(ye,Ye),i(Ye,Tt),i(Ye,Qe),i(e,Ct),i(e,nt),i(nt,yt),i(nt,ct),ke.m(nt,null)},p(x,ie){ie&1&&p!==(p=(x[0].firmwareVersion||"N/A")+"")&&O(m,p),ie&1&&T!==(T=(x[0].filesystemVersion||"N/A")+"")&&O(S,T),ie&1&&E!==(E=pn(x[0].uptimeSeconds||0)+"")&&O(P,E),ie&1&&H!==(H=(x[0].cpuFreq||0)+"")&&O(R,H),ie&1&&ut(ae,"width",pt((x[0].heapTotal||0)-(x[0].heapFree||0),x[0].heapTotal||1)+"%"),ie&1&&le!==(le=Ge((x[0].heapTotal||0)-(x[0].heapFree||0))+"")&&O(Q,le),ie&1&&$!==($=Ge(x[0].heapTotal||0)+"")&&O(te,$),ie&1&&Je!==(Je=pt((x[0].heapTotal||0)-(x[0].heapFree||0),x[0].heapTotal||1)+"")&&O(Me,Je),ie&1&&Se!==(Se=Ge(x[0].heapFree||0)+"")&&O(Ce,Se),Ne===(Ne=Ft(x))&&Fe?Fe.p(je(x,Ne),ie):(Fe.d(1),Fe=Ne(je(x,Ne)),Fe&&(Fe.c(),Fe.m(fe,null))),ie&1&&ut(be,"width",pt(x[0].fsUsed||0,x[0].fsTotal||1)+"%"),ie&1&&j(be,"warning",pt(x[0].fsUsed||0,x[0].fsTotal||1)>80),ie&1&&j(be,"critical",pt(x[0].fsUsed||0,x[0].fsTotal||1)>95),ie&1&&_t!==(_t=Ge(x[0].fsUsed||0)+"")&&O(ze,_t),ie&1&&We!==(We=Ge(x[0].fsTotal||0)+"")&&O(ft,We),ie&1&&ee!==(ee=pt(x[0].fsUsed||0,x[0].fsTotal||1)+"")&&O(qe,ee),ie&1&&it!==(it=Ge(x[0].fsFree||0)+"")&&O(Qe,it),Re===(Re=Ve(x))&&ke?ke.p(x,ie):(ke.d(1),ke=Re(x),ke&&(ke.c(),ke.m(nt,null)))},d(x){x&&k(e),Fe.d(),ke.d()}}}function Ta(l){let e,t,n;return{c(){e=d("div"),t=C("Error: "),n=C(l[2]),c(e,"class","error svelte-quog9r")},m(s,r){w(s,e,r),i(e,t),i(e,n)},p(s,r){r&4&&O(n,s[2])},d(s){s&&k(e)}}}function Fa(l){let e;return{c(){e=d("div"),e.textContent="Loading system status...",c(e,"class","loading svelte-quog9r")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function La(l){let e;return{c(){e=d("div"),e.textContent="No PSRAM detected",c(e,"class","no-data svelte-quog9r")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function un(l){let e,t,n,s,r=Ge(l[10])+"",o,a,u=Ge(l[0].psramTotal||0)+"",f,p,m=l[11]+"",v,_,h,g,q,T=Ge(l[0].psramFree||0)+"",S;return{c(){e=d("div"),t=d("div"),n=b(),s=d("div"),o=C(r),a=C(" / "),f=C(u),p=C(" ("),v=C(m),_=C("%)"),h=b(),g=d("div"),q=C("Free: "),S=C(T),c(t,"class","progress-fill svelte-quog9r"),ut(t,"width",l[11]+"%"),c(e,"class","progress-bar svelte-quog9r"),c(s,"class","progress-label svelte-quog9r"),c(g,"class","info-subtext svelte-quog9r")},m(y,F){w(y,e,F),i(e,t),w(y,n,F),w(y,s,F),i(s,o),i(s,a),i(s,f),i(s,p),i(s,v),i(s,_),w(y,h,F),w(y,g,F),i(g,q),i(g,S)},p(y,F){F&1&&ut(t,"width",y[11]+"%"),F&1&&r!==(r=Ge(y[10])+"")&&O(o,r),F&1&&u!==(u=Ge(y[0].psramTotal||0)+"")&&O(f,u),F&1&&m!==(m=y[11]+"")&&O(v,m),F&1&&T!==(T=Ge(y[0].psramFree||0)+"")&&O(S,T)},d(y){y&&(k(e),k(n),k(s),k(h),k(g))}}}function Ea(l){let e;return{c(){e=d("div"),e.textContent="No captures stored",c(e,"class","no-data svelte-quog9r")},m(t,n){w(t,e,n)},p:V,d(t){t&&k(e)}}}function Aa(l){let e,t=l[0].captures.length+"",n,s,r=l[0].captures.length!==1?"s":"",o,a,u,f,p=Ue(l[0].captures.slice(0,5)),m=[];for(let _=0;_<p.length;_+=1)m[_]=fn(cn(l,p,_));let v=l[0].captures.length>5&&dn(l);return{c(){e=d("div"),n=C(t),s=C(" file"),o=C(r),a=b(),u=d("div");for(let _=0;_<m.length;_+=1)m[_].c();f=b(),v&&v.c(),c(e,"class","captures-count svelte-quog9r"),c(u,"class","captures-list svelte-quog9r")},m(_,h){w(_,e,h),i(e,n),i(e,s),i(e,o),w(_,a,h),w(_,u,h);for(let g=0;g<m.length;g+=1)m[g]&&m[g].m(u,null);i(u,f),v&&v.m(u,null)},p(_,h){if(h&1&&t!==(t=_[0].captures.length+"")&&O(n,t),h&1&&r!==(r=_[0].captures.length!==1?"s":"")&&O(o,r),h&1){p=Ue(_[0].captures.slice(0,5));let g;for(g=0;g<p.length;g+=1){const q=cn(_,p,g);m[g]?m[g].p(q,h):(m[g]=fn(q),m[g].c(),m[g].m(u,f))}for(;g<m.length;g+=1)m[g].d(1);m.length=p.length}_[0].captures.length>5?v?v.p(_,h):(v=dn(_),v.c(),v.m(u,null)):v&&(v.d(1),v=null)},d(_){_&&(k(e),k(a),k(u)),qt(m,_),v&&v.d()}}}function fn(l){let e,t,n=l[7].name+"",s,r,o,a=Ge(l[7].size)+"",u;return{c(){e=d("div"),t=d("span"),s=C(n),r=b(),o=d("span"),u=C(a),c(t,"class","capture-name svelte-quog9r"),c(o,"class","capture-size svelte-quog9r"),c(e,"class","capture-item svelte-quog9r")},m(f,p){w(f,e,p),i(e,t),i(t,s),i(e,r),i(e,o),i(o,u)},p(f,p){p&1&&n!==(n=f[7].name+"")&&O(s,n),p&1&&a!==(a=Ge(f[7].size)+"")&&O(u,a)},d(f){f&&k(e)}}}function dn(l){let e,t,n=l[0].captures.length-5+"",s,r;return{c(){e=d("div"),t=C("+"),s=C(n),r=C(" more"),c(e,"class","more-captures svelte-quog9r")},m(o,a){w(o,e,a),i(e,t),i(e,s),i(e,r)},p(o,a){a&1&&n!==(n=o[0].captures.length-5+"")&&O(s,n)},d(o){o&&k(e)}}}function Ia(l){let e,t,n,s,r,o,a,u=l[3]?"Auto-refresh On":"Auto-refresh Off",f,p,m,v,_,h,g;function q(y,F){if(y[1])return Fa;if(y[2])return Ta;if(y[0])return Sa}let T=q(l),S=T&&T(l);return{c(){e=b(),t=d("div"),n=d("div"),s=d("h1"),s.textContent="System Status",r=b(),o=d("div"),a=d("button"),f=C(u),p=C(" (5s)"),m=b(),v=d("button"),v.textContent="Refresh Now",_=b(),S&&S.c(),document.title="System Status - MouseTrap",c(s,"class","svelte-quog9r"),c(a,"class","btn svelte-quog9r"),j(a,"active",l[3]),c(v,"class","btn svelte-quog9r"),c(o,"class","header-controls svelte-quog9r"),c(n,"class","header svelte-quog9r"),c(t,"class","status-container svelte-quog9r")},m(y,F){w(y,e,F),w(y,t,F),i(t,n),i(n,s),i(n,r),i(n,o),i(o,a),i(a,f),i(a,p),i(o,m),i(o,v),i(t,_),S&&S.m(t,null),h||(g=[A(a,"click",l[5]),A(v,"click",l[4])],h=!0)},p(y,[F]){F&8&&u!==(u=y[3]?"Auto-refresh On":"Auto-refresh Off")&&O(f,u),F&8&&j(a,"active",y[3]),T===(T=q(y))&&S?S.p(y,F):(S&&S.d(1),S=T&&T(y),S&&(S.c(),S.m(t,null)))},i:V,o:V,d(y){y&&(k(e),k(t)),S&&S.d(),h=!1,Ae(g)}}}function Ge(l){if(l===0)return"0 B";const e=1024,t=["B","KB","MB","GB"],n=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,n)).toFixed(2))+" "+t[n]}function pn(l){const e=Math.floor(l/86400),t=Math.floor(l%86400/3600),n=Math.floor(l%3600/60),s=l%60,r=[];return e>0&&r.push(`${e}d`),t>0&&r.push(`${t}h`),n>0&&r.push(`${n}m`),r.push(`${s}s`),r.join(" ")}function pt(l,e){return e===0?0:Math.round(l/e*100)}function Na(l,e,t){let n=null,s=!0,r=null,o=!1,a=null;async function u(){try{t(0,n=await hr()),t(2,r=null)}catch(p){console.error("Failed to fetch system status:",p),t(2,r=p.message)}finally{t(1,s=!1)}}function f(){t(3,o=!o),o?a=setInterval(u,5e3):a&&(clearInterval(a),a=null)}return ht(()=>{u()}),It(()=>{a&&clearInterval(a)}),[n,s,r,o,u,f]}class Pa extends tt{constructor(e){super(),et(this,e,Na,Ia,Xe,{})}}function Oa(l){let e,t;return e=new xn({props:{$$slots:{default:[Ra]},$$scope:{ctx:l}}}),{c(){_e(e.$$.fragment)},m(n,s){pe(e,n,s),t=!0},p(n,s){const r={};s&18&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){me(e,n)}}}function Ma(l){let e,t,n;var s=l[1];function r(o,a){return{}}return s&&(e=Jt(s,r())),{c(){e&&_e(e.$$.fragment),t=$e()},m(o,a){e&&pe(e,o,a),w(o,t,a),n=!0},p(o,a){if(a&2&&s!==(s=o[1])){if(e){Le();const u=e;J(u.$$.fragment,1,0,()=>{me(u,1)}),Ee()}s?(e=Jt(s,r()),_e(e.$$.fragment),z(e.$$.fragment,1),pe(e,t.parentNode,t)):e=null}},i(o){n||(e&&z(e.$$.fragment,o),n=!0)},o(o){e&&J(e.$$.fragment,o),n=!1},d(o){o&&k(t),e&&me(e,o)}}}function Ra(l){let e,t,n;var s=l[1];function r(o,a){return{}}return s&&(e=Jt(s,r())),{c(){e&&_e(e.$$.fragment),t=$e()},m(o,a){e&&pe(e,o,a),w(o,t,a),n=!0},p(o,a){if(a&2&&s!==(s=o[1])){if(e){Le();const u=e;J(u.$$.fragment,1,0,()=>{me(u,1)}),Ee()}s?(e=Jt(s,r()),_e(e.$$.fragment),z(e.$$.fragment,1),pe(e,t.parentNode,t)):e=null}},i(o){n||(e&&z(e.$$.fragment,o),n=!0)},o(o){e&&J(e.$$.fragment,o),n=!1},d(o){o&&k(t),e&&me(e,o)}}}function Da(l){let e,t,n,s;const r=[Ma,Oa],o=[];function a(u,f){return u[0]?0:1}return e=a(l),t=o[e]=r[e](l),{c(){t.c(),n=$e()},m(u,f){o[e].m(u,f),w(u,n,f),s=!0},p(u,[f]){let p=e;e=a(u),e===p?o[e].p(u,f):(Le(),J(o[p],1,1,()=>{o[p]=null}),Ee(),t=o[e],t?t.p(u,f):(t=o[e]=r[e](u),t.c()),z(t,1),t.m(n.parentNode,n))},i(u){s||(z(t),s=!0)},o(u){J(t),s=!1},d(u){u&&k(n),o[e].d(u)}}}function Ua(l,e,t){let n,s,r;Gt(l,ol,a=>t(2,r=a));function o(a){const u=a.startsWith("/")?a:"/"+a;return u==="/"||u===""?Ll:u==="/gallery"?oi:u==="/calibration"?fi:u==="/servo"?vi:u==="/logs"||u==="/status"?is:u==="/firmware"||u.startsWith("/reboot")?bs:u==="/test"?no:u==="/setup"?Wo:u==="/wifi"?xo:u==="/claim"?_a:u==="/camera-settings"?Ca:u==="/system-status"?Pa:Ll}return l.$$.update=()=>{l.$$.dirty&4&&t(1,n=o(r)),l.$$.dirty&4&&t(0,s=r==="/setup"||r==="setup")},[s,n,r]}class Ha extends tt{constructor(e){super(),et(this,e,Ua,Da,Xe,{})}}const Ut=(...l)=>console.log("[JS]",...l);function mn(l){Ut("app-main: FATAL",l);const e=document.getElementById("app");e&&e.childElementCount===0&&(e.innerHTML=`
      <div style="font: 14px system-ui, sans-serif; color:#ddd; background:#111; padding:16px; line-height:1.35">
        <div style="font-weight:600; margin-bottom:8px; color:#ff6b6b">âš ï¸ App failed to load</div>
        <div style="opacity:.85; margin-bottom:8px">Check console for full stack. Error:</div>
        <pre style="white-space:pre-wrap; background:#181818; border:1px solid #ff6b6b; padding:12px; border-radius:6px; overflow:auto; color:#ffcccc">
${String(l&&(l.stack||l.message)||l)}
        </pre>
      </div>`)}window.addEventListener("error",l=>Ut("global-error:",l.message||l.error));window.addEventListener("unhandledrejection",l=>Ut("unhandled-rejection:",l.reason));(function(){Ut("app-main: start");const e=document.getElementById("app");if(!e){mn("Missing #app container in HTML");return}try{const t=new Ha({target:e});window.__MOUSETRAP_APP={ok:!0,mountedAt:Date.now(),app:t},Ut("app-main: mounted OK")}catch(t){window.__MOUSETRAP_APP={ok:!1,error:t,when:Date.now()},mn(t)}})();
