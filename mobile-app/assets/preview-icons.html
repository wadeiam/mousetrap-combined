<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MouseTrap Monitor - Icon Preview & Export</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #1a1a2e;
            color: #fff;
        }
        h1 {
            color: #0f4c75;
            text-align: center;
        }
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        .icon-card {
            background: #16213e;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        .icon-card h3 {
            color: #0f4c75;
            margin-top: 0;
        }
        .icon-preview {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .icon-preview.dark {
            background: #1a1a2e;
        }
        canvas {
            border: 1px solid #0f4c75;
            border-radius: 4px;
        }
        button {
            background: #0f4c75;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background: #1a6ba8;
        }
        .instructions {
            background: #16213e;
            border-left: 4px solid #0f4c75;
            padding: 20px;
            margin: 30px 0;
            border-radius: 4px;
        }
        .instructions h2 {
            color: #0f4c75;
            margin-top: 0;
        }
        code {
            background: #1a1a2e;
            padding: 2px 6px;
            border-radius: 3px;
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <h1>MouseTrap Monitor - Icon Preview & Export</h1>

    <div class="instructions">
        <h2>How to Generate Icons</h2>
        <ol>
            <li>Preview the icons below</li>
            <li>Click "Download" buttons to save each icon</li>
            <li>Save them with the correct filenames in the assets directory:
                <ul>
                    <li><code>icon.png</code> - Main app icon (1024x1024)</li>
                    <li><code>adaptive-icon.png</code> - Android adaptive icon (1024x1024)</li>
                    <li><code>splash-icon.png</code> - Splash screen (1024x1024)</li>
                    <li><code>notification-icon.png</code> - Notification icon (96x96)</li>
                    <li><code>favicon.png</code> - Web favicon (48x48)</li>
                </ul>
            </li>
            <li>Run <code>npx expo prebuild --clean</code> to regenerate native projects</li>
        </ol>
    </div>

    <div class="icon-grid">
        <div class="icon-card">
            <h3>Main App Icon</h3>
            <p>1024x1024 - For App Store & Google Play</p>
            <div class="icon-preview">
                <canvas id="icon-main" width="256" height="256"></canvas>
            </div>
            <button onclick="downloadIcon('icon-main', 1024, 'icon.png')">Download icon.png</button>
            <button onclick="downloadIcon('icon-main', 1024, 'adaptive-icon.png')">Download adaptive-icon.png</button>
            <button onclick="downloadIcon('icon-main', 1024, 'splash-icon.png')">Download splash-icon.png</button>
            <button onclick="downloadIcon('icon-main', 48, 'favicon.png')">Download favicon.png</button>
        </div>

        <div class="icon-card">
            <h3>Notification Icon</h3>
            <p>96x96 - For Android push notifications</p>
            <div class="icon-preview dark">
                <canvas id="icon-notification" width="96" height="96"></canvas>
            </div>
            <button onclick="downloadIcon('icon-notification', 96, 'notification-icon.png')">Download notification-icon.png</button>
        </div>
    </div>

    <script>
        // Load and render the SVG icons
        async function loadAndRenderIcons() {
            // Load main icon SVG
            const mainResponse = await fetch('icon-source.svg');
            const mainSvgText = await mainResponse.text();
            await renderSvgToCanvas('icon-main', mainSvgText, 256);

            // Load notification icon SVG
            const notifResponse = await fetch('notification-icon-source.svg');
            const notifSvgText = await notifResponse.text();
            await renderSvgToCanvas('icon-notification', notifSvgText, 96);
        }

        function renderSvgToCanvas(canvasId, svgText, size) {
            return new Promise((resolve) => {
                const canvas = document.getElementById(canvasId);
                const ctx = canvas.getContext('2d');

                const img = new Image();
                const blob = new Blob([svgText], { type: 'image/svg+xml' });
                const url = URL.createObjectURL(blob);

                img.onload = function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    URL.revokeObjectURL(url);
                    resolve();
                };

                img.src = url;
            });
        }

        async function downloadIcon(canvasId, targetSize, filename) {
            // Get the SVG source
            const svgFile = canvasId === 'icon-notification' ?
                'notification-icon-source.svg' : 'icon-source.svg';

            const response = await fetch(svgFile);
            const svgText = await response.text();

            // Create a temporary canvas at target size
            const canvas = document.createElement('canvas');
            canvas.width = targetSize;
            canvas.height = targetSize;
            const ctx = canvas.getContext('2d');

            const img = new Image();
            const blob = new Blob([svgText], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);

            img.onload = function() {
                ctx.drawImage(img, 0, 0, targetSize, targetSize);
                URL.revokeObjectURL(url);

                // Download
                canvas.toBlob(function(blob) {
                    const downloadUrl = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = downloadUrl;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(downloadUrl);
                }, 'image/png');
            };

            img.src = url;
        }

        // Load icons on page load
        loadAndRenderIcons();
    </script>
</body>
</html>
